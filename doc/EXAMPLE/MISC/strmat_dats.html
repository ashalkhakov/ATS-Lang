<BODY BGCOLOR="#E0E0E0" TEXT="#E80000"><PRE><FONT COLOR="#787878">//
</FONT><FONT COLOR="#787878">//
</FONT><FONT COLOR="#787878">// Author: Hongwei Xi (May 2007)
</FONT><FONT COLOR="#787878">//
</FONT><FONT COLOR="#787878">//
</FONT>
<FONT COLOR="#787878">// An implementation of string matching in continuation-passing style.
</FONT><FONT COLOR="#787878">// The code is translated by Hongwei Xi from an earlier version in DML,
</FONT><FONT COLOR="#787878">// which was originally adopted by him from a version by Frank Pfenning
</FONT><FONT COLOR="#787878">// (fp+ AT cs DOT cmu DOT edu)
</FONT>
<FONT COLOR="#000000">datatype</FONT> <FONT COLOR="#0000FF">regexp <FONT COLOR="#000000">(</FONT>int<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">|</FONT> Any_char<FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#787878">(* any character *)</FONT>
  <FONT COLOR="#000000">|</FONT> Empty<FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#787878">(* empty string matches Empty *)</FONT>
  <FONT COLOR="#000000">|</FONT> Char<FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF">Char</FONT> <FONT COLOR="#787878">(* "c" matches Char (c) *)</FONT>
  <FONT COLOR="#787878">// every char other than "c" matches Char (c)
</FONT>  <FONT COLOR="#000000">|</FONT> Char_not<FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF">Char</FONT>
  <FONT COLOR="#787878">// every char in [c1, c2] matches Chars (c1, c2)
</FONT>  <FONT COLOR="#000000">|</FONT> Chars<FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>Char<FONT COLOR="#000000">,</FONT> Char<FONT COLOR="#000000">)</FONT></FONT>
  <FONT COLOR="#787878">// every char not in [c1, c2] matches Chars (c1, c2)
</FONT>  <FONT COLOR="#000000">|</FONT> Chars_not<FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>Char<FONT COLOR="#000000">,</FONT> Char<FONT COLOR="#000000">)</FONT></FONT>
  <FONT COLOR="#787878">// cs matches Alt(p1, p2) if cs matches either p1 or p2
</FONT>  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">i<FONT COLOR="#000000">,</FONT>j<FONT COLOR="#000000">:</FONT>nat</FONT><FONT COLOR="#000000">}</FONT> Alt<FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>i+j+1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>regexp i<FONT COLOR="#000000">,</FONT> regexp j<FONT COLOR="#000000">)</FONT></FONT>
  <FONT COLOR="#787878">// cs matches Seq(p1, p2) if a prefix of cs matches p1 and the rest matches p2
</FONT>  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">i<FONT COLOR="#000000">,</FONT>j<FONT COLOR="#000000">:</FONT>nat</FONT><FONT COLOR="#000000">}</FONT> Seq<FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>i+j+1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>regexp i<FONT COLOR="#000000">,</FONT> regexp j<FONT COLOR="#000000">)</FONT></FONT>
  <FONT COLOR="#787878">// cs matches Star(p) if cs matches some, possibly 0, copies of p
</FONT>  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">i<FONT COLOR="#000000">:</FONT>nat</FONT><FONT COLOR="#000000">}</FONT> Star<FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>i+1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF">regexp i</FONT>

<FONT COLOR="#000000">typedef</FONT> <FONT COLOR="#0000FF">Regexp <FONT COLOR="#000000">=</FONT> <FONT COLOR="#000000">[</FONT>i<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">]</FONT> regexp i</FONT>

<FONT COLOR="#787878">// Note that [acc] is verified to be terminating!
</FONT>
<FONT COLOR="#000000">fun</FONT> acc <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>i0<FONT COLOR="#000000">,</FONT>n<FONT COLOR="#000000">,</FONT>i<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>b<FONT COLOR="#000000">:</FONT>two <FONT COLOR="#000000">|</FONT> i+b &lt;= i0<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>n<FONT COLOR="#000000">,</FONT>i<FONT COLOR="#000000">&gt;.</FONT></FONT> <FONT COLOR="#787878">// metric for termination verification
</FONT>   <FONT COLOR="#000000">(</FONT>cs0<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">string i0</FONT><FONT COLOR="#000000">,</FONT> i0<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">int i0</FONT><FONT COLOR="#000000">,</FONT> p<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">regexp n</FONT><FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">int i</FONT><FONT COLOR="#000000">,</FONT> b<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">int b</FONT><FONT COLOR="#000000">,</FONT>
    k<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>i'<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">;</FONT> b'<FONT COLOR="#000000">:</FONT>two <FONT COLOR="#000000">|</FONT> i'+b' &lt;= i+b<FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">(</FONT>int i'<FONT COLOR="#000000">,</FONT> int b'<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">-&gt;</FONT> Bool</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">Bool</FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">case+</FONT> p <FONT COLOR="#000000">of</FONT>
    <FONT COLOR="#000000">|</FONT> Any_char <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">if</FONT> i <FONT COLOR="#000000">&gt;</FONT> 0 <FONT COLOR="#000000">then</FONT> k <FONT COLOR="#000000">(</FONT>i-1<FONT COLOR="#000000">,</FONT> 1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">else</FONT> false

    <FONT COLOR="#000000">|</FONT> Empty <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> k <FONT COLOR="#000000">(</FONT>i<FONT COLOR="#000000">,</FONT> b<FONT COLOR="#000000">)</FONT>

    <FONT COLOR="#000000">|</FONT> Char c <FONT COLOR="#000000">=&gt;</FONT>
        <FONT COLOR="#000000">if</FONT> i <FONT COLOR="#000000">&gt;</FONT> 0 <FONT COLOR="#000000">then</FONT> <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">if</FONT> c <FONT COLOR="#000000">=</FONT> cs0[i0-i<FONT COLOR="#000000">]</FONT> <FONT COLOR="#000000">then</FONT> k <FONT COLOR="#000000">(</FONT>i-1<FONT COLOR="#000000">,</FONT> 1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">else</FONT> false<FONT COLOR="#000000">)</FONT>
        <FONT COLOR="#000000">else</FONT> false

    <FONT COLOR="#000000">|</FONT> Char_not c <FONT COLOR="#000000">=&gt;</FONT>
        <FONT COLOR="#000000">if</FONT> i <FONT COLOR="#000000">&gt;</FONT> 0 <FONT COLOR="#000000">then</FONT> <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">if</FONT> c &lt;&gt; cs0[i0-i<FONT COLOR="#000000">]</FONT> <FONT COLOR="#000000">then</FONT> k <FONT COLOR="#000000">(</FONT>i-1<FONT COLOR="#000000">,</FONT> 1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">else</FONT> false<FONT COLOR="#000000">)</FONT>
        <FONT COLOR="#000000">else</FONT> false

    <FONT COLOR="#000000">|</FONT> Chars <FONT COLOR="#000000">(</FONT>c1<FONT COLOR="#000000">,</FONT> c2<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT>
        <FONT COLOR="#000000">if</FONT> i <FONT COLOR="#000000">&gt;</FONT> 0 <FONT COLOR="#000000">then</FONT>
          <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">val</FONT> c <FONT COLOR="#000000">=</FONT> cs0[i0-i<FONT COLOR="#000000">]</FONT> <FONT COLOR="#000000">in</FONT> 
            <FONT COLOR="#000000">if</FONT> c1 &lt;= c <FONT COLOR="#000000">then</FONT> <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">if</FONT> c &lt;= c2 <FONT COLOR="#000000">then</FONT> k <FONT COLOR="#000000">(</FONT>i-1<FONT COLOR="#000000">,</FONT> 1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">else</FONT> false<FONT COLOR="#000000">)</FONT>
            <FONT COLOR="#000000">else</FONT> false
          <FONT COLOR="#000000">end</FONT>
        <FONT COLOR="#000000">else</FONT> false

    <FONT COLOR="#000000">|</FONT> Chars_not <FONT COLOR="#000000">(</FONT>c1<FONT COLOR="#000000">,</FONT> c2<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT>
        <FONT COLOR="#000000">if</FONT> i <FONT COLOR="#000000">&gt;</FONT> 0 <FONT COLOR="#000000">then</FONT>
          <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">val</FONT> c <FONT COLOR="#000000">=</FONT> cs0[i0-i<FONT COLOR="#000000">]</FONT> <FONT COLOR="#000000">in</FONT> 
            <FONT COLOR="#000000">if</FONT> c <FONT COLOR="#000000">&lt;</FONT> c1 <FONT COLOR="#000000">then</FONT> k <FONT COLOR="#000000">(</FONT>i-1<FONT COLOR="#000000">,</FONT> 1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">else</FONT>
              <FONT COLOR="#000000">if</FONT> c <FONT COLOR="#000000">&gt;</FONT> c2 <FONT COLOR="#000000">then</FONT> k <FONT COLOR="#000000">(</FONT>i-1<FONT COLOR="#000000">,</FONT> 1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">else</FONT> false
          <FONT COLOR="#000000">end</FONT>
        <FONT COLOR="#000000">else</FONT> false

    <FONT COLOR="#000000">|</FONT> Alt <FONT COLOR="#000000">(</FONT>p1<FONT COLOR="#000000">,</FONT> p2<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT>
      <FONT COLOR="#000000">if</FONT> acc <FONT COLOR="#000000">(</FONT>cs0<FONT COLOR="#000000">,</FONT> i0<FONT COLOR="#000000">,</FONT> p1<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">,</FONT> b<FONT COLOR="#000000">,</FONT> k<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">then</FONT> true <FONT COLOR="#000000">else</FONT> acc <FONT COLOR="#000000">(</FONT>cs0<FONT COLOR="#000000">,</FONT> i0<FONT COLOR="#000000">,</FONT> p2<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">,</FONT> b<FONT COLOR="#000000">,</FONT> k<FONT COLOR="#000000">)</FONT>

    <FONT COLOR="#000000">|</FONT> Seq <FONT COLOR="#000000">(</FONT>p1<FONT COLOR="#000000">,</FONT> p2<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT>
      acc <FONT COLOR="#000000">(</FONT>cs0<FONT COLOR="#000000">,</FONT> i0<FONT COLOR="#000000">,</FONT> p1<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">,</FONT> b<FONT COLOR="#000000">,</FONT> <FONT COLOR="#000000">lam</FONT> <FONT COLOR="#000000">(</FONT>i'<FONT COLOR="#000000">,</FONT> b'<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> acc <FONT COLOR="#000000">(</FONT>cs0<FONT COLOR="#000000">,</FONT> i0<FONT COLOR="#000000">,</FONT> p2<FONT COLOR="#000000">,</FONT> i'<FONT COLOR="#000000">,</FONT> b'<FONT COLOR="#000000">,</FONT> k<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>

    <FONT COLOR="#000000">|</FONT> Star p0 <FONT COLOR="#000000">=&gt;</FONT>
      <FONT COLOR="#000000">if</FONT> k <FONT COLOR="#000000">(</FONT>i<FONT COLOR="#000000">,</FONT> b<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">then</FONT> true <FONT COLOR="#000000">else</FONT>
        acc <FONT COLOR="#000000">(</FONT>cs0<FONT COLOR="#000000">,</FONT> i0<FONT COLOR="#000000">,</FONT> p0<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">,</FONT> 0<FONT COLOR="#000000">,</FONT>
          <FONT COLOR="#000000">lam</FONT> <FONT COLOR="#000000">(</FONT>i'<FONT COLOR="#000000">,</FONT> b'<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT>
            <FONT COLOR="#000000">if</FONT> b' <FONT COLOR="#000000">=</FONT> 0 <FONT COLOR="#000000">then</FONT> false <FONT COLOR="#000000">else</FONT> acc <FONT COLOR="#000000">(</FONT>cs0<FONT COLOR="#000000">,</FONT> i0<FONT COLOR="#000000">,</FONT> p<FONT COLOR="#000000">,</FONT> i'<FONT COLOR="#000000">,</FONT> 1<FONT COLOR="#000000">,</FONT> k<FONT COLOR="#000000">)</FONT>
        <FONT COLOR="#000000">)</FONT>

<FONT COLOR="#000000">extern</FONT> <FONT COLOR="#000000">fun</FONT> accept <FONT COLOR="#000000">(</FONT>cs0<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">String</FONT><FONT COLOR="#000000">,</FONT> p<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">Regexp</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">Bool</FONT>

<FONT COLOR="#000000">implement</FONT> accept <FONT COLOR="#000000">(</FONT>cs0<FONT COLOR="#000000">,</FONT> p<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">val</FONT> i0 <FONT COLOR="#000000">=</FONT> length cs0 <FONT COLOR="#000000">in</FONT>
    acc <FONT COLOR="#000000">(</FONT>cs0<FONT COLOR="#000000">,</FONT> i0<FONT COLOR="#000000">,</FONT> p<FONT COLOR="#000000">,</FONT> i0<FONT COLOR="#000000">,</FONT> 0<FONT COLOR="#000000">,</FONT> <FONT COLOR="#000000">lam</FONT> <FONT COLOR="#000000">(</FONT>i<FONT COLOR="#000000">,</FONT> _<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> i <FONT COLOR="#000000">=</FONT> 0<FONT COLOR="#000000">)</FONT>
  <FONT COLOR="#000000">end</FONT>

<FONT COLOR="#787878">// some tests
</FONT>
<FONT COLOR="#000000">val</FONT> regexp_digit <FONT COLOR="#000000">=</FONT> Chars <FONT COLOR="#000000">(</FONT>'0'<FONT COLOR="#000000">,</FONT> '9'<FONT COLOR="#000000">)</FONT> 
<FONT COLOR="#000000">val</FONT> regexp_digits <FONT COLOR="#000000">=</FONT> Star <FONT COLOR="#000000">(</FONT>Chars <FONT COLOR="#000000">(</FONT>'0'<FONT COLOR="#000000">,</FONT> '9'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>

<FONT COLOR="#000000">val</FONT> regexp_uint <FONT COLOR="#000000">=</FONT>
  Alt <FONT COLOR="#000000">(</FONT>Char '0'<FONT COLOR="#000000">,</FONT> Seq <FONT COLOR="#000000">(</FONT>Chars <FONT COLOR="#000000">(</FONT>'1'<FONT COLOR="#000000">,</FONT> '9'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> regexp_digits<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>

<FONT COLOR="#000000">val</FONT> regexp_int <FONT COLOR="#000000">=</FONT>
  Alt <FONT COLOR="#000000">(</FONT>regexp_uint<FONT COLOR="#000000">,</FONT> Seq <FONT COLOR="#000000">(</FONT>Alt <FONT COLOR="#000000">(</FONT>Char '-'<FONT COLOR="#000000">,</FONT> Char '+'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> regexp_uint<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>

<FONT COLOR="#000000">val</FONT> regexp_dot_sats <FONT COLOR="#000000">=</FONT>
  Seq <FONT COLOR="#000000">(</FONT>Star Any_char<FONT COLOR="#000000">,</FONT> Seq <FONT COLOR="#000000">(</FONT>Char '.'<FONT COLOR="#000000">,</FONT> Seq <FONT COLOR="#000000">(</FONT>Char 's'<FONT COLOR="#000000">,</FONT> Seq <FONT COLOR="#000000">(</FONT>Char 'a'<FONT COLOR="#000000">,</FONT> Seq <FONT COLOR="#000000">(</FONT>Char 't'<FONT COLOR="#000000">,</FONT> Char 's'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>

<FONT COLOR="#000000">val</FONT> regexp_dot_dats <FONT COLOR="#000000">=</FONT>
  Seq <FONT COLOR="#000000">(</FONT>Star Any_char<FONT COLOR="#000000">,</FONT> Seq <FONT COLOR="#000000">(</FONT>Char '.'<FONT COLOR="#000000">,</FONT> Seq <FONT COLOR="#000000">(</FONT>Char 'd'<FONT COLOR="#000000">,</FONT> Seq <FONT COLOR="#000000">(</FONT>Char 'a'<FONT COLOR="#000000">,</FONT> Seq <FONT COLOR="#000000">(</FONT>Char 't'<FONT COLOR="#000000">,</FONT> Char 's'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>

<FONT COLOR="#000000">implement</FONT> main <FONT COLOR="#000000">(</FONT>argc<FONT COLOR="#000000">,</FONT> argv<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">let</FONT>
     <FONT COLOR="#000000">val</FONT> ans10 <FONT COLOR="#000000">=</FONT> accept <FONT COLOR="#000000">(</FONT>"123456789"<FONT COLOR="#000000">,</FONT> regexp_int<FONT COLOR="#000000">)</FONT>
     <FONT COLOR="#000000">val</FONT> ans11 <FONT COLOR="#000000">=</FONT> accept <FONT COLOR="#000000">(</FONT>"+123456789"<FONT COLOR="#000000">,</FONT> regexp_int<FONT COLOR="#000000">)</FONT>
     <FONT COLOR="#000000">val</FONT> ans12 <FONT COLOR="#000000">=</FONT> accept <FONT COLOR="#000000">(</FONT>"-123456789"<FONT COLOR="#000000">,</FONT> regexp_int<FONT COLOR="#000000">)</FONT>
     <FONT COLOR="#000000">val</FONT> ans20 <FONT COLOR="#000000">=</FONT> accept <FONT COLOR="#000000">(</FONT>"abcde"<FONT COLOR="#000000">,</FONT> regexp_int<FONT COLOR="#000000">)</FONT>
     <FONT COLOR="#000000">val</FONT> ans31 <FONT COLOR="#000000">=</FONT> accept <FONT COLOR="#000000">(</FONT>"abcde.sats"<FONT COLOR="#000000">,</FONT> regexp_dot_sats<FONT COLOR="#000000">)</FONT>
     <FONT COLOR="#000000">val</FONT> ans32 <FONT COLOR="#000000">=</FONT> accept <FONT COLOR="#000000">(</FONT>"abcde.sats"<FONT COLOR="#000000">,</FONT> regexp_dot_dats<FONT COLOR="#000000">)</FONT>
     <FONT COLOR="#000000">val</FONT> ans41 <FONT COLOR="#000000">=</FONT> accept <FONT COLOR="#000000">(</FONT>"abcde.dats"<FONT COLOR="#000000">,</FONT> regexp_dot_sats<FONT COLOR="#000000">)</FONT>
     <FONT COLOR="#000000">val</FONT> ans42 <FONT COLOR="#000000">=</FONT> accept <FONT COLOR="#000000">(</FONT>"abcde.dats"<FONT COLOR="#000000">,</FONT> regexp_dot_dats<FONT COLOR="#000000">)</FONT>
  <FONT COLOR="#000000">in</FONT>
     print <FONT COLOR="#000000">(</FONT>"ans10(true) = "<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">;</FONT> print ans10<FONT COLOR="#000000">;</FONT> print_newline <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">;</FONT>
     print <FONT COLOR="#000000">(</FONT>"ans11(true) = "<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">;</FONT> print ans11<FONT COLOR="#000000">;</FONT> print_newline <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">;</FONT>
     print <FONT COLOR="#000000">(</FONT>"ans12(true) = "<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">;</FONT> print ans12<FONT COLOR="#000000">;</FONT> print_newline <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">;</FONT>
     print <FONT COLOR="#000000">(</FONT>"ans20(false) = "<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">;</FONT> print ans20<FONT COLOR="#000000">;</FONT> print_newline <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">;</FONT>
     print <FONT COLOR="#000000">(</FONT>"ans31(true) = "<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">;</FONT> print ans31<FONT COLOR="#000000">;</FONT> print_newline <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">;</FONT>
     print <FONT COLOR="#000000">(</FONT>"ans32(false) = "<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">;</FONT> print ans32<FONT COLOR="#000000">;</FONT> print_newline <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">;</FONT>
     print <FONT COLOR="#000000">(</FONT>"ans41(false) = "<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">;</FONT> print ans41<FONT COLOR="#000000">;</FONT> print_newline <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">;</FONT>
     print <FONT COLOR="#000000">(</FONT>"ans42(true) = "<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">;</FONT> print ans42<FONT COLOR="#000000">;</FONT> print_newline <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">;</FONT>
  <FONT COLOR="#000000">end</FONT>

<FONT COLOR="#787878">(* ****** ****** *)</FONT>

<FONT COLOR="#787878">(* end of [strmat.dats] *)</FONT>
</PRE></BODY>
