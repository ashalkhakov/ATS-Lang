<BODY BGCOLOR="#E0E0E0" TEXT="#E80000"><PRE><FONT COLOR="#787878">(*
 * An implementation of Gentzen's cut elimination for intuitionistic linear
 * propositional logic with:
 *
 * 1. linear implication,
 * 2. linear multiplicative conjunction,
 * 3. linear additive conjunction, and
 * 4. linear additive disjunction
 *
 *)</FONT>

<FONT COLOR="#787878">// March 2005:
</FONT><FONT COLOR="#787878">// The code is completed by Sa Cui with some help from Hongwei Xi 
</FONT>
<FONT COLOR="#787878">// January 2007:
</FONT><FONT COLOR="#787878">// The code is ported to ATS/Geizella by Hongwei Xi
</FONT>
<FONT COLOR="#787878">// March 5th, 2008
</FONT><FONT COLOR="#787878">// It is verified by ATS/Anairiats (without any changes being made).
</FONT>
<FONT COLOR="#787878">(* ****** ****** *)</FONT>

<FONT COLOR="#800080"><FONT COLOR="#000000">nonfix</FONT></FONT> land
<FONT COLOR="#800080"><FONT COLOR="#000000">nonfix</FONT></FONT> lor

<FONT COLOR="#000000">datasort</FONT> <FONT COLOR="#0000FF">form  <FONT COLOR="#000000">=</FONT> <FONT COLOR="#787878">(* sort for formulas *)</FONT>
  <FONT COLOR="#000000">|</FONT> ltimes <FONT COLOR="#000000">of</FONT> <FONT COLOR="#000000">(</FONT>form<FONT COLOR="#000000">,</FONT> form<FONT COLOR="#000000">)</FONT> <FONT COLOR="#787878">// linear multplicative and
</FONT>  <FONT COLOR="#000000">|</FONT> land <FONT COLOR="#000000">of</FONT> <FONT COLOR="#000000">(</FONT>form<FONT COLOR="#000000">,</FONT> form<FONT COLOR="#000000">)</FONT>  <FONT COLOR="#787878">// linear additive and
</FONT>  <FONT COLOR="#000000">|</FONT> lor <FONT COLOR="#000000">of</FONT> <FONT COLOR="#000000">(</FONT>form<FONT COLOR="#000000">,</FONT> form<FONT COLOR="#000000">)</FONT> <FONT COLOR="#787878">// linear additive or
</FONT>  <FONT COLOR="#000000">|</FONT> limp <FONT COLOR="#000000">of</FONT> <FONT COLOR="#000000">(</FONT>form<FONT COLOR="#000000">,</FONT> form<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#787878">// linear implicative
</FONT>
<FONT COLOR="#000000">datasort</FONT> <FONT COLOR="#0000FF">seq <FONT COLOR="#000000">=</FONT> <FONT COLOR="#787878">(* sort for sequents *)</FONT>
  <FONT COLOR="#000000">|</FONT> none
  <FONT COLOR="#000000">|</FONT> more <FONT COLOR="#000000">of</FONT> <FONT COLOR="#000000">(</FONT>seq<FONT COLOR="#000000">,</FONT> form<FONT COLOR="#000000">,</FONT> int<FONT COLOR="#000000">)</FONT></FONT>

<FONT COLOR="#000000">dataprop</FONT> <FONT COLOR="#009000"><FONT COLOR="#0000FF">FM <FONT COLOR="#000000">(</FONT>form<FONT COLOR="#000000">,</FONT> int<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">A1<FONT COLOR="#000000">,</FONT>A2<FONT COLOR="#000000">:</FONT>form</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">n1<FONT COLOR="#000000">,</FONT>n2<FONT COLOR="#000000">:</FONT>nat</FONT><FONT COLOR="#000000">}</FONT> 
    FMand1 <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>ltimes <FONT COLOR="#000000">(</FONT>A1<FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> n1+n2+1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>FM <FONT COLOR="#000000">(</FONT>A1<FONT COLOR="#000000">,</FONT> n1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> FM <FONT COLOR="#000000">(</FONT>A2<FONT COLOR="#000000">,</FONT> n2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT>
  
  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">A1<FONT COLOR="#000000">,</FONT>A2<FONT COLOR="#000000">:</FONT>form</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">n1<FONT COLOR="#000000">,</FONT>n2<FONT COLOR="#000000">:</FONT>nat</FONT><FONT COLOR="#000000">}</FONT> 
    FMand2 <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>land <FONT COLOR="#000000">(</FONT>A1<FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> n1+n2+1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>FM <FONT COLOR="#000000">(</FONT>A1<FONT COLOR="#000000">,</FONT> n1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> FM <FONT COLOR="#000000">(</FONT>A2<FONT COLOR="#000000">,</FONT> n2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">A1<FONT COLOR="#000000">,</FONT>A2<FONT COLOR="#000000">:</FONT>form</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">n1<FONT COLOR="#000000">,</FONT>n2<FONT COLOR="#000000">:</FONT>nat</FONT><FONT COLOR="#000000">}</FONT> 
    FMor <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>lor <FONT COLOR="#000000">(</FONT>A1<FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> n1+n2+1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>FM <FONT COLOR="#000000">(</FONT>A1<FONT COLOR="#000000">,</FONT> n1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> FM <FONT COLOR="#000000">(</FONT>A2<FONT COLOR="#000000">,</FONT> n2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT>   

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">A1<FONT COLOR="#000000">,</FONT>A2<FONT COLOR="#000000">:</FONT>form</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">n1<FONT COLOR="#000000">,</FONT>n2<FONT COLOR="#000000">:</FONT>nat</FONT><FONT COLOR="#000000">}</FONT> 
    FMimp <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>limp <FONT COLOR="#000000">(</FONT>A1<FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> n1+n2+1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>FM <FONT COLOR="#000000">(</FONT>A1<FONT COLOR="#000000">,</FONT> n1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> FM <FONT COLOR="#000000">(</FONT>A2<FONT COLOR="#000000">,</FONT> n2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT></FONT>

<FONT COLOR="#000000">propdef</FONT> <FONT COLOR="#0000FF">FM0 <FONT COLOR="#000000">(</FONT>A <FONT COLOR="#000000">:</FONT> form<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> <FONT COLOR="#000000">[</FONT>n<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">]</FONT> FM <FONT COLOR="#000000">(</FONT>A<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT>

<FONT COLOR="#000000">dataprop</FONT> <FONT COLOR="#009000"><FONT COLOR="#0000FF">SEQeq <FONT COLOR="#000000">(</FONT>seq<FONT COLOR="#000000">,</FONT> seq<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">G<FONT COLOR="#000000">:</FONT>seq</FONT><FONT COLOR="#000000">}</FONT> SEQeq <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> G<FONT COLOR="#000000">)</FONT></FONT></FONT>

<FONT COLOR="#000000">dataprop</FONT> <FONT COLOR="#009000"><FONT COLOR="#0000FF">SEQ <FONT COLOR="#000000">(</FONT>seq<FONT COLOR="#000000">,</FONT> int<FONT COLOR="#000000">,</FONT> int<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>

  <FONT COLOR="#000000">|</FONT> SEQnone <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>none<FONT COLOR="#000000">,</FONT> 0<FONT COLOR="#000000">,</FONT> 0<FONT COLOR="#000000">)</FONT></FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">G<FONT COLOR="#000000">:</FONT>seq</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">A<FONT COLOR="#000000">:</FONT>form</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">n<FONT COLOR="#000000">,</FONT>w<FONT COLOR="#000000">,</FONT>i<FONT COLOR="#000000">:</FONT>nat</FONT> <FONT COLOR="#000000">|</FONT> <FONT COLOR="#0000FF">i <FONT COLOR="#000000">&lt;</FONT> 2</FONT><FONT COLOR="#000000">}</FONT>
      SEQmore <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>more <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> n+1<FONT COLOR="#000000">,</FONT> w+i<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF">SEQ <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">,</FONT> w<FONT COLOR="#000000">)</FONT></FONT></FONT>

<FONT COLOR="#000000">propdef</FONT> <FONT COLOR="#0000FF">SEQ0 <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">,</FONT> w<FONT COLOR="#000000">:</FONT>int<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> <FONT COLOR="#000000">[</FONT>n<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">]</FONT> SEQ <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">,</FONT> w<FONT COLOR="#000000">)</FONT></FONT>

<FONT COLOR="#000000">dataprop</FONT> <FONT COLOR="#009000"><FONT COLOR="#0000FF">IN <FONT COLOR="#000000">(</FONT>form<FONT COLOR="#000000">,</FONT> int<FONT COLOR="#000000">,</FONT> seq<FONT COLOR="#000000">,</FONT> int<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">G<FONT COLOR="#000000">:</FONT>seq</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">A<FONT COLOR="#000000">:</FONT>form</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">i<FONT COLOR="#000000">:</FONT>two</FONT><FONT COLOR="#000000">}</FONT> INone <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>A<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">,</FONT> more <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> 0<FONT COLOR="#000000">)</FONT></FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">G<FONT COLOR="#000000">:</FONT>seq</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">A<FONT COLOR="#000000">,</FONT>A'<FONT COLOR="#000000">:</FONT>form</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">k<FONT COLOR="#000000">,</FONT>i<FONT COLOR="#000000">,</FONT>i'<FONT COLOR="#000000">:</FONT>nat</FONT> <FONT COLOR="#000000">|</FONT> <FONT COLOR="#0000FF">i <FONT COLOR="#000000">&lt;</FONT> 2</FONT><FONT COLOR="#000000">;</FONT> <FONT COLOR="#0000FF">i' <FONT COLOR="#000000">&lt;</FONT> 2</FONT><FONT COLOR="#000000">}</FONT>
      INshi <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>A<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">,</FONT> more <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> A'<FONT COLOR="#000000">,</FONT> i'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> k+1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF">IN <FONT COLOR="#000000">(</FONT>A<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">,</FONT> G<FONT COLOR="#000000">,</FONT> k<FONT COLOR="#000000">)</FONT></FONT></FONT>

<FONT COLOR="#000000">propdef</FONT> <FONT COLOR="#0000FF">IN0 <FONT COLOR="#000000">(</FONT>A<FONT COLOR="#000000">:</FONT>form<FONT COLOR="#000000">,</FONT>i<FONT COLOR="#000000">:</FONT>int<FONT COLOR="#000000">,</FONT>G<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> <FONT COLOR="#000000">[</FONT>k<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">]</FONT> IN <FONT COLOR="#000000">(</FONT>A<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">,</FONT> G<FONT COLOR="#000000">,</FONT> k<FONT COLOR="#000000">)</FONT></FONT>

<FONT COLOR="#000000">dataprop</FONT> <FONT COLOR="#009000"><FONT COLOR="#0000FF">COMB <FONT COLOR="#000000">(</FONT>seq<FONT COLOR="#000000">,</FONT> seq<FONT COLOR="#000000">,</FONT> seq<FONT COLOR="#000000">,</FONT> int<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>

  <FONT COLOR="#000000">|</FONT> COMBnone <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>none<FONT COLOR="#000000">,</FONT> none<FONT COLOR="#000000">,</FONT> none<FONT COLOR="#000000">,</FONT> 0<FONT COLOR="#000000">)</FONT></FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">,</FONT>G3<FONT COLOR="#000000">:</FONT>seq</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">A<FONT COLOR="#000000">:</FONT>form</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">n<FONT COLOR="#000000">,</FONT>i1<FONT COLOR="#000000">,</FONT>i2<FONT COLOR="#000000">:</FONT>nat</FONT> <FONT COLOR="#000000">|</FONT> <FONT COLOR="#0000FF">i1+i2 <FONT COLOR="#000000">&lt;</FONT> 2</FONT><FONT COLOR="#000000">}</FONT>
      COMBmore <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>more <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> i1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> more <FONT COLOR="#000000">(</FONT>G2<FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> i2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> more <FONT COLOR="#000000">(</FONT>G3<FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> i1+i2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> n+1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT>
        <FONT COLOR="#0000FF">COMB <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT></FONT>

<FONT COLOR="#000000">propdef</FONT> <FONT COLOR="#0000FF">COMB0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> <FONT COLOR="#000000">[</FONT>n<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">]</FONT> COMB <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT>

<FONT COLOR="#000000">dataprop</FONT> <FONT COLOR="#009000"><FONT COLOR="#0000FF">ADD <FONT COLOR="#000000">(</FONT>seq<FONT COLOR="#000000">,</FONT> form<FONT COLOR="#000000">,</FONT> seq<FONT COLOR="#000000">,</FONT> int<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">G<FONT COLOR="#000000">:</FONT>seq</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">A<FONT COLOR="#000000">:</FONT>form</FONT><FONT COLOR="#000000">}</FONT> ADDone <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>more <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> 0<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> more <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> 1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> 0<FONT COLOR="#000000">)</FONT></FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">G<FONT COLOR="#000000">,</FONT>G'<FONT COLOR="#000000">:</FONT>seq</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">A<FONT COLOR="#000000">,</FONT>A'<FONT COLOR="#000000">:</FONT>form</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">k<FONT COLOR="#000000">,</FONT>i<FONT COLOR="#000000">:</FONT>nat</FONT> <FONT COLOR="#000000">|</FONT> <FONT COLOR="#0000FF">i <FONT COLOR="#000000">&lt;</FONT> 2</FONT><FONT COLOR="#000000">}</FONT>
    ADDshi <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>more <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> A'<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> more <FONT COLOR="#000000">(</FONT>G'<FONT COLOR="#000000">,</FONT> A'<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> k+1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF">ADD <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> G'<FONT COLOR="#000000">,</FONT> k<FONT COLOR="#000000">)</FONT></FONT></FONT>

<FONT COLOR="#000000">propdef</FONT> <FONT COLOR="#0000FF">ADD0 <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">:</FONT>form<FONT COLOR="#000000">,</FONT> G'<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> <FONT COLOR="#000000">[</FONT>k<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">]</FONT> ADD <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> G'<FONT COLOR="#000000">,</FONT> k<FONT COLOR="#000000">)</FONT></FONT>

<FONT COLOR="#000000">dataprop</FONT> <FONT COLOR="#009000"><FONT COLOR="#0000FF">DER <FONT COLOR="#000000">(</FONT>seq<FONT COLOR="#000000">,</FONT> form<FONT COLOR="#000000">,</FONT> int<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">G<FONT COLOR="#000000">:</FONT>seq</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">A<FONT COLOR="#000000">:</FONT>form</FONT><FONT COLOR="#000000">}</FONT> DERaxi <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> 0<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>SEQ0 <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> 1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> IN0 <FONT COLOR="#000000">(</FONT>A<FONT COLOR="#000000">,</FONT> 1<FONT COLOR="#000000">,</FONT> G<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">G<FONT COLOR="#000000">:</FONT>seq</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">A<FONT COLOR="#000000">:</FONT>form</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">n<FONT COLOR="#000000">:</FONT>nat</FONT><FONT COLOR="#000000">}</FONT> DERleft <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> n+1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF">DERL <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">G<FONT COLOR="#000000">:</FONT>seq</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">A<FONT COLOR="#000000">:</FONT>form</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">n<FONT COLOR="#000000">:</FONT>nat</FONT><FONT COLOR="#000000">}</FONT> DERright <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> n+1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF">DERR <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT>

<FONT COLOR="#000000">and</FONT> <FONT COLOR="#0000FF">DERL <FONT COLOR="#000000">(</FONT>seq<FONT COLOR="#000000">,</FONT> form<FONT COLOR="#000000">,</FONT> int<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">:</FONT>seq</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">A1<FONT COLOR="#000000">,</FONT>A2<FONT COLOR="#000000">,</FONT>A3<FONT COLOR="#000000">:</FONT>form</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">n<FONT COLOR="#000000">:</FONT>nat</FONT><FONT COLOR="#000000">}</FONT>
      DERLtimes <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>G2<FONT COLOR="#000000">,</FONT> A3<FONT COLOR="#000000">,</FONT> n+1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT>
        <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>DER <FONT COLOR="#000000">(</FONT>more <FONT COLOR="#000000">(</FONT>more <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> A1<FONT COLOR="#000000">,</FONT> 1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">,</FONT> 1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> A3<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> 
              ADD0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> ltimes <FONT COLOR="#000000">(</FONT>A1<FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">:</FONT>seq</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">A1<FONT COLOR="#000000">,</FONT>A2<FONT COLOR="#000000">,</FONT>A3<FONT COLOR="#000000">:</FONT>form</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">n<FONT COLOR="#000000">:</FONT>nat</FONT><FONT COLOR="#000000">}</FONT>
      DERLand1 <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>G2<FONT COLOR="#000000">,</FONT> A3<FONT COLOR="#000000">,</FONT> n+1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT>
        <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>DER <FONT COLOR="#000000">(</FONT>more <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> A1<FONT COLOR="#000000">,</FONT> 1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> A3<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> ADD0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> land <FONT COLOR="#000000">(</FONT>A1<FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">:</FONT>seq</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">A1<FONT COLOR="#000000">,</FONT>A2<FONT COLOR="#000000">,</FONT>A3<FONT COLOR="#000000">:</FONT>form</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">n<FONT COLOR="#000000">:</FONT>nat</FONT><FONT COLOR="#000000">}</FONT>
      DERLand2 <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>G2<FONT COLOR="#000000">,</FONT> A3<FONT COLOR="#000000">,</FONT> n+1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT>
        <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>DER <FONT COLOR="#000000">(</FONT>more <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">,</FONT> 1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> A3<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> ADD0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> land <FONT COLOR="#000000">(</FONT>A1<FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">:</FONT>seq</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">A1<FONT COLOR="#000000">,</FONT>A2<FONT COLOR="#000000">,</FONT>A3<FONT COLOR="#000000">:</FONT>form</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">n1<FONT COLOR="#000000">,</FONT>n2<FONT COLOR="#000000">:</FONT>nat</FONT><FONT COLOR="#000000">}</FONT>
      DERLor <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>G2<FONT COLOR="#000000">,</FONT> A3<FONT COLOR="#000000">,</FONT> n1+n2+1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT>
        <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>DER <FONT COLOR="#000000">(</FONT>more <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> A1<FONT COLOR="#000000">,</FONT> 1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> A3<FONT COLOR="#000000">,</FONT> n1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> DER <FONT COLOR="#000000">(</FONT>more <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">,</FONT> 1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> A3<FONT COLOR="#000000">,</FONT> n2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> 
         ADD0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> lor <FONT COLOR="#000000">(</FONT>A1<FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">,</FONT>G3<FONT COLOR="#000000">,</FONT>G4<FONT COLOR="#000000">:</FONT>seq</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">A1<FONT COLOR="#000000">,</FONT>A2<FONT COLOR="#000000">,</FONT>A3<FONT COLOR="#000000">:</FONT>form</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">n1<FONT COLOR="#000000">,</FONT>n2<FONT COLOR="#000000">:</FONT>nat</FONT><FONT COLOR="#000000">}</FONT>
      DERLimp <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>G4<FONT COLOR="#000000">,</FONT> A3<FONT COLOR="#000000">,</FONT> n1+n2+1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT>
        <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>DER <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> A1<FONT COLOR="#000000">,</FONT> n1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> DER <FONT COLOR="#000000">(</FONT>more <FONT COLOR="#000000">(</FONT>G2<FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">,</FONT> 1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> A3<FONT COLOR="#000000">,</FONT> n2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT>
         COMB0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> ADD0 <FONT COLOR="#000000">(</FONT>G3<FONT COLOR="#000000">,</FONT> limp <FONT COLOR="#000000">(</FONT>A1<FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> G4<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT>

<FONT COLOR="#000000">and</FONT> <FONT COLOR="#0000FF">DERR <FONT COLOR="#000000">(</FONT>seq<FONT COLOR="#000000">,</FONT> form<FONT COLOR="#000000">,</FONT> int<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">,</FONT>G3<FONT COLOR="#000000">:</FONT>seq</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">A1<FONT COLOR="#000000">,</FONT>A2<FONT COLOR="#000000">:</FONT>form</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">n1<FONT COLOR="#000000">,</FONT>n2<FONT COLOR="#000000">:</FONT>nat</FONT><FONT COLOR="#000000">}</FONT>
      DERRand1 <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>G3<FONT COLOR="#000000">,</FONT> ltimes <FONT COLOR="#000000">(</FONT>A1<FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> n1+n2+1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT>
        <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>DER <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> A1<FONT COLOR="#000000">,</FONT> n1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> DER <FONT COLOR="#000000">(</FONT>G2<FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">,</FONT> n2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> COMB0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT>
  
  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">G<FONT COLOR="#000000">:</FONT>seq</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">A1<FONT COLOR="#000000">,</FONT>A2<FONT COLOR="#000000">:</FONT>form</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">n1<FONT COLOR="#000000">,</FONT>n2<FONT COLOR="#000000">:</FONT>nat</FONT><FONT COLOR="#000000">}</FONT>
      DERRand2 <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> land <FONT COLOR="#000000">(</FONT>A1<FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> n1+n2+1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT>
        <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>DER <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> A1<FONT COLOR="#000000">,</FONT> n1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> DER <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">,</FONT> n2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">G<FONT COLOR="#000000">:</FONT>seq</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">A1<FONT COLOR="#000000">,</FONT>A2<FONT COLOR="#000000">:</FONT>form</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">n<FONT COLOR="#000000">:</FONT>nat</FONT><FONT COLOR="#000000">}</FONT>
      DERRor1 <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> lor <FONT COLOR="#000000">(</FONT>A1<FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> n+1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF">DER <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> A1<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">G<FONT COLOR="#000000">:</FONT>seq</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">A1<FONT COLOR="#000000">,</FONT>A2<FONT COLOR="#000000">:</FONT>form</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">n<FONT COLOR="#000000">:</FONT>nat</FONT><FONT COLOR="#000000">}</FONT>
      DERRor2 <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> lor <FONT COLOR="#000000">(</FONT>A1<FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> n+1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF">DER <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">G<FONT COLOR="#000000">:</FONT>seq</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">A1<FONT COLOR="#000000">,</FONT>A2<FONT COLOR="#000000">:</FONT>form</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">n<FONT COLOR="#000000">:</FONT>nat</FONT><FONT COLOR="#000000">}</FONT>
      DERRimp <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> limp <FONT COLOR="#000000">(</FONT>A1<FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> n+1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF">DER <FONT COLOR="#000000">(</FONT>more <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> A1<FONT COLOR="#000000">,</FONT> 1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT></FONT>

<FONT COLOR="#000000">propdef</FONT> <FONT COLOR="#0000FF">DER0 <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">:</FONT>form<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> <FONT COLOR="#000000">[</FONT>n<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">]</FONT> DER<FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT>

<FONT COLOR="#787878">//
</FONT>
<FONT COLOR="#000000">dataprop</FONT> <FONT COLOR="#009000"><FONT COLOR="#0000FF">EXCH <FONT COLOR="#000000">(</FONT>seq<FONT COLOR="#000000">,</FONT> seq<FONT COLOR="#000000">,</FONT> int<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">G<FONT COLOR="#000000">:</FONT>seq</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">A1<FONT COLOR="#000000">,</FONT>A2<FONT COLOR="#000000">:</FONT>form</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">i1<FONT COLOR="#000000">,</FONT>i2<FONT COLOR="#000000">:</FONT>two</FONT><FONT COLOR="#000000">}</FONT> 
    EXCHone <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>more <FONT COLOR="#000000">(</FONT>more <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> A1<FONT COLOR="#000000">,</FONT> i1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">,</FONT> i2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> more <FONT COLOR="#000000">(</FONT>more <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">,</FONT> i2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> A1<FONT COLOR="#000000">,</FONT> i1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> 0<FONT COLOR="#000000">)</FONT></FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">:</FONT>seq</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">A<FONT COLOR="#000000">:</FONT>form</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">n<FONT COLOR="#000000">,</FONT>i<FONT COLOR="#000000">:</FONT>nat</FONT> <FONT COLOR="#000000">|</FONT> <FONT COLOR="#0000FF">i <FONT COLOR="#000000">&lt;</FONT> 2</FONT><FONT COLOR="#000000">}</FONT>
    EXCHshi <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>more <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> more <FONT COLOR="#000000">(</FONT>G2<FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> n+1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF">EXCH <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT></FONT>

<FONT COLOR="#000000">propdef</FONT> <FONT COLOR="#0000FF">EXCH0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> <FONT COLOR="#000000">[</FONT>n<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">]</FONT> EXCH <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT>

<FONT COLOR="#787878">//
</FONT>
<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">lemma01 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>A<FONT COLOR="#000000">:</FONT>form<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>n<FONT COLOR="#000000">,</FONT>w<FONT COLOR="#000000">,</FONT>k<FONT COLOR="#000000">,</FONT>i<FONT COLOR="#000000">:</FONT>nat <FONT COLOR="#000000">|</FONT> i <FONT COLOR="#000000">&lt;</FONT> 2<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>k<FONT COLOR="#000000">&gt;.</FONT></FONT>
  <FONT COLOR="#000000">(</FONT>g<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">SEQ <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">,</FONT> w<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">IN <FONT COLOR="#000000">(</FONT>A<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">,</FONT> G<FONT COLOR="#000000">,</FONT> k<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">[</FONT>n &gt;= k<FONT COLOR="#000000">;</FONT> w &gt;= i<FONT COLOR="#000000">]</FONT> void</FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">case+</FONT> i <FONT COLOR="#000000">of</FONT>
    <FONT COLOR="#000000">|</FONT> INone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">SEQmore g' <FONT COLOR="#000000">=</FONT> g</FONT> <FONT COLOR="#000000">in</FONT> <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">end</FONT>
    <FONT COLOR="#000000">|</FONT> INshi i' <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
         <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">SEQmore g' <FONT COLOR="#000000">=</FONT> g</FONT>
         <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma01 <FONT COLOR="#000000">(</FONT>g'<FONT COLOR="#000000">,</FONT> i'<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">in</FONT>
         <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT>
      <FONT COLOR="#000000">end</FONT></FONT>

<FONT COLOR="#787878">//
</FONT>
<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">lemma02 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G<FONT COLOR="#000000">,</FONT>G'<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>n<FONT COLOR="#000000">,</FONT>w<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>n<FONT COLOR="#000000">&gt;.</FONT></FONT>
  <FONT COLOR="#000000">(</FONT>g<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">SEQ <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">,</FONT> w<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> ex<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">EXCH0 <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> G'<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">[</FONT>n &gt;= 2<FONT COLOR="#000000">]</FONT> void</FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">case+</FONT> ex <FONT COLOR="#000000">of</FONT>
    <FONT COLOR="#000000">|</FONT> EXCHone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">SEQmore <FONT COLOR="#000000">(</FONT>SEQmore g'<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> g</FONT> <FONT COLOR="#000000">in</FONT> <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">end</FONT>
    <FONT COLOR="#000000">|</FONT> EXCHshi ex' <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
         <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">SEQmore g' <FONT COLOR="#000000">=</FONT> g</FONT>
         <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma02 <FONT COLOR="#000000">(</FONT>g'<FONT COLOR="#000000">,</FONT> ex'<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">in</FONT>
         <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT>
      <FONT COLOR="#000000">end</FONT></FONT>

<FONT COLOR="#787878">//
</FONT>
<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">lemma03 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">,</FONT>G3<FONT COLOR="#000000">,</FONT>G3'<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>n<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>n<FONT COLOR="#000000">&gt;.</FONT></FONT>
  <FONT COLOR="#000000">(</FONT>c<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">COMB <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> ex<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">EXCH0 <FONT COLOR="#000000">(</FONT>G3<FONT COLOR="#000000">,</FONT> G3'<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">[</FONT>n &gt;= 2<FONT COLOR="#000000">]</FONT> void</FONT> <FONT COLOR="#000000">=</FONT> 
  <FONT COLOR="#000000">case+</FONT> ex <FONT COLOR="#000000">of</FONT>
    <FONT COLOR="#000000">|</FONT> EXCHone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">COMBmore <FONT COLOR="#000000">(</FONT>COMBmore c'<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> c</FONT> <FONT COLOR="#000000">in</FONT> <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">end</FONT>
    <FONT COLOR="#000000">|</FONT> EXCHshi ex' <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
         <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">COMBmore c' <FONT COLOR="#000000">=</FONT> c</FONT>
         <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma03 <FONT COLOR="#000000">(</FONT>c'<FONT COLOR="#000000">,</FONT> ex'<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">in</FONT>
         <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT>
      <FONT COLOR="#000000">end</FONT></FONT>

<FONT COLOR="#787878">// [COMB] is functional
</FONT>
<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">lemma10 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">,</FONT>G12<FONT COLOR="#000000">,</FONT>G21<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>n1<FONT COLOR="#000000">,</FONT>n2<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>n1<FONT COLOR="#000000">&gt;.</FONT></FONT>
  <FONT COLOR="#000000">(</FONT>c12<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">COMB <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">,</FONT> G12<FONT COLOR="#000000">,</FONT> n1<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> c21<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">COMB <FONT COLOR="#000000">(</FONT>G2<FONT COLOR="#000000">,</FONT> G1<FONT COLOR="#000000">,</FONT> G21<FONT COLOR="#000000">,</FONT> n2<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT>
  <FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">[</FONT>n1 == n2<FONT COLOR="#000000">]</FONT> SEQeq <FONT COLOR="#000000">(</FONT>G12<FONT COLOR="#000000">,</FONT> G21<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">case+</FONT> <FONT COLOR="#000000">(</FONT>c12<FONT COLOR="#000000">,</FONT> c21<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">of</FONT>
    <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">(</FONT>COMBnone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> COMBnone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> SEQeq
    <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">(</FONT>COMBmore c12<FONT COLOR="#000000">,</FONT> COMBmore c21<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT>
      <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">SEQeq <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma10 <FONT COLOR="#000000">(</FONT>c12<FONT COLOR="#000000">,</FONT> c21<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">in</FONT> SEQeq <FONT COLOR="#000000">end</FONT></FONT>

<FONT COLOR="#787878">// [COMB] is commutative
</FONT>
<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">lemma11 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">,</FONT>G3<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>n<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>n<FONT COLOR="#000000">&gt;.</FONT></FONT>
  <FONT COLOR="#000000">(</FONT>c<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">COMB <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">COMB <FONT COLOR="#000000">(</FONT>G2<FONT COLOR="#000000">,</FONT> G1<FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">case+</FONT> c <FONT COLOR="#000000">of</FONT>
    <FONT COLOR="#000000">|</FONT> COMBnone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> COMBnone
    <FONT COLOR="#000000">|</FONT> COMBmore c' <FONT COLOR="#000000">=&gt;</FONT> COMBmore <FONT COLOR="#000000">(</FONT>lemma11 c'<FONT COLOR="#000000">)</FONT></FONT>

<FONT COLOR="#787878">// [COMB] is associative
</FONT>
<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">lemma12 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">,</FONT>G12<FONT COLOR="#000000">,</FONT>G3<FONT COLOR="#000000">,</FONT>G123<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>n<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>n<FONT COLOR="#000000">&gt;.</FONT></FONT>
  <FONT COLOR="#000000">(</FONT>c12<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">COMB <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">,</FONT> G12<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> c123<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">COMB0 <FONT COLOR="#000000">(</FONT>G12<FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">,</FONT> G123<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT>
  <FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">[</FONT>G23<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">]</FONT> <FONT COLOR="#000000">(</FONT>COMB0 <FONT COLOR="#000000">(</FONT>G2<FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">,</FONT> G23<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> COMB0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G23<FONT COLOR="#000000">,</FONT> G123<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT> 
  <FONT COLOR="#000000">case+</FONT> <FONT COLOR="#000000">(</FONT>c12<FONT COLOR="#000000">,</FONT> c123<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">of</FONT>
    <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">(</FONT>COMBnone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> COMBnone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">(</FONT>COMBnone<FONT COLOR="#000000">,</FONT> COMBnone<FONT COLOR="#000000">)</FONT>

    <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">(</FONT>COMBmore <FONT COLOR="#000000">(</FONT>c1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> COMBmore <FONT COLOR="#000000">(</FONT>c2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> 
      <FONT COLOR="#000000">let</FONT>
         <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>pf1<FONT COLOR="#000000">,</FONT> pf2<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma12 <FONT COLOR="#000000">(</FONT>c1<FONT COLOR="#000000">,</FONT> c2<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">in</FONT>
	 <FONT COLOR="#000000">(</FONT>COMBmore <FONT COLOR="#000000">(</FONT>pf1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> COMBmore <FONT COLOR="#000000">(</FONT>pf2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
      <FONT COLOR="#000000">end</FONT></FONT>

<FONT COLOR="#000000">prfn</FONT> <FONT COLOR="#009000">lemma13 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">,</FONT>G3<FONT COLOR="#000000">,</FONT>G21<FONT COLOR="#000000">,</FONT>G22<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">}</FONT></FONT>
  <FONT COLOR="#000000">(</FONT>c1<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">COMB0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> c2<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">COMB0 <FONT COLOR="#000000">(</FONT>G21<FONT COLOR="#000000">,</FONT> G22<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT>
  <FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">[</FONT>G<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">]</FONT> <FONT COLOR="#000000">(</FONT>COMB0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G22<FONT COLOR="#000000">,</FONT> G<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> COMB0 <FONT COLOR="#000000">(</FONT>G21<FONT COLOR="#000000">,</FONT> G<FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT> <FONT COLOR="#000000">let</FONT> 
     <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>c3<FONT COLOR="#000000">,</FONT> c4<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma12 <FONT COLOR="#000000">(</FONT>c2<FONT COLOR="#000000">,</FONT> lemma11 c1<FONT COLOR="#000000">)</FONT></FONT> 
  <FONT COLOR="#000000">in</FONT>
     <FONT COLOR="#000000">(</FONT>lemma11 c3<FONT COLOR="#000000">,</FONT> c4<FONT COLOR="#000000">)</FONT>
  <FONT COLOR="#000000">end</FONT></FONT>

<FONT COLOR="#000000">prfn</FONT> <FONT COLOR="#009000">lemma14 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">,</FONT>G3<FONT COLOR="#000000">,</FONT>G21<FONT COLOR="#000000">,</FONT>G22<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">}</FONT></FONT>
  <FONT COLOR="#000000">(</FONT>c1<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">COMB0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> c2<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">COMB0 <FONT COLOR="#000000">(</FONT>G21<FONT COLOR="#000000">,</FONT> G22<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT>
  <FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">[</FONT>G<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">]</FONT> <FONT COLOR="#000000">(</FONT>COMB0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G21<FONT COLOR="#000000">,</FONT> G<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> COMB0 <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> G22<FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT> <FONT COLOR="#000000">let</FONT> 
     <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>c3<FONT COLOR="#000000">,</FONT> c4<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma13 <FONT COLOR="#000000">(</FONT>c1<FONT COLOR="#000000">,</FONT> lemma11 c2<FONT COLOR="#000000">)</FONT></FONT> 
  <FONT COLOR="#000000">in</FONT>
     <FONT COLOR="#000000">(</FONT>c3<FONT COLOR="#000000">,</FONT> lemma11 c4<FONT COLOR="#000000">)</FONT>
  <FONT COLOR="#000000">end</FONT></FONT>

<FONT COLOR="#000000">prfn</FONT> <FONT COLOR="#009000">lemma15 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">,</FONT>G3<FONT COLOR="#000000">,</FONT>G21<FONT COLOR="#000000">,</FONT>G22<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">}</FONT></FONT>
  <FONT COLOR="#000000">(</FONT>c1<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">COMB0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> c2<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">COMB0 <FONT COLOR="#000000">(</FONT>G21<FONT COLOR="#000000">,</FONT> G22<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT>
  <FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">[</FONT>G<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">]</FONT> <FONT COLOR="#000000">(</FONT>COMB0 <FONT COLOR="#000000">(</FONT>G21<FONT COLOR="#000000">,</FONT> G1<FONT COLOR="#000000">,</FONT> G<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> COMB0 <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> G22<FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT> <FONT COLOR="#000000">let</FONT> 
     <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>c3<FONT COLOR="#000000">,</FONT> c4<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma14 <FONT COLOR="#000000">(</FONT>c1<FONT COLOR="#000000">,</FONT> c2<FONT COLOR="#000000">)</FONT></FONT> 
  <FONT COLOR="#000000">in</FONT>
     <FONT COLOR="#000000">(</FONT>lemma11 c3<FONT COLOR="#000000">,</FONT> c4<FONT COLOR="#000000">)</FONT>
  <FONT COLOR="#000000">end</FONT></FONT>

<FONT COLOR="#787878">//
</FONT>
<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">lemma20 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">,</FONT>G3<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>m<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>m<FONT COLOR="#000000">&gt;.</FONT></FONT>
  <FONT COLOR="#000000">(</FONT>c<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">COMB0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> g<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">SEQ <FONT COLOR="#000000">(</FONT>G2<FONT COLOR="#000000">,</FONT> m<FONT COLOR="#000000">,</FONT> 0<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">SEQeq <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">case+</FONT> <FONT COLOR="#000000">(</FONT>c<FONT COLOR="#000000">,</FONT> g<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">of</FONT>
  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">(</FONT>COMBnone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> SEQnone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> SEQeq
  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">(</FONT>COMBmore c'<FONT COLOR="#000000">,</FONT> SEQmore g'<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">SEQeq <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma20 <FONT COLOR="#000000">(</FONT>c'<FONT COLOR="#000000">,</FONT> g'<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">in</FONT>
      SEQeq <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT></FONT>

<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">lemma21 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">,</FONT>G3<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>m<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>m<FONT COLOR="#000000">&gt;.</FONT></FONT>
  <FONT COLOR="#000000">(</FONT>c<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">COMB0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> g<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">SEQ <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> m<FONT COLOR="#000000">,</FONT> 0<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">SEQeq <FONT COLOR="#000000">(</FONT>G2<FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  lemma20 <FONT COLOR="#000000">(</FONT>lemma11 c<FONT COLOR="#000000">,</FONT> g<FONT COLOR="#000000">)</FONT></FONT>

<FONT COLOR="#787878">//
</FONT>
<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">lemma30 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>n<FONT COLOR="#000000">,</FONT>w<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>n<FONT COLOR="#000000">&gt;.</FONT></FONT>
  <FONT COLOR="#000000">(</FONT>g<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">SEQ <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">,</FONT> w<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> ex<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">EXCH0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">SEQ <FONT COLOR="#000000">(</FONT>G2<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">,</FONT> w<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">case+</FONT> g <FONT COLOR="#000000">of</FONT>
  <FONT COLOR="#000000">|</FONT> SEQnone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=/=&gt;</FONT> <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma02 <FONT COLOR="#000000">(</FONT>g<FONT COLOR="#000000">,</FONT> ex<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">in</FONT> <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">end</FONT> 
  <FONT COLOR="#000000">|</FONT> SEQmore <FONT COLOR="#000000">(</FONT>SEQnone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=/=&gt;</FONT> <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma02 <FONT COLOR="#000000">(</FONT>g<FONT COLOR="#000000">,</FONT> ex<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">in</FONT> <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">end</FONT>
  <FONT COLOR="#000000">|</FONT> SEQmore <FONT COLOR="#000000">(</FONT>SEQmore g'<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">begin</FONT> <FONT COLOR="#000000">case+</FONT> ex <FONT COLOR="#000000">of</FONT>
    <FONT COLOR="#000000">|</FONT> EXCHone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT>  SEQmore <FONT COLOR="#000000">(</FONT>SEQmore g'<FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">|</FONT> EXCHshi ex' <FONT COLOR="#000000">=&gt;</FONT> SEQmore <FONT COLOR="#000000">(</FONT>lemma30 <FONT COLOR="#000000">(</FONT>SEQmore g'<FONT COLOR="#000000">,</FONT> ex'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT></FONT>

<FONT COLOR="#787878">//
</FONT>
<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">lemma31 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>A<FONT COLOR="#000000">:</FONT>form<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>k<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>k<FONT COLOR="#000000">&gt;.</FONT></FONT>
  <FONT COLOR="#000000">(</FONT>i<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">IN <FONT COLOR="#000000">(</FONT>A<FONT COLOR="#000000">,</FONT> 1<FONT COLOR="#000000">,</FONT> G1<FONT COLOR="#000000">,</FONT> k<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> ex<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">EXCH0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">IN0 <FONT COLOR="#000000">(</FONT>A<FONT COLOR="#000000">,</FONT> 1<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">case+</FONT> i <FONT COLOR="#000000">of</FONT>
  <FONT COLOR="#000000">|</FONT> INone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">begin</FONT> <FONT COLOR="#000000">case+</FONT> ex <FONT COLOR="#000000">of</FONT>
    <FONT COLOR="#000000">|</FONT> EXCHone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> INshi INone <FONT COLOR="#000000">|</FONT> EXCHshi ex' <FONT COLOR="#000000">=&gt;</FONT> INone
    <FONT COLOR="#000000">end</FONT>
  <FONT COLOR="#000000">|</FONT> INshi i' <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">begin</FONT> <FONT COLOR="#000000">case+</FONT> ex <FONT COLOR="#000000">of</FONT>
    <FONT COLOR="#000000">|</FONT> EXCHone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">begin</FONT> <FONT COLOR="#000000">case+</FONT> i' <FONT COLOR="#000000">of</FONT>
      <FONT COLOR="#000000">|</FONT> INone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> INone <FONT COLOR="#000000">|</FONT> INshi i1 <FONT COLOR="#000000">=&gt;</FONT> INshi <FONT COLOR="#000000">(</FONT>INshi i1<FONT COLOR="#000000">)</FONT>
      <FONT COLOR="#000000">end</FONT>
    <FONT COLOR="#000000">|</FONT> EXCHshi ex' <FONT COLOR="#000000">=&gt;</FONT> INshi <FONT COLOR="#000000">(</FONT>lemma31 <FONT COLOR="#000000">(</FONT>i'<FONT COLOR="#000000">,</FONT> ex'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
  <FONT COLOR="#000000">end</FONT></FONT>

<FONT COLOR="#787878">//
</FONT>
<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">lemma32 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">,</FONT>G1'<FONT COLOR="#000000">,</FONT>G2'<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>A<FONT COLOR="#000000">:</FONT>form<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>n<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>n<FONT COLOR="#000000">&gt;.</FONT></FONT>
  <FONT COLOR="#000000">(</FONT>add<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">ADD0 <FONT COLOR="#000000">(</FONT>G1'<FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> G1<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> ex<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">EXCH <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT>
  <FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">[</FONT>G2'<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">]</FONT> <FONT COLOR="#000000">(</FONT>EXCH <FONT COLOR="#000000">(</FONT>G1'<FONT COLOR="#000000">,</FONT> G2'<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> ADD0 <FONT COLOR="#000000">(</FONT>G2'<FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">case+</FONT> <FONT COLOR="#000000">(</FONT>ex<FONT COLOR="#000000">,</FONT> add<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">of</FONT>
  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">(</FONT>EXCHone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> ADDone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">(</FONT>EXCHone<FONT COLOR="#000000">,</FONT> ADDshi ADDone<FONT COLOR="#000000">)</FONT>
  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">(</FONT>EXCHone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> ADDshi <FONT COLOR="#000000">(</FONT>ADDone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">(</FONT>EXCHone<FONT COLOR="#000000">,</FONT> ADDone<FONT COLOR="#000000">)</FONT>
  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">(</FONT>EXCHone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> ADDshi <FONT COLOR="#000000">(</FONT>ADDshi add'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> 
      <FONT COLOR="#000000">(</FONT>EXCHone<FONT COLOR="#000000">,</FONT> ADDshi <FONT COLOR="#000000">(</FONT>ADDshi add'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>	
  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">(</FONT>EXCHshi ex'<FONT COLOR="#000000">,</FONT> ADDone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">(</FONT>EXCHshi ex'<FONT COLOR="#000000">,</FONT> ADDone<FONT COLOR="#000000">)</FONT>
  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">(</FONT>EXCHshi ex'<FONT COLOR="#000000">,</FONT> ADDshi add'<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>ex1<FONT COLOR="#000000">,</FONT> add1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma32 <FONT COLOR="#000000">(</FONT>add'<FONT COLOR="#000000">,</FONT> ex'<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">in</FONT>
      <FONT COLOR="#000000">(</FONT>EXCHshi ex1<FONT COLOR="#000000">,</FONT> ADDshi add1<FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT></FONT> 

<FONT COLOR="#787878">//
</FONT>
<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">lemma33 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">,</FONT>G3<FONT COLOR="#000000">,</FONT>G3'<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>n<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>n<FONT COLOR="#000000">&gt;.</FONT></FONT>
  <FONT COLOR="#000000">(</FONT>c<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">COMB <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> ex<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">EXCH0 <FONT COLOR="#000000">(</FONT>G3<FONT COLOR="#000000">,</FONT> G3'<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT>
  <FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">[</FONT>G1'<FONT COLOR="#000000">,</FONT>G2'<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">]</FONT> 
      <FONT COLOR="#000000">(</FONT>EXCH0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G1'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> EXCH0 <FONT COLOR="#000000">(</FONT>G2<FONT COLOR="#000000">,</FONT> G2'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> COMB <FONT COLOR="#000000">(</FONT>G1'<FONT COLOR="#000000">,</FONT> G2'<FONT COLOR="#000000">,</FONT> G3'<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">case+</FONT> c <FONT COLOR="#000000">of</FONT>
  <FONT COLOR="#000000">|</FONT> COMBnone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=/=&gt;</FONT> <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma03 <FONT COLOR="#000000">(</FONT>c<FONT COLOR="#000000">,</FONT> ex<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">in</FONT> <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">end</FONT>
  <FONT COLOR="#000000">|</FONT> COMBmore <FONT COLOR="#000000">(</FONT>COMBnone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=/=&gt;</FONT> <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma03 <FONT COLOR="#000000">(</FONT>c<FONT COLOR="#000000">,</FONT> ex<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">in</FONT> <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">end</FONT>
  <FONT COLOR="#000000">|</FONT> COMBmore <FONT COLOR="#000000">(</FONT>COMBmore c'<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">begin</FONT> <FONT COLOR="#000000">case+</FONT> ex <FONT COLOR="#000000">of</FONT>
    <FONT COLOR="#000000">|</FONT> EXCHone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">(</FONT>EXCHone<FONT COLOR="#000000">,</FONT> EXCHone<FONT COLOR="#000000">,</FONT> COMBmore <FONT COLOR="#000000">(</FONT>COMBmore c'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">|</FONT> EXCHshi ex' <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
        <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>ex1<FONT COLOR="#000000">,</FONT> ex2<FONT COLOR="#000000">,</FONT> c1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma33 <FONT COLOR="#000000">(</FONT>COMBmore c'<FONT COLOR="#000000">,</FONT> ex'<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">in</FONT>
        <FONT COLOR="#000000">(</FONT>EXCHshi ex1<FONT COLOR="#000000">,</FONT> EXCHshi ex2<FONT COLOR="#000000">,</FONT> COMBmore c1<FONT COLOR="#000000">)</FONT>
       <FONT COLOR="#000000">end</FONT>
    <FONT COLOR="#000000">end</FONT></FONT>

<FONT COLOR="#787878">//
</FONT>
<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">exchGeneral <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>A<FONT COLOR="#000000">:</FONT>form<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>n<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>n<FONT COLOR="#000000">&gt;.</FONT></FONT>
     <FONT COLOR="#000000">(</FONT>d<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DER <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> ex<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">EXCH0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DER <FONT COLOR="#000000">(</FONT>G2<FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">case+</FONT> d <FONT COLOR="#000000">of</FONT>
  <FONT COLOR="#000000">|</FONT> DERaxi <FONT COLOR="#000000">(</FONT>g<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> DERaxi <FONT COLOR="#000000">(</FONT>lemma30 <FONT COLOR="#000000">(</FONT>g<FONT COLOR="#000000">,</FONT> ex<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> lemma31 <FONT COLOR="#000000">(</FONT>i<FONT COLOR="#000000">,</FONT> ex<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
  <FONT COLOR="#000000">|</FONT> DERleft <FONT COLOR="#000000">(</FONT>DERLtimes <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> add<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>ex1<FONT COLOR="#000000">,</FONT> add1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma32 <FONT COLOR="#000000">(</FONT>add<FONT COLOR="#000000">,</FONT> ex<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d1' <FONT COLOR="#000000">=</FONT> exchGeneral <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> EXCHshi <FONT COLOR="#000000">(</FONT>EXCHshi ex1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">in</FONT>
      DERleft <FONT COLOR="#000000">(</FONT>DERLtimes <FONT COLOR="#000000">(</FONT>d1'<FONT COLOR="#000000">,</FONT> add1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT>
     
  <FONT COLOR="#000000">|</FONT> DERleft <FONT COLOR="#000000">(</FONT>DERLand1 <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> add<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>ex1<FONT COLOR="#000000">,</FONT> add1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma32 <FONT COLOR="#000000">(</FONT>add<FONT COLOR="#000000">,</FONT> ex<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d1' <FONT COLOR="#000000">=</FONT> exchGeneral <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> EXCHshi ex1<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">in</FONT>
      DERleft <FONT COLOR="#000000">(</FONT>DERLand1 <FONT COLOR="#000000">(</FONT>d1'<FONT COLOR="#000000">,</FONT> add1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT>
    
  <FONT COLOR="#000000">|</FONT> DERleft <FONT COLOR="#000000">(</FONT>DERLand2 <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> add<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>ex1<FONT COLOR="#000000">,</FONT> add1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma32 <FONT COLOR="#000000">(</FONT>add<FONT COLOR="#000000">,</FONT> ex<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d1' <FONT COLOR="#000000">=</FONT> exchGeneral <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> EXCHshi ex1<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">in</FONT>
      DERleft <FONT COLOR="#000000">(</FONT>DERLand2 <FONT COLOR="#000000">(</FONT>d1'<FONT COLOR="#000000">,</FONT> add1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT>

  <FONT COLOR="#000000">|</FONT> DERleft <FONT COLOR="#000000">(</FONT>DERLor <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">,</FONT> add<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>ex1<FONT COLOR="#000000">,</FONT> add1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma32 <FONT COLOR="#000000">(</FONT>add<FONT COLOR="#000000">,</FONT> ex<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d1' <FONT COLOR="#000000">=</FONT> exchGeneral <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> EXCHshi ex1<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d2' <FONT COLOR="#000000">=</FONT> exchGeneral <FONT COLOR="#000000">(</FONT>d2<FONT COLOR="#000000">,</FONT> EXCHshi ex1<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">in</FONT>
      DERleft <FONT COLOR="#000000">(</FONT>DERLor <FONT COLOR="#000000">(</FONT>d1'<FONT COLOR="#000000">,</FONT> d2'<FONT COLOR="#000000">,</FONT> add1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT>

  <FONT COLOR="#000000">|</FONT> DERleft <FONT COLOR="#000000">(</FONT>DERLimp <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">,</FONT> c<FONT COLOR="#000000">,</FONT> add<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>ex1<FONT COLOR="#000000">,</FONT> add1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma32 <FONT COLOR="#000000">(</FONT>add<FONT COLOR="#000000">,</FONT> ex<FONT COLOR="#000000">)</FONT></FONT> 
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>ex11<FONT COLOR="#000000">,</FONT> ex21<FONT COLOR="#000000">,</FONT> c1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma33 <FONT COLOR="#000000">(</FONT>c<FONT COLOR="#000000">,</FONT> ex1<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d1' <FONT COLOR="#000000">=</FONT> exchGeneral <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> ex11<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d2' <FONT COLOR="#000000">=</FONT> exchGeneral <FONT COLOR="#000000">(</FONT>d2<FONT COLOR="#000000">,</FONT> EXCHshi ex21<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">in</FONT>
      DERleft <FONT COLOR="#000000">(</FONT>DERLimp <FONT COLOR="#000000">(</FONT>d1'<FONT COLOR="#000000">,</FONT> d2'<FONT COLOR="#000000">,</FONT> c1<FONT COLOR="#000000">,</FONT> add1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT>

  <FONT COLOR="#000000">|</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRand1 <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">,</FONT> c<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>ex1<FONT COLOR="#000000">,</FONT> ex2<FONT COLOR="#000000">,</FONT> c1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma33 <FONT COLOR="#000000">(</FONT>c<FONT COLOR="#000000">,</FONT> ex<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d1' <FONT COLOR="#000000">=</FONT> exchGeneral <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> ex1<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d2' <FONT COLOR="#000000">=</FONT> exchGeneral <FONT COLOR="#000000">(</FONT>d2<FONT COLOR="#000000">,</FONT> ex2<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">in</FONT>
      DERright <FONT COLOR="#000000">(</FONT>DERRand1 <FONT COLOR="#000000">(</FONT>d1'<FONT COLOR="#000000">,</FONT> d2'<FONT COLOR="#000000">,</FONT> c1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT>

  <FONT COLOR="#000000">|</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRand2 <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d1' <FONT COLOR="#000000">=</FONT> exchGeneral <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> ex<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d2' <FONT COLOR="#000000">=</FONT> exchGeneral <FONT COLOR="#000000">(</FONT>d2<FONT COLOR="#000000">,</FONT> ex<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">in</FONT>
      DERright <FONT COLOR="#000000">(</FONT>DERRand2 <FONT COLOR="#000000">(</FONT>d1'<FONT COLOR="#000000">,</FONT> d2'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT>

  <FONT COLOR="#000000">|</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRor1 d1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d1' <FONT COLOR="#000000">=</FONT> exchGeneral <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> ex<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">in</FONT>
      DERright <FONT COLOR="#000000">(</FONT>DERRor1 d1'<FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT>

  <FONT COLOR="#000000">|</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRor2 d1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d1' <FONT COLOR="#000000">=</FONT> exchGeneral <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> ex<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">in</FONT>
      DERright <FONT COLOR="#000000">(</FONT>DERRor2 d1'<FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT>

  <FONT COLOR="#000000">|</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRimp d1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d1' <FONT COLOR="#000000">=</FONT> exchGeneral <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> EXCHshi ex<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">in</FONT> 
      DERright <FONT COLOR="#000000">(</FONT>DERRimp d1'<FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT></FONT>

<FONT COLOR="#787878">//
</FONT>
<FONT COLOR="#000000">prfn</FONT> <FONT COLOR="#009000">exch <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>A1<FONT COLOR="#000000">,</FONT>A2<FONT COLOR="#000000">,</FONT>A3<FONT COLOR="#000000">:</FONT>form<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>n<FONT COLOR="#000000">,</FONT>i1<FONT COLOR="#000000">,</FONT>i2<FONT COLOR="#000000">:</FONT>nat <FONT COLOR="#000000">|</FONT> i1 <FONT COLOR="#000000">&lt;</FONT> 2<FONT COLOR="#000000">;</FONT> i2 <FONT COLOR="#000000">&lt;</FONT> 2<FONT COLOR="#000000">}</FONT></FONT>
  <FONT COLOR="#000000">(</FONT>d<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DER <FONT COLOR="#000000">(</FONT>more <FONT COLOR="#000000">(</FONT>more <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> A1<FONT COLOR="#000000">,</FONT> i1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">,</FONT> i2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> A3<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT>
  <FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DER <FONT COLOR="#000000">(</FONT>more <FONT COLOR="#000000">(</FONT>more <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">,</FONT> i2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> A1<FONT COLOR="#000000">,</FONT> i1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> A3<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  exchGeneral <FONT COLOR="#000000">(</FONT>d<FONT COLOR="#000000">,</FONT> EXCHone<FONT COLOR="#000000">)</FONT></FONT>

<FONT COLOR="#787878">//
</FONT>
<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">thin <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>A<FONT COLOR="#000000">,</FONT>A'<FONT COLOR="#000000">:</FONT>form<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>n<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>n<FONT COLOR="#000000">&gt;.</FONT></FONT>
  <FONT COLOR="#000000">(</FONT>d<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DER <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DER <FONT COLOR="#000000">(</FONT>more <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> A'<FONT COLOR="#000000">,</FONT> 0<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT> 
  <FONT COLOR="#000000">case+</FONT> d <FONT COLOR="#000000">of</FONT>
  <FONT COLOR="#000000">|</FONT> DERaxi <FONT COLOR="#000000">(</FONT>g<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> DERaxi <FONT COLOR="#000000">(</FONT>SEQmore g<FONT COLOR="#000000">,</FONT> INshi i<FONT COLOR="#000000">)</FONT>

  <FONT COLOR="#000000">|</FONT> DERleft <FONT COLOR="#000000">(</FONT>DERLtimes <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> add<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d1' <FONT COLOR="#000000">=</FONT> exchGeneral <FONT COLOR="#000000">(</FONT>exch <FONT COLOR="#000000">(</FONT>thin d1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> EXCHshi EXCHone<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">add' <FONT COLOR="#000000">=</FONT> ADDshi add</FONT>
    <FONT COLOR="#000000">in</FONT>
      DERleft <FONT COLOR="#000000">(</FONT>DERLtimes <FONT COLOR="#000000">(</FONT>d1'<FONT COLOR="#000000">,</FONT> add'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT>

  <FONT COLOR="#000000">|</FONT> DERleft <FONT COLOR="#000000">(</FONT>DERLand1 <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> add<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d1' <FONT COLOR="#000000">=</FONT> exch <FONT COLOR="#000000">(</FONT>thin d1<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">add' <FONT COLOR="#000000">=</FONT> ADDshi add</FONT>
    <FONT COLOR="#000000">in</FONT>
      DERleft <FONT COLOR="#000000">(</FONT>DERLand1 <FONT COLOR="#000000">(</FONT>d1'<FONT COLOR="#000000">,</FONT> add'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT>
  
  <FONT COLOR="#000000">|</FONT> DERleft <FONT COLOR="#000000">(</FONT>DERLand2 <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> add<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d1' <FONT COLOR="#000000">=</FONT> exch <FONT COLOR="#000000">(</FONT>thin d1<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">add' <FONT COLOR="#000000">=</FONT> ADDshi add</FONT>
    <FONT COLOR="#000000">in</FONT>
      DERleft <FONT COLOR="#000000">(</FONT>DERLand2 <FONT COLOR="#000000">(</FONT>d1'<FONT COLOR="#000000">,</FONT> add'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT>

  <FONT COLOR="#000000">|</FONT> DERleft <FONT COLOR="#000000">(</FONT>DERLor <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">,</FONT> add<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d1' <FONT COLOR="#000000">=</FONT> exch <FONT COLOR="#000000">(</FONT>thin d1<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d2' <FONT COLOR="#000000">=</FONT> exch <FONT COLOR="#000000">(</FONT>thin d2<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">add' <FONT COLOR="#000000">=</FONT> ADDshi add</FONT>
    <FONT COLOR="#000000">in</FONT>
      DERleft <FONT COLOR="#000000">(</FONT>DERLor <FONT COLOR="#000000">(</FONT>d1'<FONT COLOR="#000000">,</FONT> d2'<FONT COLOR="#000000">,</FONT> add'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT>

  <FONT COLOR="#000000">|</FONT> DERleft <FONT COLOR="#000000">(</FONT>DERLimp <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">,</FONT> c<FONT COLOR="#000000">,</FONT> add<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d1' <FONT COLOR="#000000">=</FONT> thin d1</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d2' <FONT COLOR="#000000">=</FONT> exch <FONT COLOR="#000000">(</FONT>thin d2<FONT COLOR="#000000">)</FONT></FONT> 
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">c' <FONT COLOR="#000000">=</FONT> COMBmore c</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">add' <FONT COLOR="#000000">=</FONT> ADDshi add</FONT> 
    <FONT COLOR="#000000">in</FONT>
      DERleft <FONT COLOR="#000000">(</FONT>DERLimp <FONT COLOR="#000000">(</FONT>d1'<FONT COLOR="#000000">,</FONT> d2'<FONT COLOR="#000000">,</FONT> c'<FONT COLOR="#000000">,</FONT> add'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT>

  <FONT COLOR="#000000">|</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRand1 <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">,</FONT> c<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> 
      DERright <FONT COLOR="#000000">(</FONT>DERRand1 <FONT COLOR="#000000">(</FONT>thin d1<FONT COLOR="#000000">,</FONT> thin d2<FONT COLOR="#000000">,</FONT> COMBmore c<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>

  <FONT COLOR="#000000">|</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRand2 <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRand2 <FONT COLOR="#000000">(</FONT>thin d1<FONT COLOR="#000000">,</FONT> thin d2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>

  <FONT COLOR="#000000">|</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRor1 d1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRor1 <FONT COLOR="#000000">(</FONT>thin d1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>

  <FONT COLOR="#000000">|</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRor2 d1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRor2 <FONT COLOR="#000000">(</FONT>thin d1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>

  <FONT COLOR="#000000">|</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRimp d1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRimp <FONT COLOR="#000000">(</FONT>exch <FONT COLOR="#000000">(</FONT>thin d1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT>

<FONT COLOR="#787878">//
</FONT>
<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">thick <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>A<FONT COLOR="#000000">,</FONT>A1<FONT COLOR="#000000">:</FONT>form<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>n<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>n<FONT COLOR="#000000">&gt;.</FONT></FONT> 
  <FONT COLOR="#000000">(</FONT>d<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DER <FONT COLOR="#000000">(</FONT>more <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> A1<FONT COLOR="#000000">,</FONT> 0<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DER <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT> <FONT COLOR="#000000">begin</FONT>
  <FONT COLOR="#000000">case+</FONT> d <FONT COLOR="#000000">of</FONT>
  <FONT COLOR="#000000">|</FONT> DERaxi <FONT COLOR="#000000">(</FONT>g<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">SEQmore g' <FONT COLOR="#000000">=</FONT> g <FONT COLOR="#000000">and</FONT> INshi i' <FONT COLOR="#000000">=</FONT> i</FONT>
    <FONT COLOR="#000000">in</FONT>
      DERaxi <FONT COLOR="#000000">(</FONT>g'<FONT COLOR="#000000">,</FONT> i'<FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT>

  <FONT COLOR="#000000">|</FONT> DERleft <FONT COLOR="#000000">(</FONT>DERLtimes <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> add<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">ADDshi add' <FONT COLOR="#000000">=</FONT> add</FONT>	
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d1' <FONT COLOR="#000000">=</FONT> thick <FONT COLOR="#000000">(</FONT>exch <FONT COLOR="#000000">(</FONT>exchGeneral <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> EXCHshi EXCHone<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">in</FONT>
      DERleft <FONT COLOR="#000000">(</FONT>DERLtimes <FONT COLOR="#000000">(</FONT>d1'<FONT COLOR="#000000">,</FONT> add'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT>
 
  <FONT COLOR="#000000">|</FONT> DERleft <FONT COLOR="#000000">(</FONT>DERLand1 <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> add<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">ADDshi add' <FONT COLOR="#000000">=</FONT> add</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d1' <FONT COLOR="#000000">=</FONT> thick <FONT COLOR="#000000">(</FONT>exch d1<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">in</FONT>
      DERleft <FONT COLOR="#000000">(</FONT>DERLand1 <FONT COLOR="#000000">(</FONT>d1'<FONT COLOR="#000000">,</FONT> add'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT>  

  <FONT COLOR="#000000">|</FONT> DERleft <FONT COLOR="#000000">(</FONT>DERLand2 <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> add<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">ADDshi add' <FONT COLOR="#000000">=</FONT> add</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d1' <FONT COLOR="#000000">=</FONT> thick <FONT COLOR="#000000">(</FONT>exch d1<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">in</FONT>
      DERleft <FONT COLOR="#000000">(</FONT>DERLand2 <FONT COLOR="#000000">(</FONT>d1'<FONT COLOR="#000000">,</FONT> add'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT>

  <FONT COLOR="#000000">|</FONT> DERleft <FONT COLOR="#000000">(</FONT>DERLor <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">,</FONT> add<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">ADDshi add' <FONT COLOR="#000000">=</FONT> add</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d1' <FONT COLOR="#000000">=</FONT> thick <FONT COLOR="#000000">(</FONT>exch d1<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d2' <FONT COLOR="#000000">=</FONT> thick <FONT COLOR="#000000">(</FONT>exch d2<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">in</FONT>
      DERleft <FONT COLOR="#000000">(</FONT>DERLor <FONT COLOR="#000000">(</FONT>d1'<FONT COLOR="#000000">,</FONT> d2'<FONT COLOR="#000000">,</FONT> add'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT>

  <FONT COLOR="#000000">|</FONT> DERleft <FONT COLOR="#000000">(</FONT>DERLimp <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">,</FONT> c<FONT COLOR="#000000">,</FONT> add<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">ADDshi add' <FONT COLOR="#000000">=</FONT> add</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">COMBmore c' <FONT COLOR="#000000">=</FONT> c</FONT> 
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d1' <FONT COLOR="#000000">=</FONT> thick d1</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d2' <FONT COLOR="#000000">=</FONT> thick <FONT COLOR="#000000">(</FONT>exch d2<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">in</FONT> 
      DERleft <FONT COLOR="#000000">(</FONT>DERLimp <FONT COLOR="#000000">(</FONT>d1'<FONT COLOR="#000000">,</FONT> d2'<FONT COLOR="#000000">,</FONT> c'<FONT COLOR="#000000">,</FONT> add'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> 
    <FONT COLOR="#000000">end</FONT>

  <FONT COLOR="#000000">|</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRand1 <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">,</FONT> c<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">COMBmore c' <FONT COLOR="#000000">=</FONT> c</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d1' <FONT COLOR="#000000">=</FONT> thick d1</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d2' <FONT COLOR="#000000">=</FONT> thick d2</FONT> 
    <FONT COLOR="#000000">in</FONT>
      DERright <FONT COLOR="#000000">(</FONT>DERRand1 <FONT COLOR="#000000">(</FONT>d1'<FONT COLOR="#000000">,</FONT> d2'<FONT COLOR="#000000">,</FONT> c'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT>
    
 <FONT COLOR="#000000">|</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRand2 <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRand2 <FONT COLOR="#000000">(</FONT>thick d1<FONT COLOR="#000000">,</FONT> thick d2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
 <FONT COLOR="#000000">|</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRor1 d1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRor1 <FONT COLOR="#000000">(</FONT>thick d1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
 <FONT COLOR="#000000">|</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRor2 d1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRor2 <FONT COLOR="#000000">(</FONT>thick d1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
 <FONT COLOR="#000000">|</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRimp d'<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRimp <FONT COLOR="#000000">(</FONT>thick <FONT COLOR="#000000">(</FONT>exch d'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
<FONT COLOR="#000000">end</FONT></FONT> <FONT COLOR="#787878">// end of [thick]
</FONT>
<FONT COLOR="#787878">//
</FONT>
<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">lemma40 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">,</FONT>G3<FONT COLOR="#000000">,</FONT>G21<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>A<FONT COLOR="#000000">:</FONT>form<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>n<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>n<FONT COLOR="#000000">&gt;.</FONT></FONT>
  <FONT COLOR="#000000">(</FONT>c<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">COMB <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> add<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">ADD0 <FONT COLOR="#000000">(</FONT>G21<FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT>
  <FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">[</FONT>G4<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">]</FONT> <FONT COLOR="#000000">(</FONT>COMB <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G21<FONT COLOR="#000000">,</FONT> G4<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> ADD0 <FONT COLOR="#000000">(</FONT>G4<FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT> <FONT COLOR="#000000">begin</FONT>
  <FONT COLOR="#000000">case+</FONT> add <FONT COLOR="#000000">of</FONT>
  <FONT COLOR="#000000">|</FONT> ADDone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT> 
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">COMBmore c' <FONT COLOR="#000000">=</FONT> c</FONT> 
    <FONT COLOR="#000000">in</FONT> 
      <FONT COLOR="#000000">(</FONT>COMBmore c'<FONT COLOR="#000000">,</FONT> ADDone<FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT>
     
  <FONT COLOR="#000000">|</FONT> ADDshi add' <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">COMBmore c' <FONT COLOR="#000000">=</FONT> c</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>c1<FONT COLOR="#000000">,</FONT> add1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma40 <FONT COLOR="#000000">(</FONT>c'<FONT COLOR="#000000">,</FONT> add'<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">in</FONT>
      <FONT COLOR="#000000">(</FONT>COMBmore c1<FONT COLOR="#000000">,</FONT> ADDshi add1<FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT> 
<FONT COLOR="#000000">end</FONT></FONT> <FONT COLOR="#787878">// end of [lemma40]
</FONT>
<FONT COLOR="#787878">//
</FONT>
<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">lemma41
  <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G11<FONT COLOR="#000000">,</FONT>G22<FONT COLOR="#000000">,</FONT>G33<FONT COLOR="#000000">,</FONT>G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">,</FONT>G3<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>A1<FONT COLOR="#000000">,</FONT>A2<FONT COLOR="#000000">:</FONT>form<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>n<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>n<FONT COLOR="#000000">&gt;.</FONT></FONT>
  <FONT COLOR="#000000">(</FONT>c1<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">COMB0 <FONT COLOR="#000000">(</FONT>G11<FONT COLOR="#000000">,</FONT> G22<FONT COLOR="#000000">,</FONT> G33<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> add<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">ADD <FONT COLOR="#000000">(</FONT>G33<FONT COLOR="#000000">,</FONT> limp <FONT COLOR="#000000">(</FONT>A1<FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> G1<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> c2<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">COMB0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT>
  <FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">[</FONT>Gtmp1<FONT COLOR="#000000">,</FONT>Gtmp2<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">]</FONT> 
      <FONT COLOR="#000000">(</FONT>COMB0 <FONT COLOR="#000000">(</FONT>G22<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">,</FONT> Gtmp1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> COMB0 <FONT COLOR="#000000">(</FONT>G11<FONT COLOR="#000000">,</FONT> Gtmp1<FONT COLOR="#000000">,</FONT> Gtmp2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> ADD0 <FONT COLOR="#000000">(</FONT>Gtmp2<FONT COLOR="#000000">,</FONT> limp <FONT COLOR="#000000">(</FONT>A1<FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>   
  <FONT COLOR="#000000">case+</FONT> add <FONT COLOR="#000000">of</FONT>
  <FONT COLOR="#000000">|</FONT> ADDone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">COMBmore c1' <FONT COLOR="#000000">=</FONT> c1</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">COMBmore c2' <FONT COLOR="#000000">=</FONT> c2</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>c3<FONT COLOR="#000000">,</FONT> c4<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma12 <FONT COLOR="#000000">(</FONT>c1'<FONT COLOR="#000000">,</FONT> c2'<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">in</FONT>
      <FONT COLOR="#000000">(</FONT>COMBmore c3<FONT COLOR="#000000">,</FONT> COMBmore c4<FONT COLOR="#000000">,</FONT> ADDone<FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT>

  <FONT COLOR="#000000">|</FONT> ADDshi add' <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">COMBmore c1' <FONT COLOR="#000000">=</FONT> c1</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">COMBmore c2' <FONT COLOR="#000000">=</FONT> c2</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>c3<FONT COLOR="#000000">,</FONT> c4<FONT COLOR="#000000">,</FONT> add1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma41 <FONT COLOR="#000000">(</FONT>c1'<FONT COLOR="#000000">,</FONT> add'<FONT COLOR="#000000">,</FONT> c2'<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">in</FONT>
      <FONT COLOR="#000000">(</FONT>COMBmore c3<FONT COLOR="#000000">,</FONT> COMBmore c4<FONT COLOR="#000000">,</FONT> ADDshi add1<FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT></FONT>

<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">lemma42 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">,</FONT>G3<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>A<FONT COLOR="#000000">:</FONT>form<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>k<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>k<FONT COLOR="#000000">&gt;.</FONT></FONT>
  <FONT COLOR="#000000">(</FONT>i<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">IN <FONT COLOR="#000000">(</FONT>A<FONT COLOR="#000000">,</FONT> 1<FONT COLOR="#000000">,</FONT> G1<FONT COLOR="#000000">,</FONT> k<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> g<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">SEQ0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> 1<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> c<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">COMB0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT>
  <FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">ADD <FONT COLOR="#000000">(</FONT>G2<FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">,</FONT> k<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT> <FONT COLOR="#000000">begin</FONT> <FONT COLOR="#000000">case+</FONT> i <FONT COLOR="#000000">of</FONT>
  <FONT COLOR="#000000">|</FONT> INone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">SEQmore g' <FONT COLOR="#000000">=</FONT> g</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">COMBmore c' <FONT COLOR="#000000">=</FONT> c</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">SEQeq <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma21 <FONT COLOR="#000000">(</FONT>c'<FONT COLOR="#000000">,</FONT> g'<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">in</FONT>
      ADDone
    <FONT COLOR="#000000">end</FONT>
   
  <FONT COLOR="#000000">|</FONT> INshi i' <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">SEQmore g' <FONT COLOR="#000000">=</FONT> g</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma01 <FONT COLOR="#000000">(</FONT>g'<FONT COLOR="#000000">,</FONT> i'<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">COMBmore c' <FONT COLOR="#000000">=</FONT> c</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">i1 <FONT COLOR="#000000">=</FONT> lemma42 <FONT COLOR="#000000">(</FONT>i'<FONT COLOR="#000000">,</FONT> g'<FONT COLOR="#000000">,</FONT> c'<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">in</FONT>
      ADDshi i1
    <FONT COLOR="#000000">end</FONT>
<FONT COLOR="#000000">end</FONT></FONT> <FONT COLOR="#787878">// end of [lemma42]
</FONT>
<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">lemma43 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">,</FONT>G3<FONT COLOR="#000000">,</FONT>G11<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>A<FONT COLOR="#000000">:</FONT>form<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>n<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>n<FONT COLOR="#000000">&gt;.</FONT></FONT>
  <FONT COLOR="#000000">(</FONT>c<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">COMB <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> add<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">ADD0 <FONT COLOR="#000000">(</FONT>G11<FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> G1<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT>
  <FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">[</FONT>G4<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">]</FONT> <FONT COLOR="#000000">(</FONT>COMB <FONT COLOR="#000000">(</FONT>G11<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">,</FONT> G4<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> ADD0 <FONT COLOR="#000000">(</FONT>G4<FONT COLOR="#000000">,</FONT> A<FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT> <FONT COLOR="#000000">let</FONT>
  <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>c1<FONT COLOR="#000000">,</FONT> add1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma40 <FONT COLOR="#000000">(</FONT>lemma11 c<FONT COLOR="#000000">,</FONT> add<FONT COLOR="#000000">)</FONT></FONT>
<FONT COLOR="#000000">in</FONT>
  <FONT COLOR="#000000">(</FONT>lemma11 c1<FONT COLOR="#000000">,</FONT> add1<FONT COLOR="#000000">)</FONT>
<FONT COLOR="#000000">end</FONT></FONT> <FONT COLOR="#787878">// end of [lemma43]
</FONT>
<FONT COLOR="#787878">(***** cut elimination in intuitionistic linear logic *****)</FONT>

<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">cut
  <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">,</FONT>G3<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>A1<FONT COLOR="#000000">,</FONT>A2<FONT COLOR="#000000">:</FONT>form<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>m<FONT COLOR="#000000">,</FONT>n1<FONT COLOR="#000000">,</FONT>n2<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>m<FONT COLOR="#000000">,</FONT> n2<FONT COLOR="#000000">,</FONT> n1<FONT COLOR="#000000">&gt;.</FONT></FONT> <FONT COLOR="#000000">(</FONT>
    a<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">FM <FONT COLOR="#000000">(</FONT>A1<FONT COLOR="#000000">,</FONT> m<FONT COLOR="#000000">)</FONT></FONT>
  <FONT COLOR="#000000">,</FONT> d1<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DER <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> A1<FONT COLOR="#000000">,</FONT> n1<FONT COLOR="#000000">)</FONT></FONT>
  <FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DER <FONT COLOR="#000000">(</FONT>more <FONT COLOR="#000000">(</FONT>G2<FONT COLOR="#000000">,</FONT> A1<FONT COLOR="#000000">,</FONT> 1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">,</FONT> n2<FONT COLOR="#000000">)</FONT></FONT>
  <FONT COLOR="#000000">,</FONT> c<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">COMB0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">)</FONT></FONT>
  <FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DER0 <FONT COLOR="#000000">(</FONT>G3<FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT> <FONT COLOR="#000000">begin</FONT> <FONT COLOR="#000000">case+</FONT> d2 <FONT COLOR="#000000">of</FONT>
  <FONT COLOR="#000000">|</FONT> DERaxi <FONT COLOR="#000000">(</FONT>g<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">SEQmore g' <FONT COLOR="#000000">=</FONT> g</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">SEQeq <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma20 <FONT COLOR="#000000">(</FONT>c<FONT COLOR="#000000">,</FONT> g'<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">in</FONT>
      <FONT COLOR="#000000">case+</FONT> i <FONT COLOR="#000000">of</FONT>
      <FONT COLOR="#000000">|</FONT> INone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> d1
      <FONT COLOR="#000000">|</FONT> INshi i' <FONT COLOR="#000000">=/=&gt;</FONT> <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma01 <FONT COLOR="#000000">(</FONT>g'<FONT COLOR="#000000">,</FONT> i'<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">in</FONT> <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">end</FONT>
    <FONT COLOR="#000000">end</FONT>

  <FONT COLOR="#000000">|</FONT> DERleft <FONT COLOR="#000000">(</FONT>DERLtimes <FONT COLOR="#000000">(</FONT>d21<FONT COLOR="#000000">,</FONT> add2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">begin</FONT> <FONT COLOR="#000000">case+</FONT> add2 <FONT COLOR="#000000">of</FONT>
    <FONT COLOR="#000000">|</FONT> ADDone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">begin</FONT> <FONT COLOR="#000000">case+</FONT> d1 <FONT COLOR="#000000">of</FONT>
      <FONT COLOR="#000000">|</FONT> DERaxi <FONT COLOR="#000000">(</FONT>g<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d <FONT COLOR="#000000">=</FONT> exchGeneral <FONT COLOR="#000000">(</FONT>d21<FONT COLOR="#000000">,</FONT> EXCHshi EXCHone<FONT COLOR="#000000">)</FONT></FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d21' <FONT COLOR="#000000">=</FONT> thick <FONT COLOR="#000000">(</FONT>exch d<FONT COLOR="#000000">)</FONT></FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">add2' <FONT COLOR="#000000">=</FONT> lemma42 <FONT COLOR="#000000">(</FONT>i<FONT COLOR="#000000">,</FONT> g<FONT COLOR="#000000">,</FONT> c<FONT COLOR="#000000">)</FONT></FONT>
        <FONT COLOR="#000000">in</FONT>
          DERleft <FONT COLOR="#000000">(</FONT>DERLtimes <FONT COLOR="#000000">(</FONT>d21'<FONT COLOR="#000000">,</FONT> add2'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
        <FONT COLOR="#000000">end</FONT>

      <FONT COLOR="#000000">|</FONT> DERleft d1 <FONT COLOR="#000000">=&gt;</FONT> cutAux <FONT COLOR="#000000">(</FONT>a<FONT COLOR="#000000">,</FONT> d1<FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">,</FONT> c<FONT COLOR="#000000">)</FONT>

      <FONT COLOR="#000000">|</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRand1 <FONT COLOR="#000000">(</FONT>d11<FONT COLOR="#000000">,</FONT> d12<FONT COLOR="#000000">,</FONT> c1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>c2<FONT COLOR="#000000">,</FONT> c3<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma12 <FONT COLOR="#000000">(</FONT>c1<FONT COLOR="#000000">,</FONT> c<FONT COLOR="#000000">)</FONT></FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">FMand1 <FONT COLOR="#000000">(</FONT>a1<FONT COLOR="#000000">,</FONT> a2<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> a</FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d <FONT COLOR="#000000">=</FONT> exch <FONT COLOR="#000000">(</FONT>exchGeneral <FONT COLOR="#000000">(</FONT>d21<FONT COLOR="#000000">,</FONT> EXCHshi EXCHone<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d21' <FONT COLOR="#000000">=</FONT> thick d</FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d12' <FONT COLOR="#000000">=</FONT> thin d12</FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d3 <FONT COLOR="#000000">=</FONT> cut <FONT COLOR="#000000">(</FONT>a2<FONT COLOR="#000000">,</FONT> d12'<FONT COLOR="#000000">,</FONT> d21'<FONT COLOR="#000000">,</FONT> COMBmore c2<FONT COLOR="#000000">)</FONT></FONT> 
        <FONT COLOR="#000000">in</FONT>
          cut <FONT COLOR="#000000">(</FONT>a1<FONT COLOR="#000000">,</FONT> d11<FONT COLOR="#000000">,</FONT> d3<FONT COLOR="#000000">,</FONT> c3<FONT COLOR="#000000">)</FONT>
        <FONT COLOR="#000000">end</FONT>
      <FONT COLOR="#000000">end</FONT>
    <FONT COLOR="#000000">|</FONT> ADDshi add2' <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
        <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d1' <FONT COLOR="#000000">=</FONT> thin <FONT COLOR="#000000">(</FONT>thin d1<FONT COLOR="#000000">)</FONT></FONT>
        <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d21' <FONT COLOR="#000000">=</FONT> exch <FONT COLOR="#000000">(</FONT>exchGeneral <FONT COLOR="#000000">(</FONT>d21<FONT COLOR="#000000">,</FONT> EXCHshi EXCHone<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT>
        <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>c3<FONT COLOR="#000000">,</FONT> add3<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma40 <FONT COLOR="#000000">(</FONT>c<FONT COLOR="#000000">,</FONT> add2'<FONT COLOR="#000000">)</FONT></FONT>
        <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d3 <FONT COLOR="#000000">=</FONT> cut <FONT COLOR="#000000">(</FONT>a<FONT COLOR="#000000">,</FONT> d1'<FONT COLOR="#000000">,</FONT> d21'<FONT COLOR="#000000">,</FONT> COMBmore <FONT COLOR="#000000">(</FONT>COMBmore c3<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">in</FONT>
        DERleft <FONT COLOR="#000000">(</FONT>DERLtimes <FONT COLOR="#000000">(</FONT>d3<FONT COLOR="#000000">,</FONT> add3<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
      <FONT COLOR="#000000">end</FONT>
    <FONT COLOR="#000000">end</FONT>

  <FONT COLOR="#000000">|</FONT> DERleft <FONT COLOR="#000000">(</FONT>DERLand1 <FONT COLOR="#000000">(</FONT>d21<FONT COLOR="#000000">,</FONT> add2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">begin</FONT> <FONT COLOR="#000000">case+</FONT> add2 <FONT COLOR="#000000">of</FONT>
    <FONT COLOR="#000000">|</FONT> ADDone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">begin</FONT> <FONT COLOR="#000000">case+</FONT> d1 <FONT COLOR="#000000">of</FONT>
      <FONT COLOR="#000000">|</FONT> DERaxi <FONT COLOR="#000000">(</FONT>g<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d21' <FONT COLOR="#000000">=</FONT> thick <FONT COLOR="#000000">(</FONT>exch d21<FONT COLOR="#000000">)</FONT></FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">add2' <FONT COLOR="#000000">=</FONT> lemma42 <FONT COLOR="#000000">(</FONT>i<FONT COLOR="#000000">,</FONT> g<FONT COLOR="#000000">,</FONT> c<FONT COLOR="#000000">)</FONT></FONT>
        <FONT COLOR="#000000">in</FONT>
          DERleft <FONT COLOR="#000000">(</FONT>DERLand1 <FONT COLOR="#000000">(</FONT>d21'<FONT COLOR="#000000">,</FONT> add2'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
        <FONT COLOR="#000000">end</FONT>

      <FONT COLOR="#000000">|</FONT> DERleft d1 <FONT COLOR="#000000">=&gt;</FONT> cutAux <FONT COLOR="#000000">(</FONT>a<FONT COLOR="#000000">,</FONT> d1<FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">,</FONT> c<FONT COLOR="#000000">)</FONT>

      <FONT COLOR="#000000">|</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRand2 <FONT COLOR="#000000">(</FONT>d11<FONT COLOR="#000000">,</FONT> d12<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d21' <FONT COLOR="#000000">=</FONT> thick <FONT COLOR="#000000">(</FONT>exch d21<FONT COLOR="#000000">)</FONT></FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">FMand2 <FONT COLOR="#000000">(</FONT>a1<FONT COLOR="#000000">,</FONT> a2<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> a</FONT>
        <FONT COLOR="#000000">in</FONT>
          cut <FONT COLOR="#000000">(</FONT>a1<FONT COLOR="#000000">,</FONT> d11<FONT COLOR="#000000">,</FONT> d21'<FONT COLOR="#000000">,</FONT> c<FONT COLOR="#000000">)</FONT>
        <FONT COLOR="#000000">end</FONT>
      <FONT COLOR="#000000">end</FONT>

    <FONT COLOR="#000000">|</FONT> ADDshi add2' <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
        <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d1' <FONT COLOR="#000000">=</FONT> thin d1</FONT>
        <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d21' <FONT COLOR="#000000">=</FONT> exch d21</FONT>
        <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>c2<FONT COLOR="#000000">,</FONT> add3<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma40 <FONT COLOR="#000000">(</FONT>c<FONT COLOR="#000000">,</FONT> add2'<FONT COLOR="#000000">)</FONT></FONT>
        <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d3 <FONT COLOR="#000000">=</FONT> cut <FONT COLOR="#000000">(</FONT>a<FONT COLOR="#000000">,</FONT> d1'<FONT COLOR="#000000">,</FONT> d21'<FONT COLOR="#000000">,</FONT> COMBmore c2<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">in</FONT>
        DERleft <FONT COLOR="#000000">(</FONT>DERLand1 <FONT COLOR="#000000">(</FONT>d3<FONT COLOR="#000000">,</FONT> add3<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
      <FONT COLOR="#000000">end</FONT>
    <FONT COLOR="#000000">end</FONT>

  <FONT COLOR="#000000">|</FONT> DERleft <FONT COLOR="#000000">(</FONT>DERLand2 <FONT COLOR="#000000">(</FONT>d21<FONT COLOR="#000000">,</FONT> add2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">begin</FONT> <FONT COLOR="#000000">case+</FONT> add2 <FONT COLOR="#000000">of</FONT>
    <FONT COLOR="#000000">|</FONT> ADDone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">begin</FONT> <FONT COLOR="#000000">case+</FONT> d1 <FONT COLOR="#000000">of</FONT>
      <FONT COLOR="#000000">|</FONT> DERaxi <FONT COLOR="#000000">(</FONT>g<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d21' <FONT COLOR="#000000">=</FONT> thick <FONT COLOR="#000000">(</FONT>exch d21<FONT COLOR="#000000">)</FONT></FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">add2' <FONT COLOR="#000000">=</FONT> lemma42 <FONT COLOR="#000000">(</FONT>i<FONT COLOR="#000000">,</FONT> g<FONT COLOR="#000000">,</FONT> c<FONT COLOR="#000000">)</FONT></FONT>
        <FONT COLOR="#000000">in</FONT>
          DERleft <FONT COLOR="#000000">(</FONT>DERLand2 <FONT COLOR="#000000">(</FONT>d21'<FONT COLOR="#000000">,</FONT> add2'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
        <FONT COLOR="#000000">end</FONT>

      <FONT COLOR="#000000">|</FONT> DERleft d1 <FONT COLOR="#000000">=&gt;</FONT> cutAux <FONT COLOR="#000000">(</FONT>a<FONT COLOR="#000000">,</FONT> d1<FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">,</FONT> c<FONT COLOR="#000000">)</FONT>

      <FONT COLOR="#000000">|</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRand2 <FONT COLOR="#000000">(</FONT>d11<FONT COLOR="#000000">,</FONT> d12<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d21' <FONT COLOR="#000000">=</FONT> thick <FONT COLOR="#000000">(</FONT>exch d21<FONT COLOR="#000000">)</FONT></FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">FMand2 <FONT COLOR="#000000">(</FONT>a1<FONT COLOR="#000000">,</FONT> a2<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> a</FONT>
        <FONT COLOR="#000000">in</FONT>
          cut <FONT COLOR="#000000">(</FONT>a2<FONT COLOR="#000000">,</FONT> d12<FONT COLOR="#000000">,</FONT> d21'<FONT COLOR="#000000">,</FONT> c<FONT COLOR="#000000">)</FONT>
        <FONT COLOR="#000000">end</FONT>
      <FONT COLOR="#000000">end</FONT>

    <FONT COLOR="#000000">|</FONT> ADDshi add2' <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
        <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d1' <FONT COLOR="#000000">=</FONT> thin d1</FONT>
        <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d21' <FONT COLOR="#000000">=</FONT> exch d21</FONT>
        <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>c2<FONT COLOR="#000000">,</FONT> add3<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma40 <FONT COLOR="#000000">(</FONT>c<FONT COLOR="#000000">,</FONT> add2'<FONT COLOR="#000000">)</FONT></FONT>
        <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d3 <FONT COLOR="#000000">=</FONT> cut <FONT COLOR="#000000">(</FONT>a<FONT COLOR="#000000">,</FONT> d1'<FONT COLOR="#000000">,</FONT> d21'<FONT COLOR="#000000">,</FONT> COMBmore c2<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">in</FONT>
        DERleft <FONT COLOR="#000000">(</FONT>DERLand2 <FONT COLOR="#000000">(</FONT>d3<FONT COLOR="#000000">,</FONT> add3<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
      <FONT COLOR="#000000">end</FONT>
    <FONT COLOR="#000000">end</FONT>

  <FONT COLOR="#000000">|</FONT> DERleft <FONT COLOR="#000000">(</FONT>DERLor <FONT COLOR="#000000">(</FONT>d21<FONT COLOR="#000000">,</FONT> d22<FONT COLOR="#000000">,</FONT> add2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">begin</FONT> <FONT COLOR="#000000">case+</FONT> add2 <FONT COLOR="#000000">of</FONT>
    <FONT COLOR="#000000">|</FONT> ADDone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">begin</FONT> <FONT COLOR="#000000">case+</FONT> d1 <FONT COLOR="#000000">of</FONT>
      <FONT COLOR="#000000">|</FONT> DERaxi <FONT COLOR="#000000">(</FONT>g<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d21' <FONT COLOR="#000000">=</FONT> thick <FONT COLOR="#000000">(</FONT>exch d21<FONT COLOR="#000000">)</FONT></FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d22' <FONT COLOR="#000000">=</FONT> thick <FONT COLOR="#000000">(</FONT>exch d22<FONT COLOR="#000000">)</FONT></FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">add2' <FONT COLOR="#000000">=</FONT> lemma42 <FONT COLOR="#000000">(</FONT>i<FONT COLOR="#000000">,</FONT> g<FONT COLOR="#000000">,</FONT> c<FONT COLOR="#000000">)</FONT></FONT>
        <FONT COLOR="#000000">in</FONT>
          DERleft <FONT COLOR="#000000">(</FONT>DERLor <FONT COLOR="#000000">(</FONT>d21'<FONT COLOR="#000000">,</FONT> d22'<FONT COLOR="#000000">,</FONT> add2'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
        <FONT COLOR="#000000">end</FONT>

      <FONT COLOR="#000000">|</FONT> DERleft d1 <FONT COLOR="#000000">=&gt;</FONT> cutAux <FONT COLOR="#000000">(</FONT>a<FONT COLOR="#000000">,</FONT> d1<FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">,</FONT> c<FONT COLOR="#000000">)</FONT>

      <FONT COLOR="#000000">|</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRor1 d11<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d21' <FONT COLOR="#000000">=</FONT> thick <FONT COLOR="#000000">(</FONT>exch d21<FONT COLOR="#000000">)</FONT></FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">FMor <FONT COLOR="#000000">(</FONT>a1<FONT COLOR="#000000">,</FONT> a2<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> a</FONT>
        <FONT COLOR="#000000">in</FONT>
          cut <FONT COLOR="#000000">(</FONT>a1<FONT COLOR="#000000">,</FONT> d11<FONT COLOR="#000000">,</FONT> d21'<FONT COLOR="#000000">,</FONT> c<FONT COLOR="#000000">)</FONT>
        <FONT COLOR="#000000">end</FONT>

      <FONT COLOR="#000000">|</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRor2 d11<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d22' <FONT COLOR="#000000">=</FONT> thick <FONT COLOR="#000000">(</FONT>exch d22<FONT COLOR="#000000">)</FONT></FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">FMor <FONT COLOR="#000000">(</FONT>a1<FONT COLOR="#000000">,</FONT> a2<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> a</FONT>
        <FONT COLOR="#000000">in</FONT>
          cut <FONT COLOR="#000000">(</FONT>a2<FONT COLOR="#000000">,</FONT> d11<FONT COLOR="#000000">,</FONT> d22'<FONT COLOR="#000000">,</FONT> c<FONT COLOR="#000000">)</FONT>
        <FONT COLOR="#000000">end</FONT>
      <FONT COLOR="#000000">end</FONT>

    <FONT COLOR="#000000">|</FONT> ADDshi add2' <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
        <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>c2<FONT COLOR="#000000">,</FONT> add3<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma40 <FONT COLOR="#000000">(</FONT>c<FONT COLOR="#000000">,</FONT> add2'<FONT COLOR="#000000">)</FONT></FONT>
        <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d11' <FONT COLOR="#000000">=</FONT> thin d1</FONT> 
        <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d21' <FONT COLOR="#000000">=</FONT> cut <FONT COLOR="#000000">(</FONT>a<FONT COLOR="#000000">,</FONT> d11'<FONT COLOR="#000000">,</FONT> exch d21<FONT COLOR="#000000">,</FONT> COMBmore c2<FONT COLOR="#000000">)</FONT></FONT>
        <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d12' <FONT COLOR="#000000">=</FONT> thin d1</FONT>
        <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d22' <FONT COLOR="#000000">=</FONT> cut <FONT COLOR="#000000">(</FONT>a<FONT COLOR="#000000">,</FONT> d12'<FONT COLOR="#000000">,</FONT> exch d22<FONT COLOR="#000000">,</FONT> COMBmore c2<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">in</FONT>
        DERleft <FONT COLOR="#000000">(</FONT>DERLor <FONT COLOR="#000000">(</FONT>d21'<FONT COLOR="#000000">,</FONT> d22'<FONT COLOR="#000000">,</FONT> add3<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
      <FONT COLOR="#000000">end</FONT>
    <FONT COLOR="#000000">end</FONT>

  <FONT COLOR="#000000">|</FONT> DERleft <FONT COLOR="#000000">(</FONT>DERLimp <FONT COLOR="#000000">(</FONT>d21<FONT COLOR="#000000">,</FONT> d22<FONT COLOR="#000000">,</FONT> c2<FONT COLOR="#000000">,</FONT> add2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">begin</FONT> <FONT COLOR="#000000">case+</FONT> add2 <FONT COLOR="#000000">of</FONT>
    <FONT COLOR="#000000">|</FONT> ADDone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">begin</FONT> <FONT COLOR="#000000">case+</FONT> d1 <FONT COLOR="#000000">of</FONT>
      <FONT COLOR="#000000">|</FONT> DERaxi <FONT COLOR="#000000">(</FONT>g<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">COMBmore c2' <FONT COLOR="#000000">=</FONT> c2</FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d21' <FONT COLOR="#000000">=</FONT> thick d21</FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d22' <FONT COLOR="#000000">=</FONT> thick <FONT COLOR="#000000">(</FONT>exch d22<FONT COLOR="#000000">)</FONT></FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">add3 <FONT COLOR="#000000">=</FONT> lemma42 <FONT COLOR="#000000">(</FONT>i<FONT COLOR="#000000">,</FONT> g<FONT COLOR="#000000">,</FONT> c<FONT COLOR="#000000">)</FONT></FONT>
        <FONT COLOR="#000000">in</FONT>
          DERleft <FONT COLOR="#000000">(</FONT>DERLimp <FONT COLOR="#000000">(</FONT>d21'<FONT COLOR="#000000">,</FONT> d22'<FONT COLOR="#000000">,</FONT> c2'<FONT COLOR="#000000">,</FONT> add3<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
        <FONT COLOR="#000000">end</FONT>

      <FONT COLOR="#000000">|</FONT> DERleft d1 <FONT COLOR="#000000">=&gt;</FONT> cutAux <FONT COLOR="#000000">(</FONT>a<FONT COLOR="#000000">,</FONT> d1<FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">,</FONT> c<FONT COLOR="#000000">)</FONT> 
                  
      <FONT COLOR="#000000">|</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRimp d1'<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">COMBmore c2' <FONT COLOR="#000000">=</FONT> c2</FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>c3<FONT COLOR="#000000">,</FONT> c4<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma15 <FONT COLOR="#000000">(</FONT>c<FONT COLOR="#000000">,</FONT> c2'<FONT COLOR="#000000">)</FONT></FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">FMimp <FONT COLOR="#000000">(</FONT>a1<FONT COLOR="#000000">,</FONT> a2<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> a</FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d3 <FONT COLOR="#000000">=</FONT> cut <FONT COLOR="#000000">(</FONT>a1<FONT COLOR="#000000">,</FONT> thick d21<FONT COLOR="#000000">,</FONT> d1'<FONT COLOR="#000000">,</FONT> c3<FONT COLOR="#000000">)</FONT></FONT> 
        <FONT COLOR="#000000">in</FONT>
          cut <FONT COLOR="#000000">(</FONT>a2<FONT COLOR="#000000">,</FONT> d3<FONT COLOR="#000000">,</FONT> thick <FONT COLOR="#000000">(</FONT>exch d22<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> c4<FONT COLOR="#000000">)</FONT>
        <FONT COLOR="#000000">end</FONT>
      <FONT COLOR="#000000">end</FONT>

    <FONT COLOR="#000000">|</FONT> ADDshi add2' <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
        <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">COMBmore <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT><FONT COLOR="#000000">..</FONT><FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT><FONT COLOR="#000000">..</FONT><FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>_n<FONT COLOR="#000000">,</FONT>i1<FONT COLOR="#000000">,</FONT>_i2<FONT COLOR="#000000">}</FONT></FONT> c2' <FONT COLOR="#000000">=</FONT> c2</FONT>
      <FONT COLOR="#000000">in</FONT>
        <FONT COLOR="#009000"><FONT COLOR="#000000">sif</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>i1 == 0<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">then</FONT> <FONT COLOR="#000000">let</FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d1' <FONT COLOR="#000000">=</FONT> thin d1</FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d22' <FONT COLOR="#000000">=</FONT> exch d22</FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>c3<FONT COLOR="#000000">,</FONT> add3<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma40 <FONT COLOR="#000000">(</FONT>c<FONT COLOR="#000000">,</FONT> add2'<FONT COLOR="#000000">)</FONT></FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>c4<FONT COLOR="#000000">,</FONT> c5<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma13 <FONT COLOR="#000000">(</FONT>c3<FONT COLOR="#000000">,</FONT> c2'<FONT COLOR="#000000">)</FONT></FONT>	            
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d3 <FONT COLOR="#000000">=</FONT> cut <FONT COLOR="#000000">(</FONT>a<FONT COLOR="#000000">,</FONT> d1'<FONT COLOR="#000000">,</FONT> d22'<FONT COLOR="#000000">,</FONT> COMBmore c4<FONT COLOR="#000000">)</FONT></FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d21' <FONT COLOR="#000000">=</FONT> thick d21</FONT>
        <FONT COLOR="#000000">in</FONT> 
          DERleft <FONT COLOR="#000000">(</FONT>DERLimp <FONT COLOR="#000000">(</FONT>d21'<FONT COLOR="#000000">,</FONT> d3<FONT COLOR="#000000">,</FONT> c5<FONT COLOR="#000000">,</FONT> add3<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
        <FONT COLOR="#000000">end</FONT> <FONT COLOR="#000000">else</FONT> <FONT COLOR="#000000">let</FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>c3<FONT COLOR="#000000">,</FONT> add3<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma40 <FONT COLOR="#000000">(</FONT>c<FONT COLOR="#000000">,</FONT> add2'<FONT COLOR="#000000">)</FONT></FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>c4<FONT COLOR="#000000">,</FONT> c5<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma14 <FONT COLOR="#000000">(</FONT>c3<FONT COLOR="#000000">,</FONT> c2'<FONT COLOR="#000000">)</FONT></FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d3 <FONT COLOR="#000000">=</FONT> cut <FONT COLOR="#000000">(</FONT>a<FONT COLOR="#000000">,</FONT> d1<FONT COLOR="#000000">,</FONT> d21<FONT COLOR="#000000">,</FONT> c4<FONT COLOR="#000000">)</FONT></FONT>
          <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d22' <FONT COLOR="#000000">=</FONT> thick <FONT COLOR="#000000">(</FONT>exch d22<FONT COLOR="#000000">)</FONT></FONT>
        <FONT COLOR="#000000">in</FONT>
          DERleft <FONT COLOR="#000000">(</FONT>DERLimp <FONT COLOR="#000000">(</FONT>d3<FONT COLOR="#000000">,</FONT> d22'<FONT COLOR="#000000">,</FONT> c5<FONT COLOR="#000000">,</FONT> add3<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
        <FONT COLOR="#000000">end</FONT></FONT>
      <FONT COLOR="#000000">end</FONT>
    <FONT COLOR="#000000">end</FONT>

  <FONT COLOR="#000000">|</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRand1 <FONT COLOR="#000000">(</FONT>d21<FONT COLOR="#000000">,</FONT> d22<FONT COLOR="#000000">,</FONT> c2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">COMBmore <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT><FONT COLOR="#000000">..</FONT><FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT><FONT COLOR="#000000">..</FONT><FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>_n<FONT COLOR="#000000">,</FONT>i1<FONT COLOR="#000000">,</FONT>_i2<FONT COLOR="#000000">}</FONT></FONT> c2' <FONT COLOR="#000000">=</FONT> c2</FONT>
    <FONT COLOR="#000000">in</FONT>
      <FONT COLOR="#009000"><FONT COLOR="#000000">sif</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>i1 == 0<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">then</FONT> <FONT COLOR="#000000">let</FONT>
        <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>c3<FONT COLOR="#000000">,</FONT> c4<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma13 <FONT COLOR="#000000">(</FONT>c<FONT COLOR="#000000">,</FONT> c2'<FONT COLOR="#000000">)</FONT></FONT>
        <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d3 <FONT COLOR="#000000">=</FONT> cut <FONT COLOR="#000000">(</FONT>a<FONT COLOR="#000000">,</FONT> d1<FONT COLOR="#000000">,</FONT> d22<FONT COLOR="#000000">,</FONT> c3<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">in</FONT>
        DERright <FONT COLOR="#000000">(</FONT>DERRand1 <FONT COLOR="#000000">(</FONT>thick d21<FONT COLOR="#000000">,</FONT> d3<FONT COLOR="#000000">,</FONT> c4<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
      <FONT COLOR="#000000">end</FONT> <FONT COLOR="#000000">else</FONT> <FONT COLOR="#000000">let</FONT>
        <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>c3<FONT COLOR="#000000">,</FONT> c4<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma14 <FONT COLOR="#000000">(</FONT>c<FONT COLOR="#000000">,</FONT> c2'<FONT COLOR="#000000">)</FONT></FONT>
        <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d3 <FONT COLOR="#000000">=</FONT> cut <FONT COLOR="#000000">(</FONT>a<FONT COLOR="#000000">,</FONT> d1<FONT COLOR="#000000">,</FONT> d21<FONT COLOR="#000000">,</FONT> c3<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">in</FONT>
        DERright <FONT COLOR="#000000">(</FONT>DERRand1 <FONT COLOR="#000000">(</FONT>d3<FONT COLOR="#000000">,</FONT> thick d22<FONT COLOR="#000000">,</FONT> c4<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
      <FONT COLOR="#000000">end</FONT></FONT>
    <FONT COLOR="#000000">end</FONT>

  <FONT COLOR="#000000">|</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRand2 <FONT COLOR="#000000">(</FONT>d21<FONT COLOR="#000000">,</FONT> d22<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d21' <FONT COLOR="#000000">=</FONT> cut <FONT COLOR="#000000">(</FONT>a<FONT COLOR="#000000">,</FONT> d1<FONT COLOR="#000000">,</FONT> d21<FONT COLOR="#000000">,</FONT> c<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d22' <FONT COLOR="#000000">=</FONT> cut <FONT COLOR="#000000">(</FONT>a<FONT COLOR="#000000">,</FONT> d1<FONT COLOR="#000000">,</FONT> d22<FONT COLOR="#000000">,</FONT> c<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">in</FONT>
      DERright <FONT COLOR="#000000">(</FONT>DERRand2 <FONT COLOR="#000000">(</FONT>d21'<FONT COLOR="#000000">,</FONT> d22'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT>

  <FONT COLOR="#000000">|</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRor1 d21<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT>
      DERright <FONT COLOR="#000000">(</FONT>DERRor1 <FONT COLOR="#000000">(</FONT>cut <FONT COLOR="#000000">(</FONT>a<FONT COLOR="#000000">,</FONT> d1<FONT COLOR="#000000">,</FONT> d21<FONT COLOR="#000000">,</FONT> c<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>

  <FONT COLOR="#000000">|</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRor2 d22<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT>
      DERright <FONT COLOR="#000000">(</FONT>DERRor2 <FONT COLOR="#000000">(</FONT>cut <FONT COLOR="#000000">(</FONT>a<FONT COLOR="#000000">,</FONT> d1<FONT COLOR="#000000">,</FONT> d22<FONT COLOR="#000000">,</FONT> c<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> 

  <FONT COLOR="#000000">|</FONT> DERright <FONT COLOR="#000000">(</FONT>DERRimp d2'<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d1' <FONT COLOR="#000000">=</FONT> thin d1 <FONT COLOR="#000000">and</FONT> d3 <FONT COLOR="#000000">=</FONT> exch d2'</FONT>
    <FONT COLOR="#000000">in</FONT> 
      DERright <FONT COLOR="#000000">(</FONT>DERRimp <FONT COLOR="#000000">(</FONT>cut <FONT COLOR="#000000">(</FONT>a<FONT COLOR="#000000">,</FONT> d1'<FONT COLOR="#000000">,</FONT> d3<FONT COLOR="#000000">,</FONT> COMBmore c<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT>
<FONT COLOR="#000000">end</FONT> <FONT COLOR="#787878">// end of [cut]
</FONT>
<FONT COLOR="#000000">and</FONT> cutAux
  <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">,</FONT>G3<FONT COLOR="#000000">:</FONT>seq<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>A1<FONT COLOR="#000000">,</FONT>A2<FONT COLOR="#000000">:</FONT>form<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>m<FONT COLOR="#000000">,</FONT>n1<FONT COLOR="#000000">,</FONT>n2<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>m<FONT COLOR="#000000">,</FONT> n2<FONT COLOR="#000000">,</FONT> n1<FONT COLOR="#000000">&gt;.</FONT></FONT> <FONT COLOR="#000000">(</FONT>
    a<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">FM <FONT COLOR="#000000">(</FONT>A1<FONT COLOR="#000000">,</FONT> m<FONT COLOR="#000000">)</FONT></FONT>
  <FONT COLOR="#000000">,</FONT> d1<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DERL <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> A1<FONT COLOR="#000000">,</FONT> n1<FONT COLOR="#000000">)</FONT></FONT>
  <FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DER <FONT COLOR="#000000">(</FONT>more <FONT COLOR="#000000">(</FONT>G2<FONT COLOR="#000000">,</FONT> A1<FONT COLOR="#000000">,</FONT> 1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">,</FONT> n2<FONT COLOR="#000000">)</FONT></FONT>
  <FONT COLOR="#000000">,</FONT> c<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">COMB0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">,</FONT> G3<FONT COLOR="#000000">)</FONT></FONT>
  <FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DER0 <FONT COLOR="#000000">(</FONT>G3<FONT COLOR="#000000">,</FONT> A2<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT> <FONT COLOR="#000000">begin</FONT> <FONT COLOR="#000000">case+</FONT> d1 <FONT COLOR="#000000">of</FONT>
  <FONT COLOR="#000000">|</FONT> DERLtimes <FONT COLOR="#000000">(</FONT>d1'<FONT COLOR="#000000">,</FONT> add<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>c1<FONT COLOR="#000000">,</FONT> add1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma43 <FONT COLOR="#000000">(</FONT>c<FONT COLOR="#000000">,</FONT> add<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d2' <FONT COLOR="#000000">=</FONT> exch <FONT COLOR="#000000">(</FONT>thin <FONT COLOR="#000000">(</FONT>exch <FONT COLOR="#000000">(</FONT>thin d2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d <FONT COLOR="#000000">=</FONT> cut <FONT COLOR="#000000">(</FONT>a<FONT COLOR="#000000">,</FONT> d1'<FONT COLOR="#000000">,</FONT> d2'<FONT COLOR="#000000">,</FONT> COMBmore <FONT COLOR="#000000">(</FONT>COMBmore c1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT>  
    <FONT COLOR="#000000">in</FONT>
      DERleft <FONT COLOR="#000000">(</FONT>DERLtimes <FONT COLOR="#000000">(</FONT>d<FONT COLOR="#000000">,</FONT> add1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> 
    <FONT COLOR="#000000">end</FONT>

  <FONT COLOR="#000000">|</FONT> DERLand1 <FONT COLOR="#000000">(</FONT>d1'<FONT COLOR="#000000">,</FONT> add<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>c1<FONT COLOR="#000000">,</FONT> add1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma43 <FONT COLOR="#000000">(</FONT>c<FONT COLOR="#000000">,</FONT> add<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d2' <FONT COLOR="#000000">=</FONT> exch <FONT COLOR="#000000">(</FONT>thin d2<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d <FONT COLOR="#000000">=</FONT> cut <FONT COLOR="#000000">(</FONT>a<FONT COLOR="#000000">,</FONT> d1'<FONT COLOR="#000000">,</FONT> d2'<FONT COLOR="#000000">,</FONT> COMBmore c1<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">in</FONT>
      DERleft <FONT COLOR="#000000">(</FONT>DERLand1 <FONT COLOR="#000000">(</FONT>d<FONT COLOR="#000000">,</FONT> add1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT>

  <FONT COLOR="#000000">|</FONT> DERLand2 <FONT COLOR="#000000">(</FONT>d1'<FONT COLOR="#000000">,</FONT> add<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>c1<FONT COLOR="#000000">,</FONT> add1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma43 <FONT COLOR="#000000">(</FONT>c<FONT COLOR="#000000">,</FONT> add<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d2' <FONT COLOR="#000000">=</FONT> exch <FONT COLOR="#000000">(</FONT>thin d2<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d <FONT COLOR="#000000">=</FONT> cut <FONT COLOR="#000000">(</FONT>a<FONT COLOR="#000000">,</FONT> d1'<FONT COLOR="#000000">,</FONT> d2'<FONT COLOR="#000000">,</FONT> COMBmore c1<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">in</FONT>
      DERleft <FONT COLOR="#000000">(</FONT>DERLand2 <FONT COLOR="#000000">(</FONT>d<FONT COLOR="#000000">,</FONT> add1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT>

  <FONT COLOR="#000000">|</FONT> DERLor <FONT COLOR="#000000">(</FONT>d11<FONT COLOR="#000000">,</FONT> d12<FONT COLOR="#000000">,</FONT> add<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>c1<FONT COLOR="#000000">,</FONT> add1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma43 <FONT COLOR="#000000">(</FONT>c<FONT COLOR="#000000">,</FONT> add<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d21' <FONT COLOR="#000000">=</FONT> exch <FONT COLOR="#000000">(</FONT>thin d2<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d11' <FONT COLOR="#000000">=</FONT> cut <FONT COLOR="#000000">(</FONT>a<FONT COLOR="#000000">,</FONT> d11<FONT COLOR="#000000">,</FONT> d21'<FONT COLOR="#000000">,</FONT> COMBmore c1<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d22' <FONT COLOR="#000000">=</FONT> exch <FONT COLOR="#000000">(</FONT>thin d2<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d12' <FONT COLOR="#000000">=</FONT> cut <FONT COLOR="#000000">(</FONT>a<FONT COLOR="#000000">,</FONT> d12<FONT COLOR="#000000">,</FONT> d22'<FONT COLOR="#000000">,</FONT> COMBmore c1<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">in</FONT>
      DERleft <FONT COLOR="#000000">(</FONT>DERLor <FONT COLOR="#000000">(</FONT>d11'<FONT COLOR="#000000">,</FONT> d12'<FONT COLOR="#000000">,</FONT> add1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT>

  <FONT COLOR="#000000">|</FONT> DERLimp <FONT COLOR="#000000">(</FONT>d11<FONT COLOR="#000000">,</FONT> d12<FONT COLOR="#000000">,</FONT> c1<FONT COLOR="#000000">,</FONT> add1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT>c3<FONT COLOR="#000000">,</FONT> c4<FONT COLOR="#000000">,</FONT> add3<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma41 <FONT COLOR="#000000">(</FONT>c1<FONT COLOR="#000000">,</FONT> add1<FONT COLOR="#000000">,</FONT> c<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d2' <FONT COLOR="#000000">=</FONT> exch <FONT COLOR="#000000">(</FONT>thin d2<FONT COLOR="#000000">)</FONT></FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">d3 <FONT COLOR="#000000">=</FONT> cut <FONT COLOR="#000000">(</FONT>a<FONT COLOR="#000000">,</FONT> d12<FONT COLOR="#000000">,</FONT> d2'<FONT COLOR="#000000">,</FONT> COMBmore c3<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">in</FONT>
      DERleft <FONT COLOR="#000000">(</FONT>DERLimp <FONT COLOR="#000000">(</FONT>d11<FONT COLOR="#000000">,</FONT> d3<FONT COLOR="#000000">,</FONT> c4<FONT COLOR="#000000">,</FONT> add3<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT>
<FONT COLOR="#000000">end</FONT></FONT> <FONT COLOR="#787878">// end of [cutAux]
</FONT>
<FONT COLOR="#787878">(* ****** ****** *)</FONT>

<FONT COLOR="#787878">(* end of [CutElimILL.dats] *)</FONT>
</PRE></BODY>
