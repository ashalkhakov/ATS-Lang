<BODY BGCOLOR="#E0E0E0" TEXT="#E80000"><PRE><FONT COLOR="#787878">//
</FONT><FONT COLOR="#787878">//
</FONT><FONT COLOR="#787878">// A proof of the irrationality of the square root of 2 in ATS/LF
</FONT><FONT COLOR="#787878">//
</FONT><FONT COLOR="#787878">// author: Hongwei Xi (Nov 1, 2007)
</FONT><FONT COLOR="#787878">//
</FONT><FONT COLOR="#787878">//
</FONT>
<FONT COLOR="#787878">//
</FONT><FONT COLOR="#787878">// Aaron Stump mentioned the problem during his visit at BU on Nov 1, 2007.
</FONT><FONT COLOR="#787878">// This solution is self-contained.
</FONT><FONT COLOR="#787878">//
</FONT>
<FONT COLOR="#787878">//
</FONT><FONT COLOR="#787878">// March 6th, 2008
</FONT><FONT COLOR="#787878">// The code is ported to ATS/Anairiats by Hongwei Xi. This example involves
</FONT><FONT COLOR="#787878">// an interesting use of manual splitting on an integer variable. See below.
</FONT><FONT COLOR="#787878">//
</FONT>
<FONT COLOR="#787878">(* ****** ****** *)</FONT>

<FONT COLOR="#000000">dataprop</FONT> <FONT COLOR="#009000"><FONT COLOR="#0000FF">MUL1 <FONT COLOR="#000000">(</FONT>int<FONT COLOR="#000000">,</FONT> int<FONT COLOR="#000000">,</FONT> int<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">n<FONT COLOR="#000000">:</FONT>int</FONT><FONT COLOR="#000000">}</FONT>
      MUL1bas <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>0<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">,</FONT> 0<FONT COLOR="#000000">)</FONT></FONT>
  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">m<FONT COLOR="#000000">,</FONT>n<FONT COLOR="#000000">,</FONT>p<FONT COLOR="#000000">:</FONT>int</FONT> <FONT COLOR="#000000">|</FONT> <FONT COLOR="#0000FF">m &gt;= 0</FONT><FONT COLOR="#000000">}</FONT>
      MUL1ind <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>m+1<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">,</FONT> p+n<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF">MUL1 <FONT COLOR="#000000">(</FONT>m<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">,</FONT> p<FONT COLOR="#000000">)</FONT></FONT>
  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">m<FONT COLOR="#000000">,</FONT>n<FONT COLOR="#000000">,</FONT>p<FONT COLOR="#000000">:</FONT>int</FONT> <FONT COLOR="#000000">|</FONT> <FONT COLOR="#0000FF">m <FONT COLOR="#000000">&gt;</FONT> 0</FONT><FONT COLOR="#000000">}</FONT>
      MUL1neg <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">~</FONT>m<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">,</FONT> <FONT COLOR="#000000">~</FONT>p<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF">MUL1 <FONT COLOR="#000000">(</FONT>m<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">,</FONT> p<FONT COLOR="#000000">)</FONT></FONT></FONT>

<FONT COLOR="#787878">// m * 0 = x implies x = 0
</FONT><FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">lemma00 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>m<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>x<FONT COLOR="#000000">:</FONT>int<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>m<FONT COLOR="#000000">&gt;.</FONT></FONT> <FONT COLOR="#000000">(</FONT>pf<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">MUL1 <FONT COLOR="#000000">(</FONT>m<FONT COLOR="#000000">,</FONT> 0<FONT COLOR="#000000">,</FONT> x<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">[</FONT>x == 0<FONT COLOR="#000000">]</FONT> void</FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#009000"><FONT COLOR="#000000">sif</FONT> <FONT COLOR="#0000FF">m <FONT COLOR="#000000">&gt;</FONT> 0</FONT> <FONT COLOR="#000000">then</FONT> <FONT COLOR="#000000">begin</FONT>
    <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">MUL1ind pf1 <FONT COLOR="#000000">=</FONT> pf</FONT> <FONT COLOR="#000000">in</FONT> lemma00 pf1 <FONT COLOR="#000000">end</FONT>
  <FONT COLOR="#000000">end</FONT> <FONT COLOR="#000000">else</FONT> <FONT COLOR="#000000">begin</FONT>
    <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">MUL1bas <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> pf</FONT> <FONT COLOR="#000000">in</FONT> <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">end</FONT>
  <FONT COLOR="#000000">end</FONT></FONT></FONT>

<FONT COLOR="#787878">// m * n = x implies m * (n-1) = x - m
</FONT><FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">lemma01 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>m<FONT COLOR="#000000">,</FONT>n<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>x<FONT COLOR="#000000">:</FONT>int<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>m<FONT COLOR="#000000">&gt;.</FONT></FONT> <FONT COLOR="#000000">(</FONT>pf<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">MUL1 <FONT COLOR="#000000">(</FONT>m<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">,</FONT> x<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT>
  <FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">MUL1 <FONT COLOR="#000000">(</FONT>m<FONT COLOR="#000000">,</FONT> n-1<FONT COLOR="#000000">,</FONT> x-m<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#009000"><FONT COLOR="#000000">sif</FONT> <FONT COLOR="#0000FF">m <FONT COLOR="#000000">&gt;</FONT> 0</FONT> <FONT COLOR="#000000">then</FONT> <FONT COLOR="#000000">begin</FONT>
    <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">MUL1ind pf1 <FONT COLOR="#000000">=</FONT> pf</FONT> <FONT COLOR="#000000">in</FONT> MUL1ind <FONT COLOR="#000000">(</FONT>lemma01 pf1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">end</FONT>
  <FONT COLOR="#000000">end</FONT> <FONT COLOR="#000000">else</FONT> <FONT COLOR="#000000">begin</FONT>
    <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">MUL1bas <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> pf</FONT> <FONT COLOR="#000000">in</FONT> MUL1bas <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">end</FONT>
  <FONT COLOR="#000000">end</FONT></FONT></FONT>

<FONT COLOR="#787878">// commutativity of multiplication
</FONT><FONT COLOR="#787878">// m * n = x implies n * m = x
</FONT><FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">lemma_commute <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>m<FONT COLOR="#000000">,</FONT>n<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>x<FONT COLOR="#000000">:</FONT>int<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>n<FONT COLOR="#000000">&gt;.</FONT></FONT> <FONT COLOR="#000000">(</FONT>pf<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">MUL1 <FONT COLOR="#000000">(</FONT>m<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">,</FONT> x<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT>
  <FONT COLOR="#000000">:&lt;</FONT><FONT COLOR="#0000FF">prf</FONT><FONT COLOR="#000000">&gt;</FONT> <FONT COLOR="#0000FF">MUL1 <FONT COLOR="#000000">(</FONT>n<FONT COLOR="#000000">,</FONT> m<FONT COLOR="#000000">,</FONT> x<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#009000"><FONT COLOR="#000000">sif</FONT> <FONT COLOR="#0000FF">n <FONT COLOR="#000000">&gt;</FONT> 0</FONT> <FONT COLOR="#000000">then</FONT> <FONT COLOR="#000000">begin</FONT>
    <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">pf1 <FONT COLOR="#000000">=</FONT> lemma01 <FONT COLOR="#000000">(</FONT>pf<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">in</FONT>
      MUL1ind <FONT COLOR="#000000">(</FONT>lemma_commute <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>m<FONT COLOR="#000000">,</FONT>n-1<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#000000">(</FONT>pf1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT>
  <FONT COLOR="#000000">end</FONT> <FONT COLOR="#000000">else</FONT> <FONT COLOR="#000000">begin</FONT>
    <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma00 <FONT COLOR="#000000">(</FONT>pf<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">in</FONT> MUL1bas <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">end</FONT>
  <FONT COLOR="#000000">end</FONT></FONT></FONT>

<FONT COLOR="#787878">// (p + p) * (p + p) = x implies x = 4 * x4 for some x4
</FONT><FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">lemma1 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>p<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>x<FONT COLOR="#000000">:</FONT>int<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>p<FONT COLOR="#000000">&gt;.</FONT></FONT>
  <FONT COLOR="#000000">(</FONT>pf<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">MUL1 <FONT COLOR="#000000">(</FONT>p+p<FONT COLOR="#000000">,</FONT> p+p<FONT COLOR="#000000">,</FONT> x<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">:&lt;</FONT><FONT COLOR="#0000FF">prf</FONT><FONT COLOR="#000000">&gt;</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">[</FONT>x4<FONT COLOR="#000000">:</FONT>int <FONT COLOR="#000000">|</FONT> x == 4*x4<FONT COLOR="#000000">]</FONT> MUL1 <FONT COLOR="#000000">(</FONT>p<FONT COLOR="#000000">,</FONT> p<FONT COLOR="#000000">,</FONT> x4<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#009000"><FONT COLOR="#000000">sif</FONT> <FONT COLOR="#0000FF">p <FONT COLOR="#000000">&gt;</FONT> 0</FONT> <FONT COLOR="#000000">then</FONT> <FONT COLOR="#000000">let</FONT>
    <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">MUL1ind pf1 <FONT COLOR="#000000">=</FONT> pf</FONT>
    <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">MUL1ind pf2 <FONT COLOR="#000000">=</FONT> pf1</FONT>
    <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">pf2' <FONT COLOR="#000000">=</FONT> lemma_commute <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>p+p-2<FONT COLOR="#000000">,</FONT>p+p<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#000000">(</FONT>pf2<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">MUL1ind pf21' <FONT COLOR="#000000">=</FONT> pf2'</FONT>
    <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">MUL1ind pf22' <FONT COLOR="#000000">=</FONT> pf21'</FONT>
    <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">[</FONT><FONT COLOR="#0000FF">x41</FONT><FONT COLOR="#000000">:</FONT>int<FONT COLOR="#000000">]</FONT> pf_1 <FONT COLOR="#000000">=</FONT> lemma1 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>p-1<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>x-8*p+4<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#000000">(</FONT>pf22'<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">pf_2 <FONT COLOR="#000000">=</FONT> MUL1ind <FONT COLOR="#000000">(</FONT>pf_1<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">pf_3 <FONT COLOR="#000000">=</FONT> lemma_commute <FONT COLOR="#000000">(</FONT>pf_2<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">pf_4 <FONT COLOR="#000000">=</FONT> MUL1ind <FONT COLOR="#000000">(</FONT>pf_3<FONT COLOR="#000000">)</FONT></FONT>
  <FONT COLOR="#000000">in</FONT>
    <FONT COLOR="#0000FF"><FONT COLOR="#000000">#[</FONT>x41+2*p-1 <FONT COLOR="#000000">|</FONT></FONT> pf_4<FONT COLOR="#000000">]</FONT>
  <FONT COLOR="#000000">end</FONT> <FONT COLOR="#000000">else</FONT> <FONT COLOR="#000000">let</FONT>
    <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">MUL1bas <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> pf</FONT>
  <FONT COLOR="#000000">in</FONT>
    <FONT COLOR="#0000FF"><FONT COLOR="#000000">#[</FONT>0 <FONT COLOR="#000000">|</FONT></FONT> pf<FONT COLOR="#000000">]</FONT>
  <FONT COLOR="#000000">end</FONT></FONT></FONT>

<FONT COLOR="#787878">// [x &lt;= 0 || x &gt;= 1] is an example of manual splitting!
</FONT><FONT COLOR="#787878">// p * p = x + x implies p = 2 * p2 for some p2
</FONT><FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">lemma2 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>p<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>x<FONT COLOR="#000000">:</FONT>int<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>p<FONT COLOR="#000000">&gt;.</FONT></FONT>
  <FONT COLOR="#000000">(</FONT>pf<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">MUL1 <FONT COLOR="#000000">(</FONT>p<FONT COLOR="#000000">,</FONT> p<FONT COLOR="#000000">,</FONT> x+x<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">:&lt;</FONT><FONT COLOR="#0000FF">prf</FONT><FONT COLOR="#000000">&gt;</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">[</FONT>p2<FONT COLOR="#000000">:</FONT>int <FONT COLOR="#000000">|</FONT> p == 2*p2<FONT COLOR="#000000">]</FONT> void</FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#009000"><FONT COLOR="#000000">sif</FONT> <FONT COLOR="#0000FF">p &gt;= 2</FONT> <FONT COLOR="#000000">then</FONT> <FONT COLOR="#000000">let</FONT>
    <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">MUL1ind pf1 <FONT COLOR="#000000">=</FONT> pf</FONT>
    <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">MUL1ind pf2 <FONT COLOR="#000000">=</FONT> pf1</FONT>
    <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">pf2' <FONT COLOR="#000000">=</FONT> lemma_commute <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>p-2<FONT COLOR="#000000">,</FONT>p<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#000000">(</FONT>pf2<FONT COLOR="#000000">)</FONT></FONT>
    <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">MUL1ind pf21' <FONT COLOR="#000000">=</FONT> pf2'</FONT>
    <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">MUL1ind pf22' <FONT COLOR="#000000">=</FONT> pf21'</FONT>
    <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">[</FONT><FONT COLOR="#0000FF">p21</FONT><FONT COLOR="#000000">:</FONT>int<FONT COLOR="#000000">]</FONT> <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma2 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>p-2<FONT COLOR="#000000">}</FONT></FONT><FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>x-2*p+2<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#000000">(</FONT>pf22'<FONT COLOR="#000000">)</FONT></FONT>
  <FONT COLOR="#000000">in</FONT>
    <FONT COLOR="#0000FF"><FONT COLOR="#000000">#[</FONT>p21+1 <FONT COLOR="#000000">|</FONT></FONT> <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">]</FONT>
  <FONT COLOR="#000000">end</FONT> <FONT COLOR="#000000">else</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">sif</FONT> <FONT COLOR="#0000FF">p == 1</FONT> <FONT COLOR="#000000">then</FONT> <FONT COLOR="#000000">let</FONT>
<FONT COLOR="#787878">(*
    prval () = (): [x &lt;= 0 || x &gt;= 1] void // an example of manual splitting!
*)</FONT>
    <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">MUL1ind pf1 <FONT COLOR="#000000">=</FONT> pf</FONT>
    <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">MUL1bas <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> pf1</FONT>
  <FONT COLOR="#000000">in</FONT>
    <FONT COLOR="#0000FF"><FONT COLOR="#000000">#[</FONT>0 <FONT COLOR="#000000">|</FONT></FONT> <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">]</FONT> <FONT COLOR="#787878">// impossible
</FONT>  <FONT COLOR="#000000">end</FONT> <FONT COLOR="#000000">else</FONT> <FONT COLOR="#000000">let</FONT>
    <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">MUL1bas <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> pf</FONT>
  <FONT COLOR="#000000">in</FONT>
    <FONT COLOR="#0000FF"><FONT COLOR="#000000">#[</FONT>0 <FONT COLOR="#000000">|</FONT></FONT> <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">]</FONT>
  <FONT COLOR="#000000">end</FONT></FONT></FONT></FONT>

<FONT COLOR="#787878">// (p * p = x and q * q = x + x) implies x = 0
</FONT><FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">lemma_main <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>p<FONT COLOR="#000000">,</FONT>q<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>x<FONT COLOR="#000000">:</FONT>int<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>p<FONT COLOR="#000000">&gt;.</FONT></FONT>
  <FONT COLOR="#000000">(</FONT>pf1<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">MUL1 <FONT COLOR="#000000">(</FONT>p<FONT COLOR="#000000">,</FONT> p<FONT COLOR="#000000">,</FONT> x<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> pf2<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">MUL1 <FONT COLOR="#000000">(</FONT>q<FONT COLOR="#000000">,</FONT> q<FONT COLOR="#000000">,</FONT> x+x<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">[</FONT>x == 0<FONT COLOR="#000000">]</FONT> void</FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#009000"><FONT COLOR="#000000">sif</FONT> <FONT COLOR="#0000FF">p <FONT COLOR="#000000">&gt;</FONT> 0</FONT> <FONT COLOR="#000000">then</FONT> <FONT COLOR="#000000">let</FONT>
    <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">[</FONT><FONT COLOR="#0000FF">q2</FONT><FONT COLOR="#000000">:</FONT>int<FONT COLOR="#000000">]</FONT> <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma2 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>q<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>x<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#000000">(</FONT>pf2<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#787878">// q = 2*q2
</FONT>    <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">[</FONT><FONT COLOR="#0000FF">x2</FONT><FONT COLOR="#000000">:</FONT>int<FONT COLOR="#000000">]</FONT> pf2' <FONT COLOR="#000000">=</FONT> lemma1 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>q2<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>x+x<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#000000">(</FONT>pf2<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#787878">// x+x = 4*x2
</FONT>    <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">[</FONT><FONT COLOR="#0000FF">p2</FONT><FONT COLOR="#000000">:</FONT>int<FONT COLOR="#000000">]</FONT> <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> lemma2 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>p<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>x2<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#000000">(</FONT>pf1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#787878">// p = 2*p2
</FONT>    <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000"><FONT COLOR="#000000">[</FONT><FONT COLOR="#0000FF">x4</FONT><FONT COLOR="#000000">:</FONT>int<FONT COLOR="#000000">]</FONT> pf1' <FONT COLOR="#000000">=</FONT> lemma1 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>p2<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>x2+x2<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#000000">(</FONT>pf1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#787878">// x2+x2 = 4*x4
</FONT>  <FONT COLOR="#000000">in</FONT>
    lemma_main <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>p2<FONT COLOR="#000000">,</FONT>q2<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>x4<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#000000">(</FONT>pf1'<FONT COLOR="#000000">,</FONT> pf2'<FONT COLOR="#000000">)</FONT>
  <FONT COLOR="#000000">end</FONT> <FONT COLOR="#000000">else</FONT> <FONT COLOR="#000000">begin</FONT>
    <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">MUL1bas <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> pf1</FONT> <FONT COLOR="#000000">in</FONT> <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">end</FONT>
  <FONT COLOR="#000000">end</FONT></FONT></FONT>

<FONT COLOR="#787878">(* ****** ****** *)</FONT>

<FONT COLOR="#787878">(* end of [irrationality_of_sqrt2.dats] *)</FONT>
</PRE></BODY>
