<BODY BGCOLOR="#E0E0E0" TEXT="#E80000"><PRE><FONT COLOR="#787878">// A formalization of simply typed call-by-value lambda-calculus with
</FONT><FONT COLOR="#787878">// products and fixed-points that makes use of an encoding based on
</FONT><FONT COLOR="#787878">// a form of first-order abstract syntax. This example was meant to
</FONT><FONT COLOR="#787878">// gain some experience with first-order abstract syntax.
</FONT>
<FONT COLOR="#787878">// August 2005:
</FONT><FONT COLOR="#787878">// It is completed by Hongwei Xi.
</FONT>
<FONT COLOR="#787878">// January 2007:
</FONT><FONT COLOR="#787878">// It is ported to ATS/Geizella by Hongwei Xi
</FONT>
<FONT COLOR="#000000">datasort</FONT> <FONT COLOR="#0000FF">tm <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">|</FONT> tmvar <FONT COLOR="#000000">of</FONT> int
  <FONT COLOR="#000000">|</FONT> tmlam <FONT COLOR="#000000">of</FONT> tm
  <FONT COLOR="#000000">|</FONT> tmapp <FONT COLOR="#000000">of</FONT> <FONT COLOR="#000000">(</FONT>tm<FONT COLOR="#000000">,</FONT> tm<FONT COLOR="#000000">)</FONT></FONT>

<FONT COLOR="#000000">dataprop</FONT> <FONT COLOR="#009000"><FONT COLOR="#0000FF">tmshi <FONT COLOR="#000000">(</FONT>tm<FONT COLOR="#000000">,</FONT> tm<FONT COLOR="#000000">,</FONT> int<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">i<FONT COLOR="#000000">,</FONT>l<FONT COLOR="#000000">:</FONT>nat</FONT> <FONT COLOR="#000000">|</FONT> <FONT COLOR="#0000FF">i &gt;= l</FONT><FONT COLOR="#000000">}</FONT> TMSHIvargte <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>tmvar i<FONT COLOR="#000000">,</FONT> tmvar <FONT COLOR="#000000">(</FONT>i+1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> l<FONT COLOR="#000000">)</FONT></FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">i<FONT COLOR="#000000">,</FONT>l<FONT COLOR="#000000">:</FONT>nat</FONT> <FONT COLOR="#000000">|</FONT> <FONT COLOR="#0000FF">i <FONT COLOR="#000000">&lt;</FONT> l</FONT><FONT COLOR="#000000">}</FONT> TMSHIvarlt <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>tmvar i<FONT COLOR="#000000">,</FONT> tmvar i<FONT COLOR="#000000">,</FONT> l<FONT COLOR="#000000">)</FONT></FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">t<FONT COLOR="#000000">,</FONT>t'<FONT COLOR="#000000">:</FONT>tm</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">l<FONT COLOR="#000000">:</FONT>nat</FONT><FONT COLOR="#000000">}</FONT>
      TMSHIlam <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>tmlam t<FONT COLOR="#000000">,</FONT> tmlam t'<FONT COLOR="#000000">,</FONT> l<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF">tmshi <FONT COLOR="#000000">(</FONT>t<FONT COLOR="#000000">,</FONT> t'<FONT COLOR="#000000">,</FONT> l+1<FONT COLOR="#000000">)</FONT></FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">t1<FONT COLOR="#000000">,</FONT>t2<FONT COLOR="#000000">,</FONT>t1'<FONT COLOR="#000000">,</FONT>t2'<FONT COLOR="#000000">:</FONT>tm</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">l<FONT COLOR="#000000">:</FONT>nat</FONT><FONT COLOR="#000000">}</FONT>
      TMSHIapp <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>tmapp <FONT COLOR="#000000">(</FONT>t1<FONT COLOR="#000000">,</FONT> t2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> tmapp <FONT COLOR="#000000">(</FONT>t1'<FONT COLOR="#000000">,</FONT> t2'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> l<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT>
        <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>tmshi <FONT COLOR="#000000">(</FONT>t1<FONT COLOR="#000000">,</FONT> t1'<FONT COLOR="#000000">,</FONT> l<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> tmshi <FONT COLOR="#000000">(</FONT>t2<FONT COLOR="#000000">,</FONT> t2'<FONT COLOR="#000000">,</FONT> l<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT></FONT>

<FONT COLOR="#000000">datasort</FONT> <FONT COLOR="#0000FF">tms <FONT COLOR="#000000">=</FONT> tmsnil <FONT COLOR="#000000">|</FONT> tmsmore <FONT COLOR="#000000">of</FONT> <FONT COLOR="#000000">(</FONT>tms<FONT COLOR="#000000">,</FONT> tm<FONT COLOR="#000000">)</FONT></FONT>

<FONT COLOR="#000000">dataprop</FONT> <FONT COLOR="#009000"><FONT COLOR="#0000FF">subshi <FONT COLOR="#000000">(</FONT>tms<FONT COLOR="#000000">,</FONT> tms<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">|</FONT> SUBSHInil <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>tmsnil<FONT COLOR="#000000">,</FONT> tmsnil<FONT COLOR="#000000">)</FONT></FONT>
  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">ts<FONT COLOR="#000000">,</FONT>ts'<FONT COLOR="#000000">:</FONT>tms</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">t<FONT COLOR="#000000">,</FONT>t'<FONT COLOR="#000000">:</FONT>tm</FONT><FONT COLOR="#000000">}</FONT>
      SUBSHImore <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>tmsmore <FONT COLOR="#000000">(</FONT>ts<FONT COLOR="#000000">,</FONT> t<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> tmsmore <FONT COLOR="#000000">(</FONT>ts'<FONT COLOR="#000000">,</FONT> t'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT>
        <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>subshi <FONT COLOR="#000000">(</FONT>ts<FONT COLOR="#000000">,</FONT> ts'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> tmshi <FONT COLOR="#000000">(</FONT>t<FONT COLOR="#000000">,</FONT> t'<FONT COLOR="#000000">,</FONT> 0<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT></FONT>

<FONT COLOR="#000000">extern</FONT> <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">subshiFun <FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>th<FONT COLOR="#000000">:</FONT>tms<FONT COLOR="#000000">}</FONT><FONT COLOR="#000000">[</FONT>th'<FONT COLOR="#000000">:</FONT>tms<FONT COLOR="#000000">]</FONT> subshi <FONT COLOR="#000000">(</FONT>th<FONT COLOR="#000000">,</FONT> th'<FONT COLOR="#000000">)</FONT></FONT></FONT>

<FONT COLOR="#787878">//
</FONT>
<FONT COLOR="#000000">dataprop</FONT> <FONT COLOR="#009000"><FONT COLOR="#0000FF">TMI <FONT COLOR="#000000">(</FONT>int<FONT COLOR="#000000">,</FONT> tm<FONT COLOR="#000000">,</FONT> tms<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">ts<FONT COLOR="#000000">:</FONT>tms</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">t<FONT COLOR="#000000">:</FONT>tm</FONT><FONT COLOR="#000000">}</FONT> TMIone <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>0<FONT COLOR="#000000">,</FONT> t<FONT COLOR="#000000">,</FONT> tmsmore <FONT COLOR="#000000">(</FONT>ts<FONT COLOR="#000000">,</FONT> t<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT>
  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">ts<FONT COLOR="#000000">:</FONT>tms</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">t<FONT COLOR="#000000">,</FONT>t'<FONT COLOR="#000000">:</FONT>tm</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">i<FONT COLOR="#000000">:</FONT>int</FONT> <FONT COLOR="#000000">|</FONT> <FONT COLOR="#0000FF">i <FONT COLOR="#000000">&gt;</FONT> 0</FONT><FONT COLOR="#000000">}</FONT>
      TMIshi <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>i<FONT COLOR="#000000">,</FONT> t<FONT COLOR="#000000">,</FONT> tmsmore <FONT COLOR="#000000">(</FONT>ts<FONT COLOR="#000000">,</FONT> t'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF">TMI <FONT COLOR="#000000">(</FONT>i-1<FONT COLOR="#000000">,</FONT> t<FONT COLOR="#000000">,</FONT> ts<FONT COLOR="#000000">)</FONT></FONT></FONT>

<FONT COLOR="#000000">dataprop</FONT> <FONT COLOR="#009000"><FONT COLOR="#0000FF">subst <FONT COLOR="#000000">(</FONT>tms<FONT COLOR="#000000">,</FONT> tm<FONT COLOR="#000000">,</FONT> tm<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">ts<FONT COLOR="#000000">:</FONT>tms</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">t<FONT COLOR="#000000">:</FONT>tm</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">i<FONT COLOR="#000000">:</FONT>nat</FONT><FONT COLOR="#000000">}</FONT> SUBvar <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>ts<FONT COLOR="#000000">,</FONT> tmvar i<FONT COLOR="#000000">,</FONT> t<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF">TMI <FONT COLOR="#000000">(</FONT>i<FONT COLOR="#000000">,</FONT> t<FONT COLOR="#000000">,</FONT> ts<FONT COLOR="#000000">)</FONT></FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">ts<FONT COLOR="#000000">,</FONT>ts'<FONT COLOR="#000000">:</FONT>tms</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">t<FONT COLOR="#000000">,</FONT>t'<FONT COLOR="#000000">:</FONT>tm</FONT><FONT COLOR="#000000">}</FONT>
      SUBlam <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>ts<FONT COLOR="#000000">,</FONT> tmlam t<FONT COLOR="#000000">,</FONT> tmlam t'<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT>
        <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>subshi <FONT COLOR="#000000">(</FONT>ts<FONT COLOR="#000000">,</FONT> ts'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> subst <FONT COLOR="#000000">(</FONT>tmsmore <FONT COLOR="#000000">(</FONT>ts'<FONT COLOR="#000000">,</FONT> tmvar 0<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> t<FONT COLOR="#000000">,</FONT> t'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">ts<FONT COLOR="#000000">:</FONT>tms</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">t1<FONT COLOR="#000000">,</FONT>t2<FONT COLOR="#000000">,</FONT>t1'<FONT COLOR="#000000">,</FONT>t2'<FONT COLOR="#000000">:</FONT>tm</FONT><FONT COLOR="#000000">}</FONT>
      SUBapp <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>ts<FONT COLOR="#000000">,</FONT> tmapp <FONT COLOR="#000000">(</FONT>t1<FONT COLOR="#000000">,</FONT> t2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> tmapp <FONT COLOR="#000000">(</FONT>t1'<FONT COLOR="#000000">,</FONT> t2'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT>
        <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>subst <FONT COLOR="#000000">(</FONT>ts<FONT COLOR="#000000">,</FONT> t1<FONT COLOR="#000000">,</FONT> t1'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> subst <FONT COLOR="#000000">(</FONT>ts<FONT COLOR="#000000">,</FONT> t2<FONT COLOR="#000000">,</FONT> t2'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT></FONT>

<FONT COLOR="#000000">propdef</FONT> <FONT COLOR="#0000FF">subst1 <FONT COLOR="#000000">(</FONT>t1<FONT COLOR="#000000">:</FONT>tm<FONT COLOR="#000000">,</FONT> t2<FONT COLOR="#000000">:</FONT>tm<FONT COLOR="#000000">,</FONT> t3<FONT COLOR="#000000">:</FONT>tm<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> subst <FONT COLOR="#000000">(</FONT>tmsmore <FONT COLOR="#000000">(</FONT>tmsnil<FONT COLOR="#000000">,</FONT> t1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> t2<FONT COLOR="#000000">,</FONT> t3<FONT COLOR="#000000">)</FONT></FONT>

<FONT COLOR="#787878">//
</FONT>
<FONT COLOR="#000000">datasort</FONT> <FONT COLOR="#0000FF">tp <FONT COLOR="#000000">=</FONT> tpunit <FONT COLOR="#000000">|</FONT> tpfun <FONT COLOR="#000000">of</FONT> <FONT COLOR="#000000">(</FONT>tp<FONT COLOR="#000000">,</FONT> tp<FONT COLOR="#000000">)</FONT></FONT>

<FONT COLOR="#000000">datasort</FONT> <FONT COLOR="#0000FF">tps <FONT COLOR="#000000">=</FONT> tpsnil <FONT COLOR="#000000">|</FONT> tpsmore <FONT COLOR="#000000">of</FONT> <FONT COLOR="#000000">(</FONT>tps<FONT COLOR="#000000">,</FONT> tp<FONT COLOR="#000000">)</FONT></FONT>

<FONT COLOR="#000000">dataprop</FONT> <FONT COLOR="#009000"><FONT COLOR="#0000FF">TPI <FONT COLOR="#000000">(</FONT>int<FONT COLOR="#000000">,</FONT> tp<FONT COLOR="#000000">,</FONT> tps<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">Ts<FONT COLOR="#000000">:</FONT>tps</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">T<FONT COLOR="#000000">:</FONT>tp</FONT><FONT COLOR="#000000">}</FONT> TPIone <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>0<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">,</FONT> tpsmore <FONT COLOR="#000000">(</FONT>Ts<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT>
  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">Ts<FONT COLOR="#000000">:</FONT>tps</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">T<FONT COLOR="#000000">,</FONT>T'<FONT COLOR="#000000">:</FONT>tp</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">i<FONT COLOR="#000000">:</FONT>int</FONT> <FONT COLOR="#000000">|</FONT> <FONT COLOR="#0000FF">i <FONT COLOR="#000000">&gt;</FONT> 0</FONT><FONT COLOR="#000000">}</FONT>
      TPIshi <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>i<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">,</FONT> tpsmore <FONT COLOR="#000000">(</FONT>Ts<FONT COLOR="#000000">,</FONT> T'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF">TPI <FONT COLOR="#000000">(</FONT>i-1<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">,</FONT> Ts<FONT COLOR="#000000">)</FONT></FONT></FONT>

<FONT COLOR="#787878">//
</FONT>
<FONT COLOR="#000000">dataprop</FONT> <FONT COLOR="#009000"><FONT COLOR="#0000FF">DER <FONT COLOR="#000000">(</FONT>tps<FONT COLOR="#000000">,</FONT> tm<FONT COLOR="#000000">,</FONT> tp<FONT COLOR="#000000">,</FONT> int<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">G<FONT COLOR="#000000">:</FONT>tps</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">T<FONT COLOR="#000000">:</FONT>tp</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">i<FONT COLOR="#000000">:</FONT>nat</FONT><FONT COLOR="#000000">}</FONT> DERvar <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> tmvar i<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">,</FONT> 0<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF">TPI <FONT COLOR="#000000">(</FONT>i<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">,</FONT> G<FONT COLOR="#000000">)</FONT></FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">G<FONT COLOR="#000000">:</FONT>tps</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">T1<FONT COLOR="#000000">,</FONT>T2<FONT COLOR="#000000">:</FONT>tp</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">t<FONT COLOR="#000000">:</FONT>tm</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">s<FONT COLOR="#000000">:</FONT>nat</FONT><FONT COLOR="#000000">}</FONT>
      DERlam <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> tmlam t<FONT COLOR="#000000">,</FONT> tpfun <FONT COLOR="#000000">(</FONT>T1<FONT COLOR="#000000">,</FONT> T2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> s+1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF">DER <FONT COLOR="#000000">(</FONT>tpsmore <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> T1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> t<FONT COLOR="#000000">,</FONT> T2<FONT COLOR="#000000">,</FONT> s<FONT COLOR="#000000">)</FONT></FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">G<FONT COLOR="#000000">:</FONT>tps</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">T1<FONT COLOR="#000000">,</FONT>T2<FONT COLOR="#000000">:</FONT>tp</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">t1<FONT COLOR="#000000">,</FONT>t2<FONT COLOR="#000000">:</FONT>tm</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">s1<FONT COLOR="#000000">,</FONT>s2<FONT COLOR="#000000">:</FONT>nat</FONT><FONT COLOR="#000000">}</FONT>
      DERapp <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> tmapp <FONT COLOR="#000000">(</FONT>t1<FONT COLOR="#000000">,</FONT> t2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> T2<FONT COLOR="#000000">,</FONT> s1+s2+1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT>
        <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>DER <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> t1<FONT COLOR="#000000">,</FONT> tpfun <FONT COLOR="#000000">(</FONT>T1<FONT COLOR="#000000">,</FONT> T2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> s1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> DER <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> t2<FONT COLOR="#000000">,</FONT> T1<FONT COLOR="#000000">,</FONT> s2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT></FONT>

<FONT COLOR="#000000">propdef</FONT> <FONT COLOR="#0000FF">DER0 <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">:</FONT>tps<FONT COLOR="#000000">,</FONT> t<FONT COLOR="#000000">:</FONT>tm<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">:</FONT>tp<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> <FONT COLOR="#000000">[</FONT>s<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">]</FONT> DER <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> t<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">,</FONT> s<FONT COLOR="#000000">)</FONT></FONT>

<FONT COLOR="#000000">dataprop</FONT> <FONT COLOR="#009000"><FONT COLOR="#0000FF">INS <FONT COLOR="#000000">(</FONT>tps<FONT COLOR="#000000">,</FONT> tp<FONT COLOR="#000000">,</FONT> int<FONT COLOR="#000000">,</FONT> tps<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">G<FONT COLOR="#000000">:</FONT>tps</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">T<FONT COLOR="#000000">:</FONT>tp</FONT><FONT COLOR="#000000">}</FONT> INSone <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">,</FONT> 0<FONT COLOR="#000000">,</FONT> tpsmore <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT>
  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">:</FONT>tps</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">T<FONT COLOR="#000000">,</FONT>T'<FONT COLOR="#000000">:</FONT>tp</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">i<FONT COLOR="#000000">:</FONT>nat</FONT><FONT COLOR="#000000">}</FONT>
      INSshi <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>tpsmore <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> T'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">,</FONT> i+1<FONT COLOR="#000000">,</FONT> tpsmore <FONT COLOR="#000000">(</FONT>G2<FONT COLOR="#000000">,</FONT> T'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF">INS <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">)</FONT></FONT></FONT>

<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">dershiVarGte <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G<FONT COLOR="#000000">,</FONT>G'<FONT COLOR="#000000">:</FONT>tps<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>T<FONT COLOR="#000000">,</FONT>T'<FONT COLOR="#000000">:</FONT>tp<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>i1<FONT COLOR="#000000">,</FONT>i2<FONT COLOR="#000000">:</FONT>nat <FONT COLOR="#000000">|</FONT> i1 &gt;= i2<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>i1<FONT COLOR="#000000">&gt;.</FONT></FONT>
     <FONT COLOR="#000000">(</FONT>i1<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">TPI <FONT COLOR="#000000">(</FONT>i1<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">,</FONT> G<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> i2<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">INS <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> T'<FONT COLOR="#000000">,</FONT> i2<FONT COLOR="#000000">,</FONT> G'<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">TPI <FONT COLOR="#000000">(</FONT>i1+1<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">,</FONT> G'<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">case+</FONT> i2 <FONT COLOR="#000000">of</FONT>
    <FONT COLOR="#000000">|</FONT> INSone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> TPIshi i1
    <FONT COLOR="#000000">|</FONT> INSshi i2 <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">TPIshi i1 <FONT COLOR="#000000">=</FONT> i1</FONT> <FONT COLOR="#000000">in</FONT> TPIshi <FONT COLOR="#000000">(</FONT>dershiVarGte <FONT COLOR="#000000">(</FONT>i1<FONT COLOR="#000000">,</FONT> i2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">end</FONT></FONT>

<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">dershiVarLt <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G<FONT COLOR="#000000">,</FONT>G'<FONT COLOR="#000000">:</FONT>tps<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>T<FONT COLOR="#000000">,</FONT>T'<FONT COLOR="#000000">:</FONT>tp<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>i1<FONT COLOR="#000000">,</FONT>i2<FONT COLOR="#000000">:</FONT>nat <FONT COLOR="#000000">|</FONT> i1 <FONT COLOR="#000000">&lt;</FONT> i2<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>i1<FONT COLOR="#000000">&gt;.</FONT></FONT>
     <FONT COLOR="#000000">(</FONT>i1<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">TPI <FONT COLOR="#000000">(</FONT>i1<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">,</FONT> G<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> i2<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">INS <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> T'<FONT COLOR="#000000">,</FONT> i2<FONT COLOR="#000000">,</FONT> G'<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">TPI <FONT COLOR="#000000">(</FONT>i1<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">,</FONT> G'<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">INSshi i2 <FONT COLOR="#000000">=</FONT> i2</FONT> <FONT COLOR="#000000">in</FONT>
     <FONT COLOR="#000000">case+</FONT> i1 <FONT COLOR="#000000">of</FONT>
       <FONT COLOR="#000000">|</FONT> TPIone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> TPIone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT>
       <FONT COLOR="#000000">|</FONT> TPIshi i1 <FONT COLOR="#000000">=&gt;</FONT> TPIshi <FONT COLOR="#000000">(</FONT>dershiVarLt <FONT COLOR="#000000">(</FONT>i1<FONT COLOR="#000000">,</FONT> i2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
  <FONT COLOR="#000000">end</FONT></FONT>

<FONT COLOR="#787878">//
</FONT>
<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">dershi <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G<FONT COLOR="#000000">,</FONT>G'<FONT COLOR="#000000">:</FONT>tps<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>T<FONT COLOR="#000000">,</FONT>T'<FONT COLOR="#000000">:</FONT>tp<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>t<FONT COLOR="#000000">,</FONT>t'<FONT COLOR="#000000">:</FONT>tm<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>i<FONT COLOR="#000000">,</FONT>s<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>s<FONT COLOR="#000000">&gt;.</FONT></FONT>
     <FONT COLOR="#000000">(</FONT>d<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DER <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> t<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">,</FONT> s<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">INS <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> T'<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">,</FONT> G'<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> pf<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">tmshi <FONT COLOR="#000000">(</FONT>t<FONT COLOR="#000000">,</FONT> t'<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DER <FONT COLOR="#000000">(</FONT>G'<FONT COLOR="#000000">,</FONT> t'<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">,</FONT> s<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">case+</FONT> d <FONT COLOR="#000000">of</FONT>
    <FONT COLOR="#000000">|</FONT> DERvar <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>T<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>i'<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#000000">(</FONT>i'<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">begin</FONT>
        <FONT COLOR="#009000"><FONT COLOR="#000000">sif</FONT> <FONT COLOR="#0000FF">i' &gt;= i</FONT> <FONT COLOR="#000000">then</FONT>
           <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">TMSHIvargte <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> pf</FONT> <FONT COLOR="#000000">in</FONT> DERvar <FONT COLOR="#000000">(</FONT>dershiVarGte <FONT COLOR="#000000">(</FONT>i'<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">end</FONT>
        <FONT COLOR="#000000">else</FONT>
           <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">TMSHIvarlt <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> pf</FONT> <FONT COLOR="#000000">in</FONT> DERvar <FONT COLOR="#000000">(</FONT>dershiVarLt <FONT COLOR="#000000">(</FONT>i'<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">end</FONT></FONT>
      <FONT COLOR="#000000">end</FONT>

    <FONT COLOR="#000000">|</FONT> DERlam d <FONT COLOR="#000000">=&gt;</FONT>
        <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">TMSHIlam pf <FONT COLOR="#000000">=</FONT> pf</FONT> <FONT COLOR="#000000">in</FONT>
          DERlam <FONT COLOR="#000000">(</FONT>dershi <FONT COLOR="#000000">(</FONT>d<FONT COLOR="#000000">,</FONT> INSshi i<FONT COLOR="#000000">,</FONT> pf<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
        <FONT COLOR="#000000">end</FONT>

    <FONT COLOR="#000000">|</FONT> DERapp <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT>
        <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">TMSHIapp <FONT COLOR="#000000">(</FONT>pf1<FONT COLOR="#000000">,</FONT> pf2<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> pf</FONT> <FONT COLOR="#000000">in</FONT>
           DERapp <FONT COLOR="#000000">(</FONT>dershi <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">,</FONT> pf1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> dershi <FONT COLOR="#000000">(</FONT>d2<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">,</FONT> pf2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
        <FONT COLOR="#000000">end</FONT></FONT>

<FONT COLOR="#787878">//
</FONT>
<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">dershi0 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G<FONT COLOR="#000000">:</FONT>tps<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>T<FONT COLOR="#000000">,</FONT>T'<FONT COLOR="#000000">:</FONT>tp<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>t<FONT COLOR="#000000">,</FONT>t'<FONT COLOR="#000000">:</FONT>tm<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>s<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>s<FONT COLOR="#000000">&gt;.</FONT></FONT>
     <FONT COLOR="#000000">(</FONT>d<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DER <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> t<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">,</FONT> s<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT>  pf<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">tmshi <FONT COLOR="#000000">(</FONT>t<FONT COLOR="#000000">,</FONT> t'<FONT COLOR="#000000">,</FONT> 0<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DER <FONT COLOR="#000000">(</FONT>tpsmore <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> T'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> t'<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">,</FONT> s<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT> dershi <FONT COLOR="#000000">(</FONT>d<FONT COLOR="#000000">,</FONT> INSone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> pf<FONT COLOR="#000000">)</FONT></FONT>

<FONT COLOR="#787878">//
</FONT>
<FONT COLOR="#000000">dataprop</FONT> <FONT COLOR="#009000"><FONT COLOR="#0000FF">DERS <FONT COLOR="#000000">(</FONT>tps<FONT COLOR="#000000">,</FONT> tms<FONT COLOR="#000000">,</FONT> tps<FONT COLOR="#000000">,</FONT> int<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">G0<FONT COLOR="#000000">:</FONT>tps</FONT><FONT COLOR="#000000">}</FONT> DERSnil <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>G0<FONT COLOR="#000000">,</FONT> tmsnil<FONT COLOR="#000000">,</FONT> tpsnil<FONT COLOR="#000000">,</FONT> 0<FONT COLOR="#000000">)</FONT></FONT>
  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">G0<FONT COLOR="#000000">,</FONT>G<FONT COLOR="#000000">:</FONT>tps</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">T<FONT COLOR="#000000">:</FONT>tp</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">ts<FONT COLOR="#000000">:</FONT>tms</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">t<FONT COLOR="#000000">:</FONT>tm</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">s<FONT COLOR="#000000">,</FONT>n<FONT COLOR="#000000">:</FONT>nat</FONT><FONT COLOR="#000000">}</FONT>
      DERSmore <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>G0<FONT COLOR="#000000">,</FONT> tmsmore <FONT COLOR="#000000">(</FONT>ts<FONT COLOR="#000000">,</FONT> t<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> tpsmore <FONT COLOR="#000000">(</FONT>G<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> n+1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT>
        <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>DERS <FONT COLOR="#000000">(</FONT>G0<FONT COLOR="#000000">,</FONT> ts<FONT COLOR="#000000">,</FONT> G<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> DER <FONT COLOR="#000000">(</FONT>G0<FONT COLOR="#000000">,</FONT> t<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">,</FONT> s<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT></FONT>

<FONT COLOR="#000000">propdef</FONT> <FONT COLOR="#0000FF">DERS0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">:</FONT>tps<FONT COLOR="#000000">,</FONT> ts<FONT COLOR="#000000">:</FONT>tms<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">:</FONT>tps<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> <FONT COLOR="#000000">[</FONT>n<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">]</FONT> DERS <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> ts<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT>

<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">dersshi <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G0<FONT COLOR="#000000">,</FONT>G<FONT COLOR="#000000">:</FONT>tps<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>T<FONT COLOR="#000000">:</FONT>tp<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>ts<FONT COLOR="#000000">,</FONT>ts'<FONT COLOR="#000000">:</FONT>tms<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>n<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>n<FONT COLOR="#000000">&gt;.</FONT></FONT>
     <FONT COLOR="#000000">(</FONT>ds<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DERS <FONT COLOR="#000000">(</FONT>G0<FONT COLOR="#000000">,</FONT> ts<FONT COLOR="#000000">,</FONT> G<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> pf<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">subshi <FONT COLOR="#000000">(</FONT>ts<FONT COLOR="#000000">,</FONT> ts'<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DERS <FONT COLOR="#000000">(</FONT>tpsmore <FONT COLOR="#000000">(</FONT>G0<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> ts'<FONT COLOR="#000000">,</FONT> G<FONT COLOR="#000000">,</FONT> n<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">case+</FONT> <FONT COLOR="#000000">(</FONT>ds<FONT COLOR="#000000">,</FONT> pf<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">of</FONT>
    <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">(</FONT>DERSnil <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> SUBSHInil <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> DERSnil <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">(</FONT>DERSmore <FONT COLOR="#000000">(</FONT>ds<FONT COLOR="#000000">,</FONT> d<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> SUBSHImore <FONT COLOR="#000000">(</FONT>pf1<FONT COLOR="#000000">,</FONT> pf2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT>
        DERSmore <FONT COLOR="#000000">(</FONT>dersshi <FONT COLOR="#000000">(</FONT>ds<FONT COLOR="#000000">,</FONT> pf1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> dershi0 <FONT COLOR="#000000">(</FONT>d<FONT COLOR="#000000">,</FONT> pf2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT>
<FONT COLOR="#787878">//
</FONT>
<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">lemma10 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">:</FONT>tps<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>T<FONT COLOR="#000000">:</FONT>tp<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>ts<FONT COLOR="#000000">:</FONT>tms<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>t<FONT COLOR="#000000">,</FONT>t'<FONT COLOR="#000000">:</FONT>tm<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>i<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>i<FONT COLOR="#000000">&gt;.</FONT></FONT>
     <FONT COLOR="#000000">(</FONT>ds<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DERS0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> ts<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> i1<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">TPI <FONT COLOR="#000000">(</FONT>i<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> i2<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">TMI <FONT COLOR="#000000">(</FONT>i<FONT COLOR="#000000">,</FONT> t'<FONT COLOR="#000000">,</FONT> ts<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DER0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> t'<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">case+</FONT> i1 <FONT COLOR="#000000">of</FONT>
    <FONT COLOR="#000000">|</FONT> TPIone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">begin</FONT>
        <FONT COLOR="#000000">let</FONT>
           <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">TMIone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> i2</FONT>
           <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">DERSmore <FONT COLOR="#000000">(</FONT>_<FONT COLOR="#000000">,</FONT> d<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> ds</FONT>
        <FONT COLOR="#000000">in</FONT>
           d
        <FONT COLOR="#000000">end</FONT>
      <FONT COLOR="#000000">end</FONT>

    <FONT COLOR="#000000">|</FONT> TPIshi i1 <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">begin</FONT>
        <FONT COLOR="#000000">let</FONT>
           <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">TMIshi i2 <FONT COLOR="#000000">=</FONT> i2</FONT>
           <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">DERSmore <FONT COLOR="#000000">(</FONT>ds<FONT COLOR="#000000">,</FONT> _<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> ds</FONT>
        <FONT COLOR="#000000">in</FONT>
           lemma10 <FONT COLOR="#000000">(</FONT>ds<FONT COLOR="#000000">,</FONT> i1<FONT COLOR="#000000">,</FONT> i2<FONT COLOR="#000000">)</FONT>
        <FONT COLOR="#000000">end</FONT>
      <FONT COLOR="#000000">end</FONT></FONT>

<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">lemma10' <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">:</FONT>tps<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>T<FONT COLOR="#000000">:</FONT>tp<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>ts<FONT COLOR="#000000">:</FONT>tms<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>t<FONT COLOR="#000000">:</FONT>tm<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>i<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>i<FONT COLOR="#000000">&gt;.</FONT></FONT>
  <FONT COLOR="#000000">(</FONT>ds<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DERS0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> ts<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">TPI <FONT COLOR="#000000">(</FONT>i<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">[</FONT>t'<FONT COLOR="#000000">:</FONT>tm<FONT COLOR="#000000">]</FONT> TMI <FONT COLOR="#000000">(</FONT>i<FONT COLOR="#000000">,</FONT> t'<FONT COLOR="#000000">,</FONT> ts<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">case+</FONT> i <FONT COLOR="#000000">of</FONT>
  <FONT COLOR="#000000">|</FONT> TPIone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">let</FONT>
      <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">DERSmore <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT><FONT COLOR="#000000">..</FONT><FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT><FONT COLOR="#000000">..</FONT><FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>ts1<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>t1<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#000000">(</FONT>_<FONT COLOR="#000000">,</FONT> _<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> ds</FONT>
    <FONT COLOR="#000000">in</FONT>
      TMIone <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>ts1<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>t1<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">end</FONT>
  <FONT COLOR="#000000">|</FONT> TPIshi i <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">begin</FONT>
      <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">DERSmore <FONT COLOR="#000000">(</FONT>ds<FONT COLOR="#000000">,</FONT> _<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> ds</FONT> <FONT COLOR="#000000">in</FONT> TMIshi <FONT COLOR="#000000">(</FONT>lemma10' <FONT COLOR="#000000">(</FONT>ds<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">end</FONT>
    <FONT COLOR="#000000">end</FONT></FONT>

<FONT COLOR="#787878">//
</FONT>
<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">substLemma <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">:</FONT>tps<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>T<FONT COLOR="#000000">:</FONT>tp<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>ts<FONT COLOR="#000000">:</FONT>tms<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>t<FONT COLOR="#000000">,</FONT>t'<FONT COLOR="#000000">:</FONT>tm<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>s<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>s<FONT COLOR="#000000">&gt;.</FONT></FONT>
     <FONT COLOR="#000000">(</FONT>ds<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DERS0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> ts<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> d<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DER <FONT COLOR="#000000">(</FONT>G2<FONT COLOR="#000000">,</FONT> t<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">,</FONT> s<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> pf<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">subst <FONT COLOR="#000000">(</FONT>ts<FONT COLOR="#000000">,</FONT> t<FONT COLOR="#000000">,</FONT> t'<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DER0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> t'<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">case+</FONT> d <FONT COLOR="#000000">of</FONT>
    <FONT COLOR="#000000">|</FONT> DERvar i1 <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">begin</FONT>
        <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">SUBvar i2 <FONT COLOR="#000000">=</FONT> pf</FONT> <FONT COLOR="#000000">in</FONT>
          lemma10 <FONT COLOR="#000000">(</FONT>ds<FONT COLOR="#000000">,</FONT> i1<FONT COLOR="#000000">,</FONT> i2<FONT COLOR="#000000">)</FONT>
        <FONT COLOR="#000000">end</FONT>
      <FONT COLOR="#000000">end</FONT>

    <FONT COLOR="#000000">|</FONT> DERlam d <FONT COLOR="#000000">=&gt;</FONT>
        <FONT COLOR="#000000">let</FONT>
           <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">SUBlam <FONT COLOR="#000000">(</FONT>pf1<FONT COLOR="#000000">,</FONT> pf2<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> pf</FONT>
           <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">ds <FONT COLOR="#000000">=</FONT> DERSmore <FONT COLOR="#000000">(</FONT>dersshi <FONT COLOR="#000000">(</FONT>ds<FONT COLOR="#000000">,</FONT> pf1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> DERvar <FONT COLOR="#000000">(</FONT>TPIone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT>
        <FONT COLOR="#000000">in</FONT>
           DERlam <FONT COLOR="#000000">(</FONT>substLemma <FONT COLOR="#000000">(</FONT>ds<FONT COLOR="#000000">,</FONT> d<FONT COLOR="#000000">,</FONT> pf2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
        <FONT COLOR="#000000">end</FONT>

    <FONT COLOR="#000000">|</FONT> DERapp <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT>
        <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">SUBapp <FONT COLOR="#000000">(</FONT>pf1<FONT COLOR="#000000">,</FONT> pf2<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> pf</FONT> <FONT COLOR="#000000">in</FONT>
           DERapp <FONT COLOR="#000000">(</FONT>substLemma <FONT COLOR="#000000">(</FONT>ds<FONT COLOR="#000000">,</FONT> d1<FONT COLOR="#000000">,</FONT> pf1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> substLemma <FONT COLOR="#000000">(</FONT>ds<FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">,</FONT> pf2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
        <FONT COLOR="#000000">end</FONT></FONT>

<FONT COLOR="#000000">prfn</FONT> <FONT COLOR="#009000">substLemma0 <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>T1<FONT COLOR="#000000">,</FONT>T2<FONT COLOR="#000000">:</FONT>tp<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>t1<FONT COLOR="#000000">,</FONT>t2<FONT COLOR="#000000">,</FONT>t2'<FONT COLOR="#000000">:</FONT>tm<FONT COLOR="#000000">}</FONT></FONT>
     <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DER0 <FONT COLOR="#000000">(</FONT>tpsnil<FONT COLOR="#000000">,</FONT> t1<FONT COLOR="#000000">,</FONT> T1<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT>
      d2<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DER0 <FONT COLOR="#000000">(</FONT>tpsmore <FONT COLOR="#000000">(</FONT>tpsnil<FONT COLOR="#000000">,</FONT> T1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> t2<FONT COLOR="#000000">,</FONT> T2<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT>
      pf<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">subst1 <FONT COLOR="#000000">(</FONT>t1<FONT COLOR="#000000">,</FONT> t2<FONT COLOR="#000000">,</FONT> t2'<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DER0 <FONT COLOR="#000000">(</FONT>tpsnil<FONT COLOR="#000000">,</FONT> t2'<FONT COLOR="#000000">,</FONT> T2<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  substLemma <FONT COLOR="#000000">(</FONT>DERSmore <FONT COLOR="#000000">(</FONT>DERSnil<FONT COLOR="#000000">,</FONT> d1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">,</FONT> pf<FONT COLOR="#000000">)</FONT></FONT>

<FONT COLOR="#787878">//
</FONT>
<FONT COLOR="#000000">dataprop</FONT> <FONT COLOR="#009000"><FONT COLOR="#0000FF">ISV <FONT COLOR="#000000">(</FONT>tm<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">t<FONT COLOR="#000000">:</FONT>tm</FONT><FONT COLOR="#000000">}</FONT> ISVlam <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>tmlam t<FONT COLOR="#000000">)</FONT></FONT></FONT>

<FONT COLOR="#000000">dataprop</FONT> <FONT COLOR="#009000"><FONT COLOR="#0000FF">RED <FONT COLOR="#000000">(</FONT>tm<FONT COLOR="#000000">,</FONT> tm<FONT COLOR="#000000">,</FONT> int<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">t1<FONT COLOR="#000000">,</FONT>t2<FONT COLOR="#000000">,</FONT>t1'<FONT COLOR="#000000">:</FONT>tm</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">s<FONT COLOR="#000000">:</FONT>nat</FONT><FONT COLOR="#000000">}</FONT>
      REDapp1 <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>tmapp <FONT COLOR="#000000">(</FONT>t1<FONT COLOR="#000000">,</FONT> t2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> tmapp <FONT COLOR="#000000">(</FONT>t1'<FONT COLOR="#000000">,</FONT> t2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> s+1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF">RED <FONT COLOR="#000000">(</FONT>t1<FONT COLOR="#000000">,</FONT> t1'<FONT COLOR="#000000">,</FONT> s<FONT COLOR="#000000">)</FONT></FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">t1<FONT COLOR="#000000">,</FONT>t2<FONT COLOR="#000000">,</FONT>t2'<FONT COLOR="#000000">:</FONT>tm</FONT><FONT COLOR="#000000">}</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">s<FONT COLOR="#000000">:</FONT>nat</FONT><FONT COLOR="#000000">}</FONT>
      REDapp2 <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>tmapp <FONT COLOR="#000000">(</FONT>t1<FONT COLOR="#000000">,</FONT> t2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> tmapp <FONT COLOR="#000000">(</FONT>t1<FONT COLOR="#000000">,</FONT> t2'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> s+1<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>ISV t1<FONT COLOR="#000000">,</FONT> RED <FONT COLOR="#000000">(</FONT>t2<FONT COLOR="#000000">,</FONT> t2'<FONT COLOR="#000000">,</FONT> s<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT>

  <FONT COLOR="#000000">|</FONT> <FONT COLOR="#000000">{</FONT><FONT COLOR="#0000FF">t<FONT COLOR="#000000">,</FONT>v<FONT COLOR="#000000">,</FONT>t'<FONT COLOR="#000000">:</FONT>tm</FONT><FONT COLOR="#000000">}</FONT> REDapp3 <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>tmapp <FONT COLOR="#000000">(</FONT>tmlam t<FONT COLOR="#000000">,</FONT> v<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> t'<FONT COLOR="#000000">,</FONT> 0<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>ISV v<FONT COLOR="#000000">,</FONT> subst1 <FONT COLOR="#000000">(</FONT>v<FONT COLOR="#000000">,</FONT> t<FONT COLOR="#000000">,</FONT> t'<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT></FONT>

<FONT COLOR="#000000">propdef</FONT> <FONT COLOR="#0000FF">RED0 <FONT COLOR="#000000">(</FONT>t<FONT COLOR="#000000">:</FONT>tm<FONT COLOR="#000000">,</FONT> t'<FONT COLOR="#000000">:</FONT>tm<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> <FONT COLOR="#000000">[</FONT>s<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">]</FONT> RED <FONT COLOR="#000000">(</FONT>t<FONT COLOR="#000000">,</FONT> t'<FONT COLOR="#000000">,</FONT> s<FONT COLOR="#000000">)</FONT></FONT>

<FONT COLOR="#787878">// Subject Reduction Theorem
</FONT>
<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">subjectReduction <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>T<FONT COLOR="#000000">:</FONT>tp<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>t<FONT COLOR="#000000">,</FONT>t'<FONT COLOR="#000000">:</FONT>tm<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>s<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>s<FONT COLOR="#000000">&gt;.</FONT></FONT>
   <FONT COLOR="#000000">(</FONT>d<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DER <FONT COLOR="#000000">(</FONT>tpsnil<FONT COLOR="#000000">,</FONT> t<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">,</FONT> s<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> pf<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">RED0 <FONT COLOR="#000000">(</FONT>t<FONT COLOR="#000000">,</FONT> t'<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DER0 <FONT COLOR="#000000">(</FONT>tpsnil<FONT COLOR="#000000">,</FONT> t'<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">case+</FONT> pf <FONT COLOR="#000000">of</FONT>
    <FONT COLOR="#000000">|</FONT> REDapp1 pf <FONT COLOR="#000000">=&gt;</FONT>
        <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">DERapp <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> d</FONT> <FONT COLOR="#000000">in</FONT>
          DERapp <FONT COLOR="#000000">(</FONT>subjectReduction <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> pf<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">)</FONT>
        <FONT COLOR="#000000">end</FONT>

    <FONT COLOR="#000000">|</FONT> REDapp2 <FONT COLOR="#000000">(</FONT>_<FONT COLOR="#000000">,</FONT> pf<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT>
        <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">DERapp <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> d</FONT> <FONT COLOR="#000000">in</FONT>
          DERapp <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> subjectReduction <FONT COLOR="#000000">(</FONT>d2<FONT COLOR="#000000">,</FONT> pf<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
        <FONT COLOR="#000000">end</FONT>

    <FONT COLOR="#000000">|</FONT> REDapp3 <FONT COLOR="#000000">(</FONT>pf1<FONT COLOR="#000000">,</FONT> pf2<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT>
        <FONT COLOR="#000000">let</FONT>
           <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">DERapp <FONT COLOR="#000000">(</FONT>DERlam d1<FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> d</FONT>
        <FONT COLOR="#000000">in</FONT>
            substLemma0 <FONT COLOR="#000000">(</FONT>d2<FONT COLOR="#000000">,</FONT> d1<FONT COLOR="#000000">,</FONT> pf2<FONT COLOR="#000000">)</FONT>
        <FONT COLOR="#000000">end</FONT></FONT>

<FONT COLOR="#787878">//
</FONT>
<FONT COLOR="#000000">dataprop</FONT> <FONT COLOR="#009000"><FONT COLOR="#0000FF">ORELSE <FONT COLOR="#000000">(</FONT>p1<FONT COLOR="#000000">:</FONT> prop<FONT COLOR="#000000">,</FONT> p2<FONT COLOR="#000000">:</FONT> prop<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  inl <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>p1<FONT COLOR="#000000">,</FONT> p2<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF">p1</FONT> <FONT COLOR="#000000">|</FONT> inr <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>p1<FONT COLOR="#000000">,</FONT> p2<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">of</FONT> <FONT COLOR="#0000FF">p2</FONT></FONT>

<FONT COLOR="#800080"><FONT COLOR="#000000">infixl</FONT> ORELSE</FONT>

<FONT COLOR="#787878">//
</FONT>
<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">substLemma' <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>G1<FONT COLOR="#000000">,</FONT>G2<FONT COLOR="#000000">:</FONT>tps<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>T<FONT COLOR="#000000">:</FONT>tp<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>ts<FONT COLOR="#000000">:</FONT>tms<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>t<FONT COLOR="#000000">:</FONT>tm<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>s<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>s<FONT COLOR="#000000">&gt;.</FONT></FONT>
   <FONT COLOR="#000000">(</FONT>ds<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DERS0 <FONT COLOR="#000000">(</FONT>G1<FONT COLOR="#000000">,</FONT> ts<FONT COLOR="#000000">,</FONT> G2<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> d<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DER <FONT COLOR="#000000">(</FONT>G2<FONT COLOR="#000000">,</FONT> t<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">,</FONT> s<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">[</FONT>t'<FONT COLOR="#000000">:</FONT>tm<FONT COLOR="#000000">]</FONT> subst <FONT COLOR="#000000">(</FONT>ts<FONT COLOR="#000000">,</FONT> t<FONT COLOR="#000000">,</FONT> t'<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  <FONT COLOR="#000000">case+</FONT> d <FONT COLOR="#000000">of</FONT>
    <FONT COLOR="#000000">|</FONT> DERvar i <FONT COLOR="#000000">=&gt;</FONT> SUBvar <FONT COLOR="#000000">(</FONT>lemma10' <FONT COLOR="#000000">(</FONT>ds<FONT COLOR="#000000">,</FONT> i<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
    <FONT COLOR="#000000">|</FONT> DERlam d <FONT COLOR="#000000">=&gt;</FONT>
        <FONT COLOR="#000000">let</FONT>
           <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">pf1 <FONT COLOR="#000000">=</FONT> subshiFun <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>ts<FONT COLOR="#000000">}</FONT></FONT></FONT>
           <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">ds <FONT COLOR="#000000">=</FONT> DERSmore <FONT COLOR="#000000">(</FONT>dersshi <FONT COLOR="#000000">(</FONT>ds<FONT COLOR="#000000">,</FONT> pf1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> DERvar <FONT COLOR="#000000">(</FONT>TPIone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT>
           <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">pf2 <FONT COLOR="#000000">=</FONT> substLemma' <FONT COLOR="#000000">(</FONT>ds<FONT COLOR="#000000">,</FONT> d<FONT COLOR="#000000">)</FONT></FONT>
        <FONT COLOR="#000000">in</FONT>
           SUBlam <FONT COLOR="#000000">(</FONT>pf1<FONT COLOR="#000000">,</FONT> pf2<FONT COLOR="#000000">)</FONT>
        <FONT COLOR="#000000">end</FONT>

    <FONT COLOR="#000000">|</FONT> DERapp <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> SUBapp <FONT COLOR="#000000">(</FONT>substLemma' <FONT COLOR="#000000">(</FONT>ds<FONT COLOR="#000000">,</FONT> d1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> substLemma' <FONT COLOR="#000000">(</FONT>ds<FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT></FONT>

<FONT COLOR="#000000">prfn</FONT> <FONT COLOR="#009000">substLemma0' <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>T1<FONT COLOR="#000000">,</FONT>T2<FONT COLOR="#000000">:</FONT>tp<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>t1<FONT COLOR="#000000">,</FONT>t2<FONT COLOR="#000000">:</FONT>tm<FONT COLOR="#000000">}</FONT></FONT>
   <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DER0 <FONT COLOR="#000000">(</FONT>tpsnil<FONT COLOR="#000000">,</FONT> t1<FONT COLOR="#000000">,</FONT> T1<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DER0 <FONT COLOR="#000000">(</FONT>tpsmore <FONT COLOR="#000000">(</FONT>tpsnil<FONT COLOR="#000000">,</FONT> T1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> t2<FONT COLOR="#000000">,</FONT> T2<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT>
  <FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">[</FONT>t2'<FONT COLOR="#000000">:</FONT>tm<FONT COLOR="#000000">]</FONT> subst1 <FONT COLOR="#000000">(</FONT>t1<FONT COLOR="#000000">,</FONT> t2<FONT COLOR="#000000">,</FONT> t2'<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT>
  substLemma' <FONT COLOR="#000000">(</FONT>DERSmore <FONT COLOR="#000000">(</FONT>DERSnil<FONT COLOR="#000000">,</FONT> d1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">)</FONT></FONT>

<FONT COLOR="#787878">// Progress Theorem
</FONT>
<FONT COLOR="#000000">prfun</FONT> <FONT COLOR="#009000">progress <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>T<FONT COLOR="#000000">:</FONT>tp<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>t<FONT COLOR="#000000">:</FONT>tm<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">{</FONT>s<FONT COLOR="#000000">:</FONT>nat<FONT COLOR="#000000">}</FONT></FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">.&lt;</FONT>s<FONT COLOR="#000000">&gt;.</FONT></FONT>
     <FONT COLOR="#000000">(</FONT>d<FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF">DER <FONT COLOR="#000000">(</FONT>tpsnil<FONT COLOR="#000000">,</FONT> t<FONT COLOR="#000000">,</FONT> T<FONT COLOR="#000000">,</FONT> s<FONT COLOR="#000000">)</FONT></FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">:</FONT> <FONT COLOR="#0000FF"><FONT COLOR="#000000">(</FONT>ISV t<FONT COLOR="#000000">)</FONT> ORELSE <FONT COLOR="#000000">[</FONT>t'<FONT COLOR="#000000">:</FONT>tm<FONT COLOR="#000000">]</FONT> RED0 <FONT COLOR="#000000">(</FONT>t<FONT COLOR="#000000">,</FONT> t'<FONT COLOR="#000000">)</FONT></FONT> <FONT COLOR="#000000">=</FONT> 
  <FONT COLOR="#000000">case+</FONT> d <FONT COLOR="#000000">of</FONT>
    <FONT COLOR="#000000">|</FONT> DERlam _ <FONT COLOR="#000000">=&gt;</FONT> inl <FONT COLOR="#000000">(</FONT>ISVlam<FONT COLOR="#000000">)</FONT>

    <FONT COLOR="#000000">|</FONT> DERapp <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">,</FONT> d2<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">begin</FONT> <FONT COLOR="#000000">case</FONT> progress d1 <FONT COLOR="#000000">of</FONT>
        <FONT COLOR="#000000">|</FONT> inl pf1_l <FONT COLOR="#000000">=&gt;</FONT>
          <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">ISVlam <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> pf1_l</FONT> <FONT COLOR="#000000">in</FONT>
             <FONT COLOR="#000000">case+</FONT> progress d2 <FONT COLOR="#000000">of</FONT>
               <FONT COLOR="#000000">|</FONT> inl pf2_l <FONT COLOR="#000000">=&gt;</FONT>
                 <FONT COLOR="#000000">let</FONT> <FONT COLOR="#000000">prval</FONT> <FONT COLOR="#009000">DERlam <FONT COLOR="#000000">(</FONT>d1<FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=</FONT> d1</FONT> <FONT COLOR="#000000">in</FONT>
                    inr <FONT COLOR="#000000">(</FONT>REDapp3 <FONT COLOR="#000000">(</FONT>pf2_l<FONT COLOR="#000000">,</FONT> substLemma0' <FONT COLOR="#000000">(</FONT>d2<FONT COLOR="#000000">,</FONT> d1<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
                 <FONT COLOR="#000000">end</FONT>
               <FONT COLOR="#000000">|</FONT> inr pf2_r <FONT COLOR="#000000">=&gt;</FONT> inr <FONT COLOR="#000000">(</FONT>REDapp2 <FONT COLOR="#000000">(</FONT>pf1_l<FONT COLOR="#000000">,</FONT> pf2_r<FONT COLOR="#000000">)</FONT><FONT COLOR="#000000">)</FONT>
          <FONT COLOR="#000000">end</FONT>

        <FONT COLOR="#000000">|</FONT> inr pf1_r <FONT COLOR="#000000">=&gt;</FONT> inr <FONT COLOR="#000000">(</FONT>REDapp1 pf1_r<FONT COLOR="#000000">)</FONT>
      <FONT COLOR="#000000">end</FONT>

    <FONT COLOR="#000000">|</FONT> DERvar i <FONT COLOR="#000000">=/=&gt;</FONT> <FONT COLOR="#000000">begin</FONT>
        <FONT COLOR="#000000">case+</FONT> i <FONT COLOR="#000000">of</FONT> TPIone <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT> <FONT COLOR="#000000">|</FONT> TPIshi _ <FONT COLOR="#000000">=&gt;</FONT> <FONT COLOR="#000000">(</FONT><FONT COLOR="#000000">)</FONT>
      <FONT COLOR="#000000">end</FONT></FONT>

<FONT COLOR="#787878">(* ****** ****** *)</FONT>

<FONT COLOR="#787878">(* end of [STLC-foas.dats] *)</FONT>
</PRE></BODY>
